---
title: Мониторинг производительности, работоспособности & использования с помощью метрик
description: Узнайте, как использовать метрики Azure Data Explorer для мониторинга производительности, работоспособности и использования кластера.
author: orspod
ms.author: orspodek
ms.reviewer: gabil
ms.service: data-explorer
ms.topic: conceptual
ms.date: 01/19/2020
ms.openlocfilehash: 1319b8cd6ac8a0eb83381c24bcde9996458e47a7
ms.sourcegitcommit: 47a002b7032a05ef67c4e5e12de7720062645e9e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/15/2020
ms.locfileid: "81500922"
---
# <a name="monitor-azure-data-explorer-performance-health-and-usage-with-metrics"></a>Мониторинг производительности, работоспособности и использования Azure Data Explorer с помощью метрик

Azure Data Explorer — это быстрая и полностью управляемая служба для аналитики большого объема потоковых данных в реальном времени, поступающих из приложений, а также с веб-сайтов, устройств Интернета вещей и т. д. Чтобы использовать обозреватель данных Azure, сначала нужно создать кластер и одну или несколько баз данных в этом кластере. Затем вы должны принять (загрузить) данные в базы данных, чтобы к ним можно было выполнять запросы. Метрики Azure Data Explorer дают ключевые показатели работоспособности и производительности кластерных ресурсов. Используйте метрики, описанные в этой статье, для мониторинга работоспособности и производительности кластера Azure Data Explorer в конкретном сценарии в качестве автономных показателей. Вы также можете использовать метрики в качестве основы для работы [панелей мониторинга Azure](/azure/azure-portal/azure-portal-dashboards) и [azure Alerts.](/azure/azure-monitor/platform/alerts-metric-overview)

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас его нет, можно создать [бесплатную учетную запись Azure.](https://azure.microsoft.com/free/)
* [Кластер и база данных](create-cluster-database-portal.md).

## <a name="using-metrics"></a>Использование метрик

1. Войдите на [портал Azure](https://portal.azure.com/).
1. В кластере Azure Data Explorer выберите **метрики,** чтобы открыть панель метрик и начать анализ кластера.
    ![Выберите](media/using-metrics/select-metrics.png)метрики .
1. В панели метрик: ![панель метрик](media/using-metrics/metrics-pane.png)
    1. Чтобы создать метрическую диаграмму, выберите **метическое** имя и соответствующую **агрегацию** на метрику. Сборщики **ресурсов** и **метричного именного пространства** предварительно отобраны для кластера Azure Data Explorer. Для получения дополнительной информации [supported Azure Data Explorer metrics](#supported-azure-data-explorer-metrics)о различных метриках см.
    1. Выберите **метрику добавить,** чтобы увидеть несколько метрик, начертанных в одной и той же диаграмме.
    1. Выберите **новую диаграмму,** чтобы увидеть несколько диаграмм в одном представлении.
    1. Используйте сборщик времени, чтобы изменить временной диапазон (по умолчанию: за последние 24 часа).
    1. Используйте [ **фильтр Добавить** и **применить расщепление** ](/azure/azure-monitor/platform/metrics-getting-started#apply-dimension-filters-and-splitting) для метрик, которые имеют размеры.
    1. Выберите **пин-код для панели мониторинга,** чтобы добавить конфигурацию диаграммы в панели мониторинга, чтобы вы могли просматривать его снова.
    1. Установите **правило нового оповещения** для визуализации метрик с помощью установленных критериев. В новом правиле генерации оповещений будет указан целевой ресурс, метрика, разделение и измерения фильтров из диаграммы. Измените эти параметры в [панели создания правил оповещения.](/azure/azure-monitor/platform/metrics-charts#create-alert-rules)

Дополнительная информация об использовании [Metrics Explorer](/azure/azure-monitor/platform/metrics-getting-started).

## <a name="supported-azure-data-explorer-metrics"></a>Поддерживаемые метрики исследователя данных Azure

Поддерживаемые метрики исследователя данных Azure разделены на различные категории в зависимости от использования. 

### <a name="cluster-health-metrics"></a>Метрика здоровья кластеров

Метрики кластерного здоровья отслеживают общее состояние кластера. Это включает в себя использование ресурсов и приема и отзывчивость.

**Метрика** | **Единица измерения** | **Агрегирование** | **Описание метрики** | **Измерения** |
|---|---|---|---|---|
| Использование кэша | Процент | Авг, Макс, Мин | Процент выделенных ресурсов кэша, которые в настоящее время используются кластером. Кэш — это размер SSD, выделяемый для активности пользователя в соответствии с определенной политикой кэша. Среднее использование кэша 80% или менее является устойчивым состоянием для кластера. Если среднее использование кэша превышает 80%, кластер следует [масштабировать до](manage-cluster-vertical-scaling.md) оптимизированного уровня ценообразования на хранилище или [масштабировать сядоков](manage-cluster-horizontal-scaling.md) до большего количества экземпляров. Кроме того, адаптируйте политику кэша (меньше дней в кэше). Если использование кэша превышает 100%, размер кэшированных данных, согласно политике кэширования, больше, чем общий размер кэша в кластере. | None |
| ЦП | Процент | Авг, Макс, Мин | Процент выделенных вычислительных ресурсов, в настоящее время используется машинами в кластере. Средний процессор 80% или менее является устойчивым для кластера. Максимальное значение процессора составляет 100%, что означает отсутствие дополнительных вычислительных ресурсов для обработки данных. Если кластер работает не очень хорошо, проверьте максимальное значение процессора, чтобы определить, есть ли конкретные процессоры, которые заблокированы. | None |
| Использование приема | Процент | Авг, Макс, Мин | Процент фактических ресурсов, используемых для использования данных из общего объема ресурсов, выделяемых в политике емкости для выполнения приема. Политика емкости по умолчанию составляет не более 512 операций одновременного приема или 75% ресурсов кластера, вложенных в проглатывание. Среднее использование приема 80% или менее является устойчивым состоянием для кластера. Максимальное значение использования при гласности составляет 100%, что означает, что используется вся способность кластера проглатывания и может возникнуть очередь приема. | None |
| Сохраняйте жизнь | Count | Avg | Отслеживает отзывчивость кластера. Полностью отзывчивое значение кластера 1 и заблокированный или отключенный кластер возвращает 0. |
| Общее количество задушенные команды | Count | Авг, Макс, Мин, Сум | Количество задушенные (отклоненные) команды в кластере, так как было достигнуто максимально допустимое количество одновременных (параллельных) команд. | None |
| Общее количество размеров | Count | Авг, Макс, Мин, Сум | Общее количество объемов данных в кластере. Изменения в этой метрике могут подразумевать массовые изменения структуры данных и высокую нагрузку на кластер, так как слияние объемов данных является сверхтяжелым видом деятельности. | None |
| | | | |

### <a name="export-health-and-performance-metrics"></a>Показатели работоспособности и производительности экспорта

Показатели работоспособности и производительности экспорта отслеживают общее состояние и эффективность экспортных операций, таких как опоздание, результаты, количество записей и использование.

**Метрика** | **Единица измерения** | **Агрегирование** | **Описание метрики** | **Измерения** |
|---|---|---|---|---|
Непрерывный экспортный номер экспортированных записей    | Count | SUM | Количество экспортированных записей во всех непрерывных экспортных рабочих мест. | None |
Непрерывная максимальная опоздание экспорта |    Count   | Max   | О позже (в минутах) сообщается о непрерывном экспорте рабочих мест в кластере. | None |
Непрерывный экспорт в ожидании подсчета | Count | Max   | Количество ожидающих непрерывных экспортных рабочих мест. Эти задания готовы к работе, но ждут в очереди, возможно, из-за недостаточной емкости). 
Непрерывный результат экспорта    | Count |   Count   | Результат неудачи/успеха каждого непрерывного экспорта. | НепрерывныйЭкспортНамл |
Утилизация экспорта |    Процент | Max   | Используемый экспортный потенциал из общего экспортного потенциала кластера (от 0 до 100). | None |
| | | | |

### <a name="ingestion-health-and-performance-metrics"></a>Показатели работоспособности и производительности приема

Показатели работоспособности и производительности для проглатывания отслеживают общее состояние и производительность операций по проглатыванию, такие как задержка, результаты и объем.

**Метрика** | **Единица измерения** | **Агрегирование** | **Описание метрики** | **Измерения** |
|---|---|---|---|---|
| Обработка событий (для концентраторов событий/IoT) | Count | Макс, Мин, Сум | Общее количество событий, считаемых в центрах событий и обрабатываемых кластером. События делятся на отклоненные события и события, принятые кластерным двигателем. | EventStatus |
| Задержка приема | Секунды | Авг, Макс, Мин | Задержка данных, поданных с момента получения данных в кластере, до их готовности к запросу. Период задержки приема зависит от сценария приема. | None |
| Результат приема | Count | Count | Общее количество операций по проглатыванию, которые не удались и увенчались успехом. Используйте **применить расщепления** для создания ведра успеха и неудачи результаты и анализировать размеры (**Статус****стоимости** > ).| IngestionResultDetails |
| Объем приема (в МБ) | Count | Макс, Сум | Общий размер данных, поданных в кластер (в МБ) перед сжатием. | База данных |
| | | | |  

### <a name="query-performance"></a>Производительность запросов

Метрики производительности запроса отслеживают продолжительность запроса и общее количество одновременных или задушенные запросы.

**Метрика** | **Единица измерения** | **Агрегирование** | **Описание метрики** | **Измерения** |
|---|---|---|---|---|
| Query duration (Длительность запросов) | Миллисекунды | Авг, Мин, Макс, Сум | Общее время до получения результатов запроса (не включает задержку сети). | QueryStatus |
| Общее количество одновременных запросов | Count | Авг, Макс, Мин, Сум | Количество запросов, запускаемых параллельно в кластере. Эта метрика является хорошим способом оценки нагрузки на кластер. | None |
| Общее количество задушенные запросы | Count | Авг, Макс, Мин, Сум | Количество задушенные (отклоненные) запросы в кластере. Максимальное количество разрешенных одновременных (параллельных) запросов определено в параллельной политике запросов. | None |
| | | | |

### <a name="streaming-ingest-metrics"></a>Потоковая передача метрик

Потоковые показатели приема отслеживают данные потокового приема и скорость запроса, продолжительность и результаты.

**Метрика** | **Единица измерения** | **Агрегирование** | **Описание метрики** | **Измерения** |
|---|---|---|---|---|
Скорость потоковой передачи данных |    Count   | RateRequestsPerSecond | Общий объем данных, поданных в кластер. | None |
Продолжительность потоковой передачи   | Миллисекунды  | Авг, Макс, Мин | Общая продолжительность всех запросов на потоковую передачу. | None |
Скорость потоковой передачи запроса   | Count | Граф, Авг, Макс, Мин, Сум | Общее количество запросов на проглатку потоковой передачи. | None |
Результат потоковой передачи | Count | Avg   | Общее количество запросов на проглатку потоковой передачи по типу результата. | Результат |
| | | | |

Дополнительная информация об [поддерживаемых метриках кластеров Azure Data Explorer.](/azure/azure-monitor/platform/metrics-supported#microsoftkustoclusters)


## <a name="next-steps"></a>Следующие шаги

* [Учебник: Данные мониторинга ingest и запроса в Azure Data Explorer](/azure/data-explorer/ingest-data-no-code)
* [Monitor Azure Data Explorer ingestion operations using diagnostic logs (Preview)](/azure/data-explorer/using-diagnostic-logs) (Мониторинг операций приема Azure Data Explorer с помощью журналов диагностики (предварительная версия))
* [Краткое руководство. Запрос данных в обозревателе данных Azure](web-query-data.md)
