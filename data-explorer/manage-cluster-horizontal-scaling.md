---
title: Управление горизонтальным масштабированием кластера (развертывание) для сопоставления спроса в Azure обозреватель данных
description: В этой статье описываются шаги по масштабированию и масштабированию в кластере Azure обозреватель данных в соответствии с изменением спроса.
author: orspod
ms.author: orspodek
ms.reviewer: gabil
ms.service: data-explorer
ms.topic: how-to
ms.date: 12/09/2019
ms.openlocfilehash: 05d3e5be7f2c3c228c3db623c7798957fa101450
ms.sourcegitcommit: f354accde64317b731f21e558c52427ba1dd4830
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2020
ms.locfileid: "88875146"
---
# <a name="manage-cluster-horizontal-scaling-scale-out-in-azure-data-explorer-to-accommodate-changing-demand"></a>Управление горизонтальным масштабированием кластера (развертывание) в обозреватель данных Azure для поддержки изменения спроса

Изменение размера кластера соответствующим образом очень важно для обеспечения производительности обозревателя данных Azure. Статический размер кластера может привести к недостаточной или чрезмерной нагрузке, и ни одна из этих ситуаций не является оптимальной. Поскольку потребность в кластере не может быть предсказана с помощью абсолютной точности, лучше *масштабировать* кластер, добавлять и удалять ресурсы емкости и ЦП с изменением спроса. 

Существует два рабочих процесса масштабирования кластера Azure обозреватель данных. 
* Горизонтальное масштабирование, которое также называется масштабированием.
* [Вертикальное масштабирование](manage-cluster-vertical-scaling.md), которое также называется масштабированием вверх и вниз.
В этой статье описывается рабочий процесс горизонтального масштабирования.

## <a name="configure-horizontal-scaling"></a>Настройка горизонтального масштабирования

С помощью горизонтального масштабирования можно автоматически масштабировать число экземпляров на основе предопределенных правил и расписаний. Чтобы указать параметры автомасштабирования для кластера, выполните следующие действия.

1. В портал Azure перейдите к ресурсу кластера Azure обозреватель данных. В разделе **Параметры**выберите **масштабное развертывание**. 

2. В окне **горизонтальное масштабирование** выберите нужный метод автомасштабирования: **масштабирование вручную**, **оптимизированное Автомасштабирование**или **настраиваемое Автомасштабирование**.

### <a name="manual-scale"></a>Ручное масштабирование

По умолчанию при создании кластера используется масштабирование вручную. Кластер имеет статическую емкость, которая не изменяется автоматически. Можно выбрать статическую емкость с помощью полосы **счетчика экземпляров** . Масштабирование кластера остается в этом параметре до тех пор, пока вы не внесете еще одно изменение.

   ![Ручной метод масштабирования](media/manage-cluster-horizontal-scaling/manual-scale-method.png)

### <a name="optimized-autoscale"></a>Оптимизированное Автомасштабирование

Оптимизированный Автомасштабирование является рекомендуемым методом автомасштабирования. Этот метод оптимизирует производительность и затраты кластера. Если кластер приближается к состоянию под степенью использования, он будет масштабироваться в. Это действие снижает затраты, но сохраняет уровень производительности. Если кластер приближается к состоянию чрезмерного использования, он будет масштабироваться для обеспечения оптимальной производительности. Чтобы настроить оптимизированный Автомасштабирование, выполните следующие действия.

1. Выберите **оптимизированный Автомасштабирование**. 

1. Выберите минимальное число экземпляров и максимальное число экземпляров. Автоматическое масштабирование кластера между этими двумя числами в зависимости от нагрузки.

1. Выберите **Сохранить**.

   ![Оптимизированный метод автомасштабирования](media/manage-cluster-horizontal-scaling/optimized-autoscale-method.png)

Оптимизированный Автомасштабирование начинает работать. Его действия теперь отображаются в журнале действий Azure кластера.

#### <a name="logic-of-optimized-autoscale"></a>Логика оптимизированного автомасштабирования 

**Горизонтальное масштабирование**

Если кластер приближается к состоянию чрезмерного использования, масштабировать, чтобы обеспечить оптимальную производительность. Масштабное развертывание выполняется в следующих случаях:
* Количество экземпляров кластера ниже максимального числа экземпляров, определенных пользователем.
* Интенсивность использования кэша составляет более часа.
* ЦП слишком большой в течение часа.
* Степень использования приема составляет более часа.


**Свертывание**

Если кластер приближается к состоянию неэффективного использования, масштабировать в, чтобы снизить затраты, но поддерживать производительность. Для проверки возможности масштабирования в кластере используется несколько метрик. Следующие правила оцениваются ежечасно в течение 6 часов до выполнения масштабирования.
* Число экземпляров превышает 2 и выше минимально определенного количества экземпляров.
* Чтобы обеспечить отсутствие перегрузки ресурсов, перед выполнением масштабирования необходимо проверить следующие метрики. 
    * Использование кэша не является высоким
    * ЦП ниже среднего 
    * Степень использования приема ниже среднего 
    * Использование приема потоковой передачи (если используется потоковая передача) не является высоким
    * События поддержания активности выше определенного минимума, обработаны должным образом и вовремя.
    * Регулирование запросов отсутствует 
    * Количество неудачных запросов ниже определенного минимума.

> [!NOTE]
> В настоящее время логика шкалы требует 1-дневной оценки до реализации оптимизированного масштабирования в. Такая оценка выполняется каждые 6 часов. Если требуется немедленное изменение, используйте [масштабирование вручную](#manual-scale).

### <a name="custom-autoscale"></a>Пользовательское автомасштабирование

С помощью пользовательского автомасштабирования можно динамически масштабировать кластер в зависимости от указанных вами метрик. На следующем рисунке показана последовательность и шаги для настройки пользовательского автомасштабирования. Дополнительные сведения см. на рисунке ниже.

1. В поле **имя параметра автомасштабирования** введите имя, например " *горизонтальное масштабирование: использование кэша*". 

   ![Правило масштабирования](media/manage-cluster-horizontal-scaling/custom-autoscale-method.png)

2. В **режиме масштабирования**выберите **Масштаб на основе метрики**. Этот режим обеспечивает динамическое масштабирование. Можно также выбрать **масштаб для определенного числа экземпляров**.

3. Выберите **+ Добавить правило**.

4. В разделе **правило масштабирования** справа введите значения для каждого параметра.

    **Критерии**

    | Параметр | Описание и значение |
    | --- | --- |
    | **Агрегат времени** | Выберите условия агрегирования, например **Среднее**. |
    | **Имя метрики** | Выберите метрику для операции масштабирования, например **Cache Utilization**. |
    | **Статистика интервала времени** | Выберите одно из значений: **Среднее**, **Минимум**, **Максимум** и **Сумма**. |
    | **Оператор** | Выберите нужный параметр, например **Больше или равно**. |
    | **Пороговое значение**. | Выберите соответствующее значение. Например, для использования кэша хорошей отправной точкой является 80 процентов. |
    | **Длительность (в минутах)** | Выберите период времени, используемый системой при вычислении метрик. Начните со значения по умолчанию, равного 10 минутам. |
    |  |  |

    **Действие**

    | Параметр | Описание и значение |
    | --- | --- |
    | **Операция** | Выберите соответствующий параметр для свертывания или горизонтального масштабирования. |
    | **Число экземпляров** | Выберите количество узлов или экземпляров, которые требуется добавить или удалить при выполнении условий метрики. |
    | **Охлаждение (в минутах)** | Выберите интервал времени ожидания между операциями масштабирования. Начните со значения по умолчанию, равного 5 минутам. |
    |  |  |

5. Выберите **Добавить**.

6. В разделе **ограничения экземпляров** слева введите значения для каждого параметра.

    | Параметр | Описание и значение |
    | --- | --- |
    | **Минимальные** | Число экземпляров в кластере, поддерживаемое вне зависимости от уровня использования. |
    | **Максимум** | Число экземпляров в кластере, поддерживаемое в зависимости от уровня использования. |
    | **Default** | Число экземпляров по умолчанию. Этот параметр используется при наличии проблем с чтением метрик ресурсов. |
    |  |  |

7. Выберите **Сохранить**.

Теперь вы настроили горизонтальное масштабирование для кластера Azure обозреватель данных. Добавьте еще одно правило для вертикального масштабирования. Если вам нужна помощь с проблемами масштабирования кластеров, отправьте [запрос в службу поддержки](https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/overview) в портал Azure.

## <a name="next-steps"></a>Дальнейшие шаги

* [Мониторинг производительности, работоспособности и использования Azure обозреватель данных с помощью метрик](using-metrics.md)
* [Управление вертикальным масштабированием кластера](manage-cluster-vertical-scaling.md) для соответствующего размера кластера.
