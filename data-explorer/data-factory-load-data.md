---
title: Копирование данных из фабрики данных Azure в Azure обозреватель данных
description: Из этой статьи вы узнаете, как принять (загрузить) данные в Azure обозреватель данных с помощью средства копирования фабрики данных Azure.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: jasonh
ms.service: data-explorer
ms.topic: conceptual
ms.date: 04/15/2019
ms.openlocfilehash: 066f385e53c010f45979ec435e3446d880302e44
ms.sourcegitcommit: bb8c61dea193fbbf9ffe37dd200fa36e428aff8c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/13/2020
ms.locfileid: "83373944"
---
# <a name="copy-data-to-azure-data-explorer-by-using-azure-data-factory"></a>Копирование данных в Azure обозреватель данных с помощью фабрики данных Azure 

Azure обозреватель данных — это быстрая, полностью управляемая служба аналитики данных. Он обеспечивает анализ больших объемов данных в реальном времени, таких как приложения, веб-сайты и устройства Интернета вещей, из различных источников. С помощью Azure обозреватель данных можно итеративно исследовать данные и выявлять закономерности и аномалии, чтобы улучшить продукты, улучшить взаимодействие с клиентами, отслеживать устройства и ускорить операции. Она помогает исследовать новые вопросы и получать ответы за считанные минуты. 

Фабрика данных Azure — это полностью управляемая облачная служба интеграции данных. Его можно использовать для заполнения базы данных обозреватель данных Azure данными из существующей системы. Он поможет сэкономить время при создании решений аналитики.

При загрузке данных в Azure обозреватель данных фабрика данных предоставляет следующие преимущества.

* **Простая настройка**: получите интуитивно понятный мастер с пятью шагами без необходимости написания сценариев.
* **Поддержка расширенного хранилища данных**: получите встроенную поддержку широкого набора локальных и облачных хранилищ данных. Подробный список см. в таблице [Поддерживаемые хранилища данных и форматы](/azure/data-factory/copy-activity-overview#supported-data-stores-and-formats).
* **Безопасность и соответствие требованиям**: данные передаются по протоколу HTTPS или Azure ExpressRoute. Наличие глобальной службы гарантирует, что ваши данные никогда не покинут заданных географических границ.
* **Высокая производительность**. скорость загрузки данных составляет до 1 гигабайта в секунду (Гбит/с) в Azure обозреватель данных. Дополнительные сведения см. в разделе [производительность действия копирования](/azure/data-factory/copy-activity-performance).

В этой статье для загрузки данных из Amazon Simple Storage Service (S3) в Azure обозреватель данных используется инструмент Копирование данных фабрики данных. Вы можете выполнить аналогичную процедуру копирования данных из других хранилищ данных, например:
* [Хранилище BLOB-объектов Azure](/azure/data-factory/connector-azure-blob-storage)
* [База данных SQL Azure](/azure/data-factory/connector-azure-sql-database)
* [Хранилище данных SQL Azure](/azure/data-factory/connector-azure-sql-data-warehouse)
* [Google BigQuery](/azure/data-factory/connector-google-bigquery)
* [Oracle](/azure/data-factory/connector-oracle)
* [Файловая система](/azure/data-factory/connector-file-system)

## <a name="prerequisites"></a>Предварительные требования

* Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/) Azure, прежде чем начинать работу.
* [Кластер и база данных Azure Data Explorer](create-cluster-database-portal.md).
* Источник данных.

## <a name="create-a-data-factory"></a>Создание фабрики данных

1. Войдите на [портал Azure](https://ms.portal.azure.com).

1. В левой области выберите **Создание**  >  **Analytics**  >  **фабрики данных**аналитики ресурсов.

   ![Создание фабрики данных в портал Azure](media/data-factory-load-data/create-adf.png)

1. В области **Новая фабрика данных** укажите значения для полей в следующей таблице:

   ![Панель "Новая фабрика данных"](media/data-factory-load-data/my-new-data-factory.png)  

   | Параметр  | Значение для ввода  |
   |---|---|
   | **имя**; | В поле введите глобально уникальное имя фабрики данных. Если появляется сообщение об ошибке, *имя фабрики данных \" лоададксдемо \" недоступно*, введите другое имя для фабрики данных. Правила именования артефактов фабрики данных см. в разделе [правила именования фабрики данных](/azure/data-factory/naming-rules).|
   | **Подписка** | В раскрывающемся списке выберите подписку Azure, в которой будет создана фабрика данных. |
   | **Группа ресурсов** | Выберите **создать**и введите имя новой группы ресурсов. Если у вас уже есть группа ресурсов, выберите **использовать существующую**. |
   | **Версия** | В раскрывающемся списке выберите **v2**. |    
   | **Расположение** | В раскрывающемся списке выберите расположение для фабрики данных. В списке отображаются только поддерживаемые расположения. Хранилища данных, используемые фабрикой данных, могут находиться в других расположениях или регионах. |

1. Выберите **Создать**.

1. Чтобы отслеживать процесс создания, выберите **уведомления** на панели инструментов. После создания фабрики данных выберите ее.
   
   Откроется панель **фабрика данных** .

   ![Панель фабрики данных](media/data-factory-load-data/data-factory-home-page.png)

1. Чтобы открыть приложение в отдельной области, выберите плитку " **автор & монитор** ".

## <a name="load-data-into-azure-data-explorer"></a>Загрузка данных в Azure обозреватель данных

Вы можете загружать данные из многих типов [хранилищ данных](/azure/data-factory/copy-activity-overview#supported-data-stores-and-formats) в обозреватель данных Azure. В этой статье описывается, как загружать данные из Amazon S3.

Загрузить данные можно одним из следующих способов.

* В интерфейсе пользователя фабрики данных Azure в левой области щелкните значок **Автор** . Это показано в разделе "Создание фабрики данных" статьи [Создание фабрики данных с помощью пользовательского интерфейса фабрики данных Azure](/azure/data-factory/quickstart-create-data-factory-portal#create-a-data-factory).
* В средстве Копирование данных фабрики данных Azure, как показано на странице [Использование средства копирование данных для копирования данных](/azure/data-factory/quickstart-create-data-factory-copy-data-tool).

### <a name="copy-data-from-amazon-s3-source"></a>Копирование данных из Amazon S3 (источник)

1. На панели Приступая к **работе** откройте средство копирование данных, выбрав **копирование данных**.

   ![Кнопка средства Копирование данных](media/data-factory-load-data/copy-data-tool-tile.png)

1. В области **Свойства** в поле **имя задачи** введите имя, а затем нажмите кнопку **Далее**.

    ![Панель "свойства Копирование данных"](media/data-factory-load-data/copy-from-source.png)

1. В области **хранилище исходных данных** выберите **создать новое соединение**.

    ![Область Копирование данных "исходное хранилище данных"](media/data-factory-load-data/source-create-connection.png)

1. Выберите **Amazon S3**и нажмите кнопку **продолжить**.

    ![Новая область связанной службы](media/data-factory-load-data/amazons3-select-new-linked-service.png)

1. В области **Новая связанная служба (Amazon S3)** выполните следующие действия.

    ![Указание связанной службы Amazon S3](media/data-factory-load-data/amazons3-new-linked-service-properties.png)

    а. В поле **имя** введите имя новой связанной службы.

    b. В раскрывающемся списке **подключение через среду выполнения интеграции** выберите значение.

    c. В поле **идентификатор ключа доступа** введите значение.
    
    > [!NOTE]
    > Чтобы узнать свой ключ доступа, в Amazon S3 выберите имя пользователя Amazon на панели навигации, а затем выберите **Мои учетные данные безопасности**.
    
    d. В поле **секретный ключ доступа** введите значение.

    д) Чтобы проверить созданное подключение к связанной службе, выберите **проверить подключение**.

    е) Нажмите кнопку **Готово**.
    
      На панели " **исходное хранилище данных** " отображается новое подключение AmazonS31. 

1. Выберите **Далее**.

   ![Подключение к исходному хранилищу данных создано](media/data-factory-load-data/source-data-store-created-connection.png)

1. В области **Выбор входного файла или папки** выполните следующие действия.

    а. Перейдите к файлу или папке, которые необходимо скопировать, а затем выберите файл или папку.

    b. Выберите нужное поведение копирования. Убедитесь, что флажок **двоичное копирование** снят.

    c. Выберите **Далее**.

    ![Выбор файла или папки входных данных](media/data-factory-load-data/source-choose-input-file.png)

1. В области **Параметры формата файла** выберите соответствующие параметры для файла. и нажмите кнопку **Далее**.

   ![Панель "Параметры формата файла"](media/data-factory-load-data/source-file-format-settings.png)

### <a name="copy-data-into-azure-data-explorer-destination"></a>Копирование данных в обозреватель данных Azure (назначение)

Для копирования данных в целевую таблицу (приемник) обозреватель данных Azure, указанную в этом разделе, создается новая связанная служба обозреватель данных Azure.

> [!NOTE]
> Используйте [действие команды фабрики данных Azure для запуска команд управления обозреватель данных Azure](data-factory-command-activity.md) и использования любой из [команд приема запроса](kusto/management/data-ingestion/ingest-from-query.md), таких как `.set-or-replace` .

#### <a name="create-the-azure-data-explorer-linked-service"></a>Создание связанной службы Azure обозреватель данных

Чтобы создать связанную службу Azure обозреватель данных, выполните следующие действия.

1. Чтобы использовать существующее подключение к хранилищу данных или указать новое хранилище данных, в области **целевое хранилище данных** выберите **создать новое соединение**.

    ![Область хранилища данных назначения](media/data-factory-load-data/destination-create-connection.png)

1. В области **Новая связанная служба** выберите **Azure обозреватель данных**и нажмите кнопку **продолжить**.

    ![Новая область связанной службы](media/data-factory-load-data/adx-select-new-linked-service.png)

1. В области **Новая связанная служба (Azure обозреватель данных)** выполните следующие действия.

    ![Панель "новая связанная служба" обозреватель данных Azure](media/data-factory-load-data/adx-new-linked-service.png)

   а. В поле **имя** введите имя связанной службы Обозреватель данных Azure.

   b. В разделе **метод выбора учетной записи**выберите один из следующих вариантов. 

    * Выберите **из подписки Azure** , а затем в раскрывающихся списках выберите **подписку Azure** и **кластер**. 

        > [!NOTE]
        > В раскрывающемся списке **кластера** перечислены только те кластеры, которые связаны с вашей подпиской.

    * Нажмите клавишу **Ввод вручную**, а затем введите **конечную точку**.

   c. В поле **клиент** введите имя клиента.

   d. В поле **Service Principal ID (идентификатор субъекта-службы** ) введите идентификатор субъекта-службы.

   д) Выберите **ключ субъекта-службы** , а затем в поле **ключ субъекта-службы** введите значение для ключа.

   е) В раскрывающемся списке **база данных** выберите имя базы данных. Кроме того, можно установить флажок **изменить** , а затем ввести имя базы данных.

   ж. Чтобы проверить созданное подключение к связанной службе, выберите **проверить подключение**. Если вы можете подключиться к связанной службе, на панели отображается зеленая галочка и сообщение об **успешном подключении** .

   h. Нажмите кнопку **Готово** , чтобы завершить создание связанной службы.

    > [!NOTE]
    > Этот субъект-служба используется фабрикой данных Azure для доступа к службе обозреватель данных Azure. Чтобы создать субъект-службу, перейдите на страницу [Создание субъекта-службы Azure Active Directory (Azure AD)](/azure-stack/operator/azure-stack-create-service-principals#manage-an-azure-ad-service-principal). Не используйте метод Azure Key Vault.

#### <a name="configure-the-azure-data-explorer-data-connection"></a>Настройка подключения к данным Azure обозреватель данных

После создания подключения к связанной службе откроется область **целевое хранилище данных** , а созданное подключение будет доступно для использования. Чтобы настроить подключение, выполните следующие действия.

1. Выберите **Далее**.

    ![Панель Azure обозреватель данных "целевое хранилище данных"](media/data-factory-load-data/destination-data-store.png)

1. В области **Сопоставление таблиц** задайте имя целевой таблицы, а затем нажмите кнопку **Далее**.

    ![Область "сопоставление таблиц" целевого набора данных](media/data-factory-load-data/destination-dataset-table-mapping.png)

1. В области **сопоставление столбцов** выполняются следующие сопоставления.

    а. Первое сопоставление выполняется фабрикой данных Azure в соответствии с [сопоставлением схемы фабрики данных Azure](/azure/data-factory/copy-activity-schema-and-type-mapping). Выполните следующие действия.

    * Задайте **сопоставления столбцов** для целевой таблицы фабрики данных Azure. Сопоставление по умолчанию отображается из источника в целевую таблицу фабрики данных Azure.

    * Отмените выбор столбцов, для которых не нужно определять сопоставление столбцов.

    b. Второе сопоставление происходит, когда эти табличные данные принимаются в Azure обозреватель данных. Сопоставление выполняется в соответствии с [правилами сопоставления CSV](kusto/management/mappings.md#csv-mapping). Даже если исходные данные не находятся в формате CSV, фабрика данных Azure преобразует их в табличный формат. Таким образом, сопоставление CSV является единственным релевантным сопоставлением на этом этапе. Выполните следующие действия.

    * Используемых В разделе **Свойства приемника Azure обозреватель данных (Kusto)** добавьте соответствующее **имя сопоставления приема** , чтобы можно было использовать сопоставление столбцов.

    * Если **имя сопоставления приема** не указано, будет использоваться порядок сопоставления *по имени* , определенный в разделе **сопоставления столбцов** . В случае сбоя сопоставления *по имени* Azure обозреватель данных пытается принять данные в порядке *расположения по столбцам* (то есть по умолчанию он сопоставлен по положению).

    * Выберите **Далее**.

    ![Область "сопоставление столбцов" целевого набора данных](media/data-factory-load-data/destination-dataset-column-mapping.png)

1. В области **Параметры** выполните следующие действия.

    а. В разделе **параметры отказоустойчивости**введите соответствующие параметры.

    b. В разделе **Параметры производительности** **включить промежуточное хранение** не применяется, а **Дополнительные параметры** включают в себя рекомендации по затратам. Если нет особых требований, оставьте эти параметры без изменений.

    c. Выберите **Далее**.

    ![Панель "Параметры" копирования данных](media/data-factory-load-data/copy-data-settings.png)

1. В области **Сводка** проверьте параметры и нажмите кнопку **Далее**.

    ![Панель «Сводка по копированию данных»](media/data-factory-load-data/copy-data-summary.png)

1. На панели **Развертывание завершено** выполните следующие действия.

    а. Чтобы перейти на вкладку " **монитор** " и просмотреть состояние конвейера (т. е. ход выполнения, ошибки и поток данных), выберите **монитор**.

    b. Чтобы изменить связанные службы, наборы данных и конвейеры, выберите **изменить конвейер**.

    c. Нажмите кнопку **Готово** , чтобы завершить задачу копирования данных.

    ![Область "Развертывание завершено"](media/data-factory-load-data/deployment.png)

## <a name="next-steps"></a>Следующие шаги

* Сведения о [соединителе azure обозреватель данных](/azure/data-factory/connector-azure-data-explorer) в фабрике данных Azure.
* Дополнительные сведения об изменении связанных служб, наборов данных и конвейеров в [пользовательском интерфейсе фабрики данных](/azure/data-factory/quickstart-create-data-factory-portal).
* Дополнительные сведения о запросах [Обозреватель данных Azure](web-query-data.md) для запросов к данным.
