---
title: Краткое руководство. Запрос данных в пользовательском веб-интерфейсе Azure Data Explorer
description: В этом кратком руководстве вы узнаете, как запрашивать данные из пользовательского веб-интерфейса Azure Data Explorer и предоставлять к ним общий доступ.
author: orspod
ms.author: orspodek
ms.reviewer: mblythe
ms.service: data-explorer
ms.topic: quickstart
ms.date: 06/15/2020
ms.openlocfilehash: 061c3ea6c2a493cbda8ac428837720efe42f2082
ms.sourcegitcommit: 05489ce5257c0052aee214a31562578b0ff403e7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/25/2020
ms.locfileid: "88793962"
---
# <a name="quickstart-query-data-in-azure-data-explorer-web-ui"></a>Краткое руководство. Запрос данных в пользовательском веб-интерфейсе Azure Data Explorer

Обозреватель данных Azure — это быстрая и высокомасштабируемая служба для изучения данных журналов и телеметрии. Azure Data Explorer предлагает веб-приложение для выполнения запросов и предоставления общего доступа к ним. Приложение доступно на портале Azure и в качестве отдельного веб-приложения. В этой статье вы работаете в изолированной версии, которая позволяет подключиться к нескольким кластерам, а также совместно использовать прямые ссылки на запросы.

Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/) Azure, прежде чем начинать работу.

## <a name="prerequisites"></a>Предварительные требования

Кроме подписки Azure, для прохождения этого краткого курса потребуется [тестовый кластер и база данных](create-cluster-database-portal.md).

## <a name="sign-in-to-the-application"></a>Вход в приложение

Выполните [вход в приложение](https://dataexplorer.azure.com/).

## <a name="add-clusters"></a>Добавление кластеров

При первом открытии приложения подключения отсутствуют.

![Добавление кластера](media/web-query-data/add-cluster.png)

Перед началом выполнения запросов необходимо добавить подключение по крайней мере к одному кластеру. В этом разделе добавляются подключения к *справочному кластеру* обозревателя данных Azure, который мы настроили, чтобы облегчить обучение, и к тестовому кластеру, созданному в предыдущем кратком руководстве.

1. В левом верхнем углу приложения выберите **Добавить кластер**.

1. В диалоговом окне **Добавление кластера** введите универсальный код ресурса (URI) и выберите **Добавить**.

   Вы можете использовать универсальный код ресурса (URI) справочного кластера `https://help.kusto.windows.net`. Если у вас есть собственный кластер, укажите универсальный код ресурса (URI) своего кластера. Например `https://mydataexplorercluster.westus.kusto.windows.net`, как показано на следующем изображении:

    ![Универсальный код ресурса (URI) сервера на портале](media/web-query-data/server-uri.png)

1. В левой области вы увидите **справочный** кластер. Разверните базу данных **Примеры**, чтобы увидеть примеры таблиц, к которым у вас есть доступ.

    ![Примеры баз данных](media/web-query-data/sample-databases.png)

    Впоследствии в этом кратком руководстве и в других статьях по обозревателю данных Azure используется таблица **StormEvents**.

Теперь добавьте созданный тестовый кластер.

1. Выберите **Добавить кластер**.

1. В диалоговом окне **Добавить кластер** введите URL-адрес тестового кластера в форму `https://<ClusterName>.<Region>.kusto.windows.net/`, а затем выберите **Добавить**.

    В приведенном ниже примере вы видите **справочный** кластер и новый кластер **docscluster.westus** (полный URL-адрес — `https://docscluster.westus.kusto.windows.net/`).

    ![Тестовый кластер](media/web-query-data/test-cluster.png)

## <a name="run-queries"></a>Выполнение запросов

Теперь можно выполнять запросы, адресованные любому кластеру, к которому вы подключены (при наличии данных в тестовом кластере). Мы сосредоточимся на **справочном** кластере.

1. В левой области в разделе **справочный** кластер выберите базу данных **Примеры**.

1. Копируйте и вставьте в окно запроса следующий запрос. Вверху окна выберите **Выполнить**.

    ```Kusto
    StormEvents
    | sort by StartTime desc
    | take 10
    ```
    Этот запрос возвращает десять последних записей в таблице **StormEvents**. В левой части результатов должно отобразиться что-то вроде следующей таблицы.

    ![Набор результатов запросов](media/web-query-data/result-set-01.png)

    На следующем рисунке показано состояние, в котором должно сейчас находиться приложение, с добавленными кластерами, а также запрос с результатами.

    ![Полное приложение](media/web-query-data/full-application.png)

1. Копируйте и вставьте в окно запроса под первым запросом следующий запрос. Обратите внимание, что он не форматирован на отдельных строках, как первый запрос.

    ```Kusto
    StormEvents | sort by StartTime desc | project StartTime, EndTime, State, EventType, DamageProperty, EpisodeNarrative | take 10
    ```

1. Щелкните новый запрос в окне, чтобы выбрать запрос. Нажмите Shift + Alt + F, чтобы форматировать запрос, который должен выглядеть следующим образом.

    ![Форматированный запрос](media/web-query-data/formatted-query.png)

1. Нажмите Shift + Ввод, чтобы выполнить запрос.

   Этот запрос возвращает те же записи, что и первый, но включает только столбцы, указанные в инструкции `project`. В результате должно отобразиться что-то вроде следующей таблицы.

    ![Набор результатов запросов](media/web-query-data/result-set-02.png)

1. В верхней части окна запроса выберите **Отозвать**.

    В окне запроса теперь отображается набор результатов из первого запроса, выполнять запрос повторно не требуется. Часто во время анализа выполняется несколько запросов, а функция **Отозвать** позволяет вернуться к результатам предыдущих запросов.

1. Давайте выполним еще один запрос, чтобы увидеть другой тип выходных данных.

    ```Kusto
    StormEvents
    | summarize event_count=count(), mid = avg(BeginLat) by State
    | sort by mid
    | where event_count > 1800
    | project State, event_count
    | render columnchart
    ```
    Результат должен напоминать следующую схему.

    ![Гистограмма](media/web-query-data/column-chart.png)

> [!NOTE]
> Пустые строки в выражении запроса могут влиять на то, какая часть запроса выполняется.
>
> Если текст не выбран, предполагается, что запрос или команда разделены пустыми строками.
> Если текст выбран, будет выполнен выделенный текст.

## <a name="work-with-the-table-grid"></a>Работа с сеткой таблицы

Теперь вы знаете, как работают базовые запросы. Давайте рассмотрим, как можно использовать сетку таблицы для пользовательской настройки результатов и дальнейшего анализа.

1. Выполните повторно первый запрос. Наведите указатель мыши на столбец **Штат**, выберите меню и пункт **Группировать по штату**.

    ![Группировка по штату](media/web-query-data/group-by.png)

1. В сетке разверните узел **Калифорния** для просмотра записей для данного штата.

    ![Набор результатов запросов](media/web-query-data/result-set-03.png)

    Этот тип группировки полезен в исследовательском анализе.

1. Наведите указатель мыши на столбец **Группировка** и выберите **Сбросить столбцы**.

    ![Сброс столбцов](media/web-query-data/reset-columns.png)

    Сетка вернется в исходное состояние.

1. Выполните следующий запрос.

    ```Kusto
    StormEvents
    | sort by StartTime desc
    | where DamageProperty > 5000
    | project StartTime, State, EventType, DamageProperty, Source
    | take 10
    ```

1. В правой части сетки выберите **Столбцы** для просмотра панели инструментов.

    ![Панель инструментов](media/web-query-data/tool-panel.png)

    Это панель работает так же, как список полей сводной таблицы в Excel, позволяя анализировать больше данных из самой сетки.

1. Выберите **Сводный режим** и перетащите столбцы следующим образом: **State** в **Группы строк**; **DamageProperty** в **Значения**, а **EventType** в **Метки столбцов**.  

    ![Сводный режим](media/web-query-data/pivot-mode.png)

    Результаты должны иметь вид, как в следующей сводной таблице.

    ![Сводная таблица](media/web-query-data/pivot-table.png)

    Обратите внимание, что у Вермонта и Алабамы по два события в одной категории, а у Техаса — два события в разных категориях. Сводные таблицы позволяют быстро выявлять подобные вещи; они идеально подходят для быстрого анализа.

## <a name="share-queries"></a>Обмен запросами

Очень часто требуется предоставить общий доступ к создаваемым запросам. 

1. В окне запроса выберите первый скопированный вами запрос.

1. В верхней части окна запроса выберите **Поделиться**. 

:::image type="content" source="media/web-query-data/share-menu.png" alt-text="Меню Общий доступ":::

В раскрывающемся списке содержатся следующие параметры:
* Link to clipboard (Копировать ссылку);
* [Link query to clipboard](#provide-a-deep-link) (Копировать ссылку и запрос);
* Link, query, results to clipboard (Копировать ссылку, запрос и результаты);
* [Закрепить на панели мониторинга](#pin-to-dashboard)
* [Query to Power BI](power-bi-imported-query.md) (Запрос в Power BI).

### <a name="provide-a-deep-link"></a>Предоставление прямой ссылки

Можно предоставить глубокую ссылку, чтобы другие пользователи с доступом в кластер могли выполнять запросы.

1. В меню **Общий доступ** выберите элемент **Link, query to clipboard** (Копировать ссылку и запрос в буфер обмена).

1. Копируйте ссылку и запрос в текстовый файл.

1. Вставьте ссылку в новом окне браузера. После выполнения запроса должно отобразиться следующее.

    :::image type="content" source="media/web-query-data/shared-query.png" alt-text="Прямая ссылка на общий запрос":::

### <a name="pin-to-dashboard"></a>Закрепить на панели мониторинга

Когда вы выполняете анализ данных с помощью запросов в веб-интерфейсе и находите нужные данные, можно закрепить их на панели мониторинга для непрерывного мониторинга. 

Закрепление запроса:

1. В меню **Общий доступ** щелкните элемент **Закрепить на панели мониторинга**.

1. В области **Закрепить на панели мониторинга**:
    1. Укажите **имя запроса**.
    1. Выберите вариант **Использовать существующую** или **Создать новую**.
    1. Укажите **имя панели мониторинга**.
    1. Установите флажок **View dashboard after creation** (Просмотреть панель мониторинга после создания), если это новая панель мониторинга.
    1. Выберите **Закрепить**.

    :::image type="content" source="media/web-query-data/pin-to-dashboard.png" alt-text="Закрепление на панели мониторинга":::
    
> [!NOTE]
> На **панели мониторинга закрепляется** только выбранный запрос. Чтобы создать источник данных панели мониторинга и преобразовать команды отрисовки в визуальный элемент на панели мониторинга, необходимо выбрать соответствующую базу данных в списке.

## <a name="export-query-results"></a>Экспорт результатов запроса

Чтобы экспортировать результаты запроса в CSV-файл, последовательно выберите элементы **Файл** > **Экспортировать в CSV-файл**.

:::image type="content" source="media/web-query-data/export-results.png" alt-text="Экспорт результатов в CSV-файл":::

## <a name="provide-feedback"></a>Отзывы

1. Справа в верхнем углу окна приложения щелкните значок отзыва. ![Значок отзыва](media/web-query-data/icon-feedback.png).

1. Введите свой отзыв, а затем выберите **Отправить**.

## <a name="clean-up-resources"></a>Очистка ресурсов

В этом кратком руководстве не было создано никаких ресурсов, однако если вы хотите удалить один или оба кластера из приложения, щелкните кластер правой кнопкой и выберите **Удалить подключение**.

## <a name="next-steps"></a>Дальнейшие действия

[Написание запросов для обозревателя данных Azure](write-queries.md)
