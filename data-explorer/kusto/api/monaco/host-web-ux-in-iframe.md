---
title: Внедрение пользовательского веб-интерфейса в **IFRAME** — Azure обозреватель данных
description: В этой статье описывается внедрение пользовательского веб-интерфейса в **IFRAME** в Azure обозреватель данных.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/19/2020
ms.openlocfilehash: 348a614c8b3336085a59a113f18f6858f024e8c7
ms.sourcegitcommit: e66c5f4b833b4f6269bb7bfa5695519fcb11d9fa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2020
ms.locfileid: "83630220"
---
# <a name="embed-web-ui-in-an-iframe"></a>Внедрение пользовательского веб-интерфейса в IFRAME

Веб-интерфейс Azure обозреватель данных может быть внедрен в IFRAME и размещен на сторонних веб-сайтах.
 
:::image type="content" source="../images/host-web-ux-in-iframe/web-ux.png" alt-text="Веб-интерфейс обозреватель данных Azure":::

Внедрение Azure обозреватель данных Web UX на веб-сайт позволяет пользователям:

- Изменение запросов (включает все языковые функции, такие как выделение цветом и IntelliSense)
- Визуальное изучение схем таблиц
- Аутентификация в Azure AD
- Выполнение запросов
- Отображение результатов выполнения запроса
- Создание нескольких вкладок
- Локальное сохранение запросов
- Предоставление общего доступа к запросам по электронной почте

Все функциональные возможности проверяются на наличие специальных возможностей и поддерживают темные и легкие Экранные темы.

## <a name="use-monaco-kusto-or-embed-the-web-ui"></a>Используйте Монако-Kusto или внедрите веб-интерфейс?

Монако — Kusto предлагает возможности редактирования, такие как завершение, выделение цветом, рефакторинг, переименование и переход к определению. Он требует создания решения для проверки подлинности, выполнения запросов, вывода результатов и просмотра схемы, но обеспечивает полную гибкость работы пользователей в соответствии с вашими потребностями.

Внедрение пользовательского веб-интерфейса Azure обозреватель данных предлагает широкие возможности с минимальными усилиями, но содержит ограниченную гибкость для взаимодействия с пользователем. Существует фиксированный набор параметров запроса, обеспечивающих ограниченный контроль над представлением и поведением системы.

## <a name="how-to-embed-the-web-ui-in-an-iframe"></a>Внедрение веб-интерфейса в IFRAME

### <a name="host-the-website-in-an-iframe"></a>Размещение веб-сайта в IFRAME

Добавьте следующий код на веб-сайт:

```html
<iframe
  src="https://dataexplorer.azure.com/clusters/<cluster>?ibizaPortal=true"
></iframe>
```

`ibizaPortal`Параметр запроса сообщает пользовательскому веб-интерфейсу *not* обозреватель данных Azure о необходимости перенаправления для получения маркера проверки подлинности. Это действие необходимо, так как веб-сайт размещения отвечает за предоставление маркера проверки подлинности для внедренного IFRAME.

Замените на `<cluster>` имя узла кластера, который требуется загрузить в область подключения, например `help.kusto.windows.net` . По умолчанию режим "IFRAME-Embedded" не предоставляет способа добавления кластеров из пользовательского интерфейса, поскольку предполагается, что веб-сайт размещения знает о требуемом кластере.

### <a name="handle-authentication"></a>Обработку проверки подлинности

1. Если задано значение "режим IFRAME" ( `ibizaPortal=true` ), Пользовательский веб-интерфейс Azure обозреватель данных не пытается перенаправить для проверки подлинности. Веб-интерфейс будет использовать механизм размещения сообщений, используемый браузерами для запроса и получения маркера. Во время загрузки страницы в родительское окно будет отправлено следующее сообщение:

   ```javascript
   window.parent.postMessage(
     {
       signature: "queryExplorer",
       type: "getToken"
     },
     "*"
   );
   window.addEventListener(
     "message",
     event => this.handleIncomingMessage(event),
     false
   );
   ```

1. Затем он будет ожидать сообщения со следующей структурой:

   ```json
   {
     "type": "postToken",
     "message": "${the actual authentication token}"
   }
   ```

1. Указанный токен должен быть [маркером JWT](https://tools.ietf.org/html/rfc7519) , полученным из [[конечной точки проверки подлинности AAD]](../../management/access-control/how-to-authenticate-with-aad.md#web-client-javascript-authentication-and-authorization).

> [!IMPORTANT]
> Окно размещения должно обновить маркер до истечения срока действия и использовать тот же механизм для предоставления обновленного маркера приложению. В противном случае после истечения срока действия маркера вызовы служб завершатся ошибкой.

### <a name="feature-flags"></a>Флаги компонентов

Размещаемому приложению может потребоваться управлять определенными аспектами взаимодействия с пользователем. Например, можно скрыть панель «подключение» или отключить подключение к другим кластерам.
В этом сценарии веб-обозреватель поддерживает флаги компонентов.

Флаг функции можно использовать в URL-адресе как параметр запроса. Если приложению размещения требуется отключить добавление других кластеров, следует использоватьhttps://dataexplorer.azure.com/?ShowConnectionButtons=false

| Параметр                 | Описание                                                                                                        | Значение по умолчанию |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------ | ------------- |
| шовшаремену           | Отображение пункта меню "поделиться"                                                                                           | true          |
| шовконнектионбуттонс   | Отображение кнопки " **Добавить подключение** " для добавления нового кластера                                                            | true          |
| шовопенневвиндовбуттон | Отображение кнопки " **Открыть в веб-** интерфейсе", которая открывает новое окно браузера и указывает на https://dataexplorer.azure.com правильный кластер и базу данных в области           | false         |
| шовфилемену            | Отображение меню "файл" (**Загрузка**, **вкладка**, **содержимое**и т. д.)                                                 | true          |
| шовтос                 | Показывать **ссылку на условия предоставления услуг для обозреватель данных Azure** в диалоговом окне "Параметры"                             | true          |
| шовперсона             | Отображение имени пользователя в меню "Параметры" в правом верхнем углу                                                 | true          |
| ифрамеаус              | Если задано значение true, то веб-браузер будет выполнять проверку подлинности IFRAME и предоставлять маркер через сообщение. Этот процесс всегда будет иметь значение true для сценариев IFRAME                                                                                                                                      | false         |
| персистафтереачрун     | Обычно веб-обозреватель будет сохранен в событии выгрузки. При размещении в IFRAME они не всегда срабатывают. Этот флаг запустит **Сохранение локального состояния** после каждого выполнения запроса. В результате любая потеря данных может повлиять только на тот текст, который никогда не выполнялся, что ограничивает его влияние.          | false         |
| шовсмусинжестион     | Если задано значение true, то при щелчке правой кнопкой мыши на базе данных отображается возможность приема одного щелчка.                                   | true          |
| рефрешконнектион       | Если значение — true, всегда обновляет схему при загрузке страницы и никогда не зависит от локального хранилища                      | false         |
| шовпажехеадер          | Если значение — true, отображается заголовок страницы, включающий заголовок и параметры Azure обозреватель данных                            | true          |
| хидеконнектионпане      | Если значение — true, левая панель подключения не отображается                                                                  | false         |
| скипмонакофокусонинит   | Устраняет проблему с фокусом при размещении в IFRAME                                                                       | false         |

### <a name="feature-flag-presets"></a>Предустановки флагов компонентов

Предустановки задают одновременно множество флагов компонентов.
В настоящее время существует только одна предустановка.

`IbizaPortal`— Изменяет следующие флаги из значений по умолчанию.

```json
ShowOpenNewWindowButton: true,
PersistAfterEachRun: true,
IFrameAuth: true,
ShowPageHeader: false,                                 |
```

> [!WARNING]
> Если вы используете предустановку, вы не сможете добавлять дополнительные флаги функций поверх нее. Если требуется такая гибкость, следует использовать отдельные флаги функций.
