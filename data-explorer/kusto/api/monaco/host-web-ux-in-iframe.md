---
title: Встраиваем веб-узел в iframe - Azure Data Explorer Документы Майкрософт
description: В этой статье описывается встраиваемый веб-узел в iframe в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/19/2020
ms.openlocfilehash: 9c5469a577c3e09cd433ec250f9215e5f450d5f5
ms.sourcegitcommit: 653bfb3edf32553c52ef36b339c8b80713a601b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81524469"
---
# <a name="embed-web-ui-in-an-iframe"></a>Встраиваем веб-uI в iframe

Веб-uI Azure Data Explorer можно встраивают в iframe и размещать на сторонних веб-сайтах.

![альт текст](../images/web-ux.jpg "Веб-uI Azure Data Explorer")

Внедрение Web UX Исследователя данных Azure на ваш веб-сайт позволяет пользователям делать следующее:

- Редакторские запросы (включает в себя все языковые функции, такие как окраска и интеллект)
- Исследуйте таблицы схем визуально
- Аутентификации к AAD
- Выполнение запросов
- Отображение результатов выполнения запроса
- Создание нескольких вкладок
- Сохранение запросов локально
- Поделиться запросами по электронной почте

Вся функциональность проверяется на доступность и поддерживает темную и легкую тему.

## <a name="use-monaco-kusto-or-embed-the-web-ui"></a>Использовать Monaco-Kusto или вставлять веб-ui?

Monaco-Kusto предлагает вам опыт редактирования, такой как завершение, окраска, рефакторинг, переименование и выход на определение, он требует, чтобы вы построили решение для проверки подлинности, выполнения запроса, отображения результатов и исследования схемы вокруг него. С другой стороны, вы получаете полную гибкость, чтобы мода пользовательский опыт, который соответствует вашим потребностям.

Внедрение веб-интерфейса Azure Data Explorer Web предлагает вам обширную функциональность без особых усилий, но содержит ограниченную гибкость в отношении пользовательского интерфейса. Существует фиксированный набор параметров запроса, которые позволяют контролировать внешний вид и поведение системы.

## <a name="how-to-embed-the-web-ui-in-an-iframe"></a>Как вставить веб-узел в iframe

### <a name="host-the-website-in-iframe"></a>Размещение веб-сайта в iframe

Добавьте следующий код на свой сайт:

```html
<iframe
  src="https://dataexplorer.azure.com/clusters/<cluster>?ibizaPortal=true"
></iframe>
```

Параметр `ibizaPortal` запроса говорит, что web-иноум azure Data Explorer _не_ перенаправлять на публикацию маркера аутентификации. Это необходимо, так как хостинг-сайт отвечает за предоставление токена аутентификации ввнедренный iframe.

Заменить `<cluster>` хост-имя кластера, который необходимо загрузить `example: help.kusto.windows.net`в панель соединения (для). По умолчанию режим iframe-embedded не предоставляет способ добавления кластеров из системы пользователей, так как предполагается, что веб-сайт хостинга знает необходимый кластер.

### <a name="handle-authentication"></a>Обработка аутентификации

1. При установке в режим`ibizaPortal=true`"iframe" (), веб-миноносец Azure Data Explorer не будет пытаться перенаправить на проверку подлинности. Веб-интерфейс будет использовать механизм размещения сообщений, который браузеры используют для запроса и получения маркера. Во время загрузки страницы следующее сообщение будет размещено в родительском окне:

   ```javascript
   window.parent.postMessage(
     {
       signature: "queryExplorer",
       type: "getToken"
     },
     "*"
   );
   window.addEventListener(
     "message",
     event => this.handleIncomingMessage(event),
     false
   );
   ```

1. Затем он будет слушать сообщение со следующей структурой:

   ```json
   {
     "type": "postToken",
     "message": "${the actual authentication token}"
   }
   ```

1. Предоставленный токен должен быть [токеном JWT,](https://tools.ietf.org/html/rfc7519) полученным из [конечной точки аутентификации AAD.](../../management/access-control/how-to-authenticate-with-aad.md#web-client-javascript-authentication-and-authorization)

> [!IMPORTANT]
> Это ответственность окна хостинга, чтобы обновить токен до истечения срока действия и использовать тот же механизм, чтобы обеспечить обновленный маркер для приложения. В противном случае, как только срок действия маркера истечет, вызовы службы всегда будут сбой.

### <a name="feature-flags"></a>Функциональные флаги

Хостинг приложение может захотеть contorl некоторые аспекты пользовательского опыта. Например - скрыть панель соединения или отключить подключение к другому кластеру.
Для этого сценария веб-исследователь поддерживает флаги функций.

Флаг функции может быть использован в URL в качестве параметра запроса. Например, если хостинг-приложение желает отключить добавление другого кластера, они должны использоватьhttps://dataexplorer.azure.com/?ShowConnectionButtons=false

| Параметр                 | Описание                                                                                                                                                                                                                                                                                       | Значение по умолчанию |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------- |
| ShowShareMenu           | Показать элемент меню общего элемента                                                                                                                                                                                                                                                                          | Да          |
| Кнопки ShowConnection   | Отображите кнопку добавления соединения, чтобы добавить новый кластер                                                                                                                                                                                                                                               | Да          |
| ShowOpenNewWindowButton | Показать "открыть в веб-кнопку uI. это откроет новое окно браузера, https://dataexplorer.azure.com которое будет указывать на с правом кластера и базы данных в области                                                                                                                                   | false         |
| ShowFileMenu            | Показать меню файлов (загрузка содержимого вкладок ETC)                                                                                                                                                                                                                                                     | Да          |
| ShowtoS                 | Показать ссылку на условия обслуживания для исследователя лазурных данных из диалога настроек                                                                                                                                                                                                                | Да          |
| ShowPersona             | показать имя пользователя в правом верхнем и из меню настроек                                                                                                                                                                                                                                        | Да          |
| IFrameAuth              | Если это правда, веб-исследователь будет ожидать iframe для обработки аутентификации и обеспечить маркер через сообщение. Это всегда будет верно для сценариев iframe                                                                                                                                              | false         |
| PersistAfterEachRun     | Обычно веб-исследователь будет сохраняться в событии onunload. при хостинге в iframes, он не горит в некоторых случаях. таким образом, этот флаг вызовет упорство локального состояния после каждого запуска запроса. Таким образом, любая потеря данных, которая происходит, будет влиять только на текст, который никогда не запускался, ограничивая таким образом воздействие. | false         |
| ShowSmoothIngestion     | Если это правда, покажите 1 клик проглатывания опыт при правильном нажатии на базу данных                                                                                                                                                                                                                  | Да          |
| ОсвежилПодключение       | Если это правда, всегда обновляет схему при загрузке страницы и никогда не зависит от локального хранилища                                                                                                                                                                                                      | false         |
| ShowPageHeader          | Если это правда, отображается заголовок страницы (который включает в себя название Azure Data Explorer, настройки и другие)                                                                                                                                                                                                 | Да          |
| HideConnectionPane      | Если это правда, не отображается левое стекло соединения                                                                                                                                                                                                                                                | false         |
| СкипМонакоФокусОнит   | Исправлена проблема фокусировки при размещении на iframe                                                                                                                                                                                                                                                          | false         |

### <a name="feature-flag-presets"></a>Предели флага

пресеты установить кучу особенность флаги сразу.
Сегодня у нас есть одна пресет.

`IbizaPortal`- Изменяет следующие флаги из по умолчанию:

```json
ShowOpenNewWindowButton: true,
PersistAfterEachRun: true,
IFrameAuth: true,
ShowPageHeader: false,                                 |
```

> [!WARNING]
> Если вы используете предустановленную, вы не сможете добавить дополнительные флаги функции поверх него. Если вам нужна такая гибкость, следует использовать отдельные флаги.
