---
title: Строки подключения к хранилищу — Azure обозреватель данных | Документация Майкрософт
description: В этой статье описываются строки подключения к хранилищу в обозреватель данных Azure.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 03/23/2020
ms.openlocfilehash: 0456ad7115c51bcdc51b0db82bc9f9b88953be32
ms.sourcegitcommit: 39b04c97e9ff43052cdeb7be7422072d2b21725e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/12/2020
ms.locfileid: "83226216"
---
# <a name="storage-connection-strings"></a>Строки подключения службы хранилища

Несколько команд Kusto предписывает Kusto взаимодействовать со службами внешних хранилищ. Например, Kusto может быть предложено экспортировать данные в Azure Storage Blob, в этом случае необходимо предоставить конкретные параметры (например, имя учетной записи хранения или контейнер больших двоичных объектов).

Kusto поддерживает следующие поставщики хранилища:


* Поставщик хранилища Azure Storage Blob
* Поставщик хранилища Azure Data Lake Storage

Каждый тип поставщика хранилища определяет формат строки подключения, используемый для описания ресурсов хранилища и способов доступа к ним.
Kusto использует формат URI для описания этих ресурсов хранения и свойств, необходимых для доступа к ним (например, учетные данные безопасности).


|Поставщик                   |Схема    |Шаблон URI                          |
|---------------------------|----------|--------------------------------------|
|Большой двоичный объект хранилища Azure         |`https://`|`https://`*Учетная запись* `.blob.core.windows.net/` *Контейнер*[ `/` *BlobName*] [ `?` *саскэй* \| `;` *AccountKey*]|
|Azure Data Lake Store Gen 2|`abfss://`|`abfss://`*Файловая система* `@` *Учетная запись* `.dfs.core.windows.net/` *Пастодиректорйорфиле*[ `;` *каллеркредентиалс*]|
|Azure Data Lake Store Gen 1|`adl://`  |`adl://`*Account*. azuredatalakestore.NET/*пастодиректорйорфиле*[ `;` *каллеркредентиалс*]|

## <a name="azure-storage-blob"></a>Большой двоичный объект хранилища Azure

Этот поставщик является наиболее часто используемым и поддерживается во всех сценариях.
Поставщику необходимо предоставить учетные данные при доступе к ресурсу. Существует два поддерживаемых механизма для предоставления учетных данных:

* Укажите ключ общего доступа (SAS), используя стандартный запрос Azure Storage Blob ( `?sig=...` ). Используйте этот метод, если Kusto требуется доступ к ресурсу в течение ограниченного времени.
* Укажите ключ учетной записи хранения ( `;ljkAkl...==` ). Используйте этот метод, когда Kusto должен получить доступ к ресурсу на постоянной основе.

Примеры (Обратите внимание, что в этом примере показаны замаскированные строковые литералы, поэтому не следует предоставлять ключ учетной записи или SAS):

`h"https://fabrikam.blob.core.windows.net/container/path/to/file.csv;<storage_account_key_text, ends with '=='>"`
`h"https://fabrikam.blob.core.windows.net/container/path/to/file.csv?sv=...&sp=rwd"` 

## <a name="azure-data-lake-store"></a>Хранилище озера данных Azure

### <a name="azure-data-lake-store-gen-2"></a>Azure Data Lake Store Gen 2

Этот поставщик поддерживает доступ к данным в Azure Data Lake Store Gen 2.

Формат URI:

`abfss://`*Файловая система* `@` *StorageAccountName* `.dfs.core.windows.net/` *Путь* `;` *Каллеркредентиалс*

Где:

* _FileSystem_ — это имя объекта файловой системы ADLS (примерно эквивалентно контейнеру больших двоичных объектов).
* _StorageAccountName_ — имя учетной записи хранения.
* _Path_ — путь к каталогу или файлу, к которому осуществляется доступ символ косой черты ( `/` ) используется в качестве разделителя.
* _Каллеркредентиалс_ указывает учетные данные, используемые для доступа к службе, как описано ниже.

При обращении к Azure Data Lake Store Gen 2 вызывающий объект должен предоставить действительные учетные данные для доступа к службе. Поддерживаются следующие методы предоставления учетных данных:

* Добавьте `;sharedkey=` *ACCOUNTKEY* в URI, указав _AccountKey_ в качестве ключа учетной записи хранения.
* Добавьте `;impersonate` к URI. Kusto будет использовать удостоверение участника запрашивающей стороны и олицетворять его для доступа к ресурсу. Субъект должен иметь соответствующие назначения ролей RBAC, чтобы иметь возможность выполнять операции чтения и записи, как описано [здесь](https://docs.microsoft.com/azure/storage/blobs/data-lake-storage-access-control). (Например, роль является минимальной ролью для операций чтения `Storage Blob Data Reader` .)
* Добавьте `;token=` *ААДТОКЕН* в URI, где _аадтокен_ является маркером доступа AAD с кодировкой Base 64 (убедитесь, что маркер предназначен для ресурса `https://storage.azure.com/` ).
* Добавьте `;prompt` к URI. Kusto запрашивает учетные данные пользователя, когда ему требуется доступ к ресурсу. (Запрос пользователя отключен для облачных развертываний и включен только в тестовых средах.)
* Укажите ключ общего доступа (SAS), используя стандартный запрос Azure Data Lake Storage Gen 2 ( `?sig=...` ). Используйте этот метод, если Kusto требуется доступ к ресурсу в течение ограниченного времени.



### <a name="azure-data-lake-store-gen-1"></a>Azure Data Lake Store Gen 1

Этот поставщик поддерживает доступ к файлам и каталогам в Azure Data Lake Store.
Он должен быть предоставлен с учетными данными (Kusto не использует собственный субъект AAD для доступа к Azure Data Lake.) Поддерживаются следующие методы предоставления учетных данных:

* Добавьте `;impersonate` к URI. Kusto будет использовать удостоверение участника запрашивающей стороны и олицетворять его для доступа к ресурсу.
* Добавьте `;token=` *ААДТОКЕН* в URI, где *аадтокен* является маркером доступа AAD с кодировкой Base 64 (убедитесь, что маркер предназначен для ресурса `https://management.azure.com/` ).
* Добавьте `;prompt` к URI. Kusto запрашивает учетные данные пользователя, когда ему требуется доступ к ресурсу. (Запрос пользователя отключен для облачных развертываний и включен только в тестовых средах.)



