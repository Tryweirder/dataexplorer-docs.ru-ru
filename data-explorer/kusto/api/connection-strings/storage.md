---
title: Строки подключения к хранилищу - Azure Data Explorer Документы Майкрософт
description: В этой статье описаны строки подключения к хранению в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 03/23/2020
ms.openlocfilehash: 909198e42786666d3a26874e18b5cfd57b27ab1f
ms.sourcegitcommit: 47a002b7032a05ef67c4e5e12de7720062645e9e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/15/2020
ms.locfileid: "81502964"
---
# <a name="storage-connection-strings"></a>Строки подключения службы хранилища

Несколько команд Kusto инструктируют Kusto взаимодействовать с внешними службами хранения. Например, Кусто можно сказать, чтобы они экспортируют данные в Azure Storage Blob, и в этом случае необходимо предоставить конкретные параметры (например, имя учетной записи хранилища или контейнер с каплями).

Kusto поддерживает следующих поставщиков хранилища:


* Поставщик хранилища Azure Storage Blob
* Поставщик хранения данных Azure Data Lake

Каждый вид поставщика хранилища определяет формат строки подключения, используемый для описания ресурсов хранения и способов доступа к ним.
Kusto использует формат URI для описания этих ресурсов хранения данных и свойств, необходимых для доступа к ним (например, учетные данные безопасности).


|Поставщик                   |Схема    |Шаблон URI                          |
|---------------------------|----------|--------------------------------------|
|Большой двоичный объект хранилища Azure         |`https://`|`https://`*Контейнер для счета*`.blob.core.windows.net/`*Container*`/`»`?`*BlobName*»*SasKey* \| `;` *AccountKey*|
|Azure Data Lake Store Gen 2|`abfss://`|`abfss://`*Filesystem*`@`*учетная запись*`.dfs.core.windows.net/`*PathToDirectoryOrFile*(`;`*CallerCredentials*|
|Azure Data Lake Store Gen 1|`adl://`  |`adl://`*Учетная запись*.azuredatalakestore.net/*PathToDirectoryOrFile*-`;`*CallerCredentials*|

## <a name="azure-storage-blob"></a>Большой двоичный объект хранилища Azure

Этот поставщик является наиболее часто используемым и поддерживается во всех сценариях.
Поставщику должны быть предоставлены учетные данные при доступе к ресурсу. Существует два поддерживаемых механизма предоставления учетных данных:

* Предоставьте ключ общего доступа (SAS) с помощью стандартного запроса Azure Storage Blob ().`?sig=...` Используйте этот метод, когда Kusto необходимо получить доступ к ресурсу в течение ограниченного времени.
* Предоставьте ключ учетной записи хранилища ().`;ljkAkl...==` Используйте этот метод, когда Kusto необходимо получить доступ к ресурсу на постоянной основе.

Примеры (обратите внимание, что это показывает запутанные строки буквальные, чтобы не подвергать счет ключ или SAS):

`h"https://fabrikam.blob.core.windows.net/container/path/to/file.csv;<storage_account_key_text, ends with '=='>"`
`h"https://fabrikam.blob.core.windows.net/container/path/to/file.csv?sv=...&sp=rwd"` 

## <a name="azure-data-lake-store"></a>Хранилище озера данных Azure

### <a name="azure-data-lake-store-gen-2"></a>Azure Data Lake Store Gen 2

Этот провайдер поддерживает доступ к данным в Azure Data Lake Store Gen 2.

Формат URI:

`abfss://`*Filesystem* `@` *StorageAccountName* `.dfs.core.windows.net/` *Путь* `;` *CallerCredentials*

Где:

* _Filesystem_ — это название объекта файловой системы ADLS (примерно эквивалентно Blob Container)
* _StorageAccountName_ — это название учетной записи хранилища
* _Путь_ — это путь к каталогу или файлу, доступ к которому слэш ()`/`символ используется в качестве делимитера.
* _CallerCredentials_ указывает на учетные данные, используемые для доступа к службе, как описано ниже.

При доступе к Azure Data Lake Store Gen 2 абонент должен предоставить действительные учетные данные для доступа к службе. Поддерживаются следующие методы предоставления учетных данных:

* Придатите `;sharedkey=` *AccountKey* к URI, с _AccountKey_ является ключом учетной записи хранилища
* Придатик `;impersonate` к URI. Кусто будет использовать основную личность запрашивающего и выдавать себя за него, чтобы получить доступ к ресурсу. Директор должен иметь соответствующие назначения ролей RBAC, чтобы иметь возможность выполнять операции чтения/записи, как описано [здесь.](https://docs.microsoft.com/azure/storage/blobs/data-lake-storage-access-control) (Например, минимальная роль для `Storage Blob Data Reader` считываемых операций — это роль).
* Приложить `;token=` *AadToken* к URI, с _AadToken_ является базой-64 кодированный токен доступа AAD `https://storage.azure.com/`(убедитесь, что маркер для ресурса).
* Придатик `;prompt` к URI. Kusto запрашивает учетные данные пользователей, когда ему необходимо получить доступ к ресурсу. (Подталкивание пользователя отключено для развертывания облака и включено только в тестовых средах.)
* Предоставьте ключ общего доступа (SAS) с помощью стандартного запроса`?sig=...`Azure Data Lake Storage Gen 2 (). Используйте этот метод, когда Kusto необходимо получить доступ к ресурсу в течение ограниченного времени.



### <a name="azure-data-lake-store-gen-1"></a>Azure Data Lake Store Gen 1

Этот поставщик поддерживает доступ к файлам и каталогам в Магазине озера данных Azure.
Он должен быть предоставлен с учетными данными (Kusto не использует свой собственный принцип AAD для доступа к Озеру данных Azure.) Поддерживаются следующие методы предоставления учетных данных:

* Придатик `;impersonate` к URI. Кусто будет использовать основную личность запрашивающего и выдавать себя за него, чтобы получить доступ к ресурсу
* Приложение `;token=`_AadToken _to URI, с _AadToken_ является базой-64 кодированный токен доступа AAD `https://management.azure.com/`(убедитесь, что маркер для ресурса).
* Придатик `;prompt` к URI. Kusto будет запрашивать учетные данные пользователей, когда ему необходимо получить доступ к ресурсу. (Подталкивание пользователя отключено для развертывания облака и включено только в тестовых средах.)



