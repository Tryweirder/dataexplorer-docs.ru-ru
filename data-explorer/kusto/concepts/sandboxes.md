---
title: Песочницы - Исследователь данных Azure (ru) Документы Майкрософт
description: В этой статье описаны песочницы в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 03/30/2020
ms.openlocfilehash: faa7a8225aecd5992e3064fd10cfcc0e559c5127
ms.sourcegitcommit: 47a002b7032a05ef67c4e5e12de7720062645e9e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/15/2020
ms.locfileid: "81522973"
---
# <a name="sandboxes"></a>"Песочницы"

Служба Data Engine от Kusto способна работать с песочницами для выполнения конкретных потоков, требующих безопасной изоляции.
Примерами этих потоков являются пользовательские скрипты, которые запускаются с помощью [плагина Python](../query/pythonplugin.md) или [плагина R.](../query/rplugin.md)

Для запуска этих песочниц, Кусто использует эволюцию проекта [Drawbridge](https://www.microsoft.com/research/project/drawbridge/) от Microsoft. Это решение используется другими службами Майкрософт для запуска объектов, определяемых пользователями, в среде с несколькими арендаторами.

Потоки, которые работают в песочницах, не только изолированы, но и локальны (близко к данным), что означает отсутствие дополнительной задержки для удаленных вызовов.

## <a name="prerequisites"></a>Предварительные требования

* В движке данных **не** должно быть [включено шифрование диска.](https://docs.microsoft.com/azure/data-explorer/security#data-encryption)
  * Поддержка наличия обеих функций работает бок о бок, как ожидается, в будущем.
* Необходимые пакеты (изображения) для работы песочниц развернуты в каждом из узлов Data Engine и требуют выделенного пространства SSD для запуска
  * Предполагаемый размер составляет 20 ГБ, что, например, составляет примерно 2,5% мощности SSD D14_v2 VM, или 0,7% SSD емкость L16_v1 ВМ.
  * Это влияет на емкость данных кластера и, следовательно, может повлиять на [стоимость](https://azure.microsoft.com/pricing/details/data-explorer) кластера.

## <a name="runtime"></a>Параметры выполнения

* Оператор запроса в песочнице может использовать одну или несколько песочниц для его выполнения.
  * Они используются только для одного запуска, не распределяются по нескольким запускам и удаляются после завершения выполнения.
* Каждый узла содержит заранее определенное количество песочниц, готовых к выполнением входящих запросов.
  * После использования песочницы, новый автоматически выделяется, чтобы заменить его.
* В случае, если нет предварительно выделенных песочниц, доступных для обслуживания оператора запроса, он будет задушен.
  (см. [Ошибки,](#errors)до тех пор, пока не будут выделены новые песочницы (может занять до 10-15 секунд на песочницу, в зависимости от SKU и имеющихся ресурсов на узде данных).

## <a name="limitations"></a>Ограничения

Некоторые из этих ограничений можно контролировать с помощью [политики песочницы](../management/sandboxpolicy.md)кластерного уровня для каждого вида песочницы.

* **Количество песочниц на узла:** Количество песочниц на узла ограничено.
  * Запросы, которые сталкиваются с состоянием, в котором нет доступной песочницы, будут задушены.
* **Сеть:** Песочница не может взаимодействовать с любым ресурсом на VM или за его пределами.
  * Песочница не может взаимодействовать с другой песочницей.
* **Процессор:** Максимальная скорость процессора песочница может потреблять процессоров своего хозяина ограничена (по умолчанию). `50%`
  * Когда этот предел достигнут, использование процессора песочницы регулируется, но выполнение продолжается.
* **Память:** Максимальное количество оперативной памяти песочница может потреблять оперативной `20GB`памяти своего хозяина ограничено (по умолчанию).
  * Достижение этого предела приведет к прекращению песочницы (и ошибке выполнения запроса).
* **Диск:** Песочница имеет уникальный каталог прилагается к нему, в сторону, для которых, он не может получить доступ к файловой системе хозяина.
  * Эта папка обеспечивает доступ к изображению/пакету, который соответствует виду песочницы (например, ненастраиваемый пакет Python или R).
* **Детские процессы:** Песочница блокируется от нереста детских процессов.

> [!NOTE]
> Использование ресурсов в песочнице зависит не только от размера данных, обрабатываемых в рамках запроса, но и от логики, которая работает в песочнице, и от реализации используемых ею библиотек.
> (например, для `python` плагинов и `r` плагинов, последний означает пользовательский скрипт и библиотеки Python или R, которые он потребляет во время выполнения)

## <a name="errors"></a>ошибки

|Код                      |Сообщение                                                                                        |Потенциальная причина                                                                                                    |
|--------------------------|-----------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|
|E_SB_QUERY_THROTTLED_ERROR|Запрос в песочнице был прерван из-за регулирования. Повторная попытка после некоторого отступления может увенчаться успехом   |На целевом узлах нет доступных песочниц. Новые песочницы должны стать доступными в течение нескольких секунд         |
|E_SB_QUERY_THROTTLED_ERROR|Песочницы рода ''kind' еще не были инициализированы                                       |Политика песочницы в последнее время изменилась. Новые песочницы, подчиняющиеся новой политике, станут доступны через несколько секунд|