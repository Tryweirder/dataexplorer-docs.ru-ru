---
title: Политика емкости — Azure обозреватель данных
description: В этой статье описывается политика емкости в Azure обозреватель данных.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 03/12/2020
ms.openlocfilehash: a7f34f51ee38b10c51c469c0145081f5bb702d8f
ms.sourcegitcommit: 8e097319ea989661e1958efaa1586459d2b69292
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2020
ms.locfileid: "84780224"
---
# <a name="capacity-policy"></a>Политика емкости

Политика емкости используется для управления ресурсами вычислений операций управления данными в кластере.

## <a name="the-capacity-policy-object"></a>Объект политики емкости

Политика емкости состоит из следующих элементов:

* [инжестионкапаЦити](#ingestion-capacity)
* [екстентсмержекапаЦити](#extents-merge-capacity)
* [екстентспуржеребуилдкапаЦити](#extents-purge-rebuild-capacity)
* [експорткапаЦити](#export-capacity)
* [екстентспартитионкапаЦити](#extents-partition-capacity)

## <a name="ingestion-capacity"></a>Емкость приема

|Свойство.                           |Тип    |Описание                                                                                                                                                                               |
|-----------------------------------|--------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|клустермаксимумконкуррентоператионс |long    |Максимальное значение для числа одновременных операций приема в кластере                                          |
|кореутилизатионкоеффиЦиент         |double  |Коэффициент для процента ядер, используемых при вычислении емкости приема. Результат вычисления всегда будет нормализован`ClusterMaximumConcurrentOperations`                          |

Общая емкость приема кластера, как показано в [. Показать емкость](../management/diagnostics.md#show-capacity), вычисляется следующим образом:

Минимум ( `ClusterMaximumConcurrentOperations` , `Number of nodes in cluster` * максимум (1, `Core count per node`  *  `CoreUtilizationCoefficient` ))

> [!Note]
> В кластерах с тремя или более узлами узел Admin не участвует в операциях приема. Объект `Number of nodes in cluster` уменьшается на единицу.

## <a name="extents-merge-capacity"></a>Емкость слияния экстентов

|Свойство.                           |Тип    |Описание                                                                                                |
|-----------------------------------|--------|-----------------------------------------------------------------------------------------------------------|
|минимумконкуррентоператионсперноде |long    |Минимальное значение для количества одновременных операций объединения и перестроения на одном узле. Значение по умолчанию — 1 |
|максимумконкуррентоператионсперноде |long    |Максимальное значение для количества одновременных операций слияния/перестроения на одном узле. Значение по умолчанию — 5 |

Общая емкость кластера для объединения экстентов, как показано в [. Показать емкость](../management/diagnostics.md#show-capacity), вычисляется следующим образом:

`Number of nodes in cluster`x`Concurrent operations per node`

Эффективное значение для `Concurrent operations per node` получается автоматически в соответствии с системой в диапазоне [ `MinimumConcurrentOperationsPerNode` , `MaximumConcurrentOperationsPerNode` ].

> [!Note]
> * В кластерах с тремя или более узлами узел Admin не участвует в операциях слияния. Объект `Number of nodes in cluster` уменьшается на единицу.

## <a name="extents-purge-rebuild-capacity"></a>Емкость очистки при очистке экстентов

|Свойство.                           |Тип    |Описание                                                                                                                           |
|-----------------------------------|--------|--------------------------------------------------------------------------------------------------------------------------------------|
|максимумконкуррентоператионсперноде |long    |Максимальное значение для числа параллельных перестроения экстентов для операций очистки на одном узле |

Общая емкость кластера для очистки экстентов перестроения (как показано на рисунке [. Показать емкость](../management/diagnostics.md#show-capacity)) вычисляется следующим образом:

`Number of nodes in cluster`x`MaximumConcurrentOperationsPerNode`

> [!Note]
> В кластерах с тремя или более узлами узел Admin не участвует в операциях слияния. Объект `Number of nodes in cluster` уменьшается на единицу.

## <a name="export-capacity"></a>Экспорт емкости

|Свойство.                           |Тип    |Описание                                                                                                                                                                            |
|-----------------------------------|--------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|клустермаксимумконкуррентоператионс |long    |Максимальное значение для количества одновременных операций экспорта в кластере.                                           |
|кореутилизатионкоеффиЦиент         |double  |Коэффициент для процента ядер, используемых при вычислении емкости экспорта. Результат вычисления всегда будет нормализован `ClusterMaximumConcurrentOperations` . |

Общая емкость экспорта кластера, как показано в [. Показать емкость](../management/diagnostics.md#show-capacity), вычисляется следующим образом:

Минимум ( `ClusterMaximumConcurrentOperations` , `Number of nodes in cluster` * максимум (1, `Core count per node`  *  `CoreUtilizationCoefficient` ))

> [!Note]
> В кластерах с тремя или более узлами узел Admin не участвует в операциях экспорта. Объект `Number of nodes in cluster` уменьшается на единицу.

## <a name="extents-partition-capacity"></a>Емкость раздела "экстенты"

|Свойство.                           |Тип    |Описание                                                                                         |
|-----------------------------------|--------|----------------------------------------------------------------------------------------------------|
|клустерминимумконкуррентоператионс |long    |Минимальное значение для количества одновременных операций секционирования в кластере. Значение по умолчанию: 1.  |
|клустермаксимумконкуррентоператионс |long    |Максимальное значение для количества одновременных операций секционирования в кластере. По умолчанию: 16 |

Общее количество экстентов кластера (как показано в разделе [. Показать емкость](../management/diagnostics.md#show-capacity)).

Эффективное значение для `Concurrent operations` автоматически корректируется системой в диапазоне [ `ClusterMinimumConcurrentOperations` , `ClusterMaximumConcurrentOperations` ].

## <a name="defaults"></a>Значения по умолчанию

Политика емкости по умолчанию имеет следующее представление JSON:

```kusto 
{
  "IngestionCapacity": {
    "ClusterMaximumConcurrentOperations": 512,
    "CoreUtilizationCoefficient": 0.75
  },
  "ExtentsMergeCapacity": {
    "MaximumConcurrentOperationsPerNode": 1
  },
  "ExtentsPurgeRebuildCapacity": {
    "MaximumConcurrentOperationsPerNode": 1
  },
  "ExportCapacity": {
    "ClusterMaximumConcurrentOperations": 100,
    "CoreUtilizationCoefficient": 0.25
  }
}
```

## <a name="control-commands"></a>Управляющие команды

> [!WARNING]
> Перед изменением политики емкости обратитесь к группе Azure обозреватель данных.

* Используйте [. Отобразите емкость политики кластера](capacity-policy.md#show-cluster-policy-capacity) , чтобы отобразить текущую политику емкости кластера.

* Чтобы изменить политику емкости кластера, используйте команду [. ALTER Cluster Policy Capacity](capacity-policy.md#alter-cluster-policy-capacity) .

## <a name="throttling"></a>Регулирование

Kusto ограничивает количество одновременных запросов для следующих инициированных пользователем команд:

* Приемы (включая все приведенные [здесь](../../ingest-data-overview.md)команды)
   * Ограничение определяется в [политике емкости](#capacity-policy).
* Очищает
   * В настоящее время глобальный характер фиксируется на одном кластере.
   * Емкость очистки при перестроении используется для внутренних целей, чтобы определить количество параллельных операций перестроения во время выполнения команд очистки. Команды очистки не будут заблокированы или регулируемы из-за этого процесса, но будут работать быстрее или медленнее в зависимости от объема очистки для перестроения.
* Экспортируемые элементы
   * Ограничение определяется в [политике емкости](#capacity-policy).

Когда кластер обнаруживает, что операция превысила разрешенную параллельную операцию, она будет отвечать на 429, "регулируемый" код HTTP.
Повторите операцию после некоторой задержки.
