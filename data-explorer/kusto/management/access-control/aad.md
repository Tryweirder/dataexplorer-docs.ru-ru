---
title: Проверка подлинности Azure Active Directory (AAD) — Azure обозреватель данных | Документация Майкрософт
description: В этой статье описывается проверка подлинности Azure Active Directory (AAD) в обозреватель данных Azure.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.custom: has-adal-ref
ms.date: 09/13/2019
ms.openlocfilehash: 17da89206af12e2e4f7d9867372c8babf0c4aea1
ms.sourcegitcommit: f6cf88be736aa1e23ca046304a02dee204546b6e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2020
ms.locfileid: "82862095"
---
# <a name="azure-active-directory-aad-authentication"></a>Проверка подлинности Azure Active Directory (AAD)

Azure Active Directory (AAD) — это предпочтительная для Azure мультитенатная облачная служба каталогов, которая позволяет выполнять проверку подлинности для субъектов безопасности или настраивать федерацию с другими поставщиками удостоверений, например Microsoft Active Directory.

AAD позволяет применять различные типы (веб-приложение, классическое приложение Windows, универсальные приложения, мобильные приложения и т. д.) для единообразной проверки подлинности и использования Kusto Services.

AAD поддерживает несколько сценариев проверки подлинности.
Если во время проверки подлинности присутствует пользователь, он должен пройти проверку подлинности пользователя AAD с помощью аутентификации пользователя AAD.
В некоторых случаях один из них хочет, чтобы служба использовала Kusto, даже если пользователь в интерактивном режиме отсутствует. В таких случаях необходимо проверить подлинность приложения с помощью секрета приложения, как описано в разделе Проверка подлинности приложения AAD.

Следующие методы проверки подлинности поддерживаются Kusto в целом, в том числе в библиотеках .NET:

* Интерактивная проверка подлинности пользователя. Этот режим требует интерактивного взаимодействия, как при необходимости, при входе в систему пользовательского интерфейса входа
* Проверка подлинности пользователя с помощью существующего токена AAD, ранее выданного для Kusto
* Проверка подлинности приложения с AppID и общим секретом
* Проверка подлинности приложения с локально установленным сертификатом X. 509v2 или сертификатом, предоставленным встроенным
* Проверка подлинности приложения с существующим токеном AAD, который ранее был выдан для Kusto
* Проверка подлинности пользователя или приложения с помощью токена AAD, выданного для другого ресурса, между этим ресурсом и Kustoом существует отношение доверия.

Инструкции и примеры см. в справочнике по [строкам подключения Kusto](../../api/connection-strings/kusto.md) .

## <a name="user-authentication"></a>Аутентификация пользователей

Аутентификация пользователя выполняется, когда он передает учетные данные в AAD (или другому поставщику удостоверений, для которого настроена федерация с AAD, например ADFS), и возвращает маркер безопасности для предъявления службе Kusto. Служба Kusto не определяет, как был получен этот маркер безопасности, а проверяет лишь его действительность и информацию, размещенную в нем службой AAD (или федеративным поставщиком удостоверений).

На стороне клиента Kusto поддерживает, во-первых, интерактивную проверку подлинности, при которой клиентская библиотека ADAL из AAD или другой аналогичный код предлагает пользователю ввести учетные данные. Во-вторых, платформа поддерживает проверку подлинности на основе маркеров, при которой приложение, использующее Kusto, получает действительный маркер пользователя и представляет его. И в-третьих, Kusto поддерживает сценарий, в котором приложение, использующее эту платформу, получает действительный маркер пользователя для другой службы (не Kusto), если существует отношение доверия между этим ресурсом и Kusto.

Дополнительные сведения об использовании клиентских библиотек Kusto и проверке подлинности на этой платформе с помощью AAD см. в статье [о строках подключения Kusto](../../api/connection-strings/kusto.md).

## <a name="application-authentication"></a>Проверка подлинности приложения

Если запросы не связаны с конкретным пользователем или пользователь не может ввести учетные данные, можно использовать поток проверки подлинности приложения AAD. В этом потоке приложение выполняет проверку подлинности в AAD (или у федеративного поставщика удостоверений), предоставляя некоторую секретную информацию. Разные клиенты Kusto поддерживают следующие сценарии:

* проверка подлинности приложения с помощью локально установленного сертификата X.509v2;
* проверка подлинности приложения с помощью сертификата X.509v2, передаваемого в клиентскую библиотеку как поток байтов;
* проверка подлинности приложения с помощью идентификатора приложения AAD и ключа приложения AAD (эквиваленты имени пользователя и пароля для проверки подлинности приложений);
* проверка подлинности приложения с помощью полученного ранее действительного токена AAD (выпущенного для Kusto);
* проверка подлинности приложения с помощью полученного ранее действительного токена AAD, выданного другому ресурсу, при наличии отношения доверия между этим ресурсом и Kusto.

## <a name="aad-server-application-permissions"></a>Разрешения приложения сервера AAD

В общем случае серверное приложение AAD может определять несколько разрешений (например, разрешение только на чтение и разрешение на чтение), а клиентское приложение AAD может решить, какие разрешения требуются ему при запросе маркера авторизации. В рамках получения маркера пользователю будет предложено авторизовать клиентское приложение AAD от имени пользователя с авторизацией, чтобы иметь эти разрешения. Если пользователь утверждается, эти разрешения будут перечислены в утверждении области действия маркера, выданного клиентскому приложению AAD.



Клиентское приложение AAD настроено для запроса разрешения "доступ Kusto" у пользователя (который AAD вызывает "владелец ресурса").

## <a name="kusto-client-sdk-as-an-aad-client-application"></a>Пакет SDK клиента Kusto в виде клиентского приложения AAD

Когда клиентские библиотеки Kusto вызывают ADAL (клиентскую библиотеку AAD), чтобы получить маркер для взаимодействия с Kusto, библиотека предоставляет следующие сведения:

1. Клиент AAD, полученный от вызывающей стороны
2. Идентификатор клиентского приложения AAD
3. Идентификатор ресурса клиента AAD
4. Реплюрл AAD (URL-адрес, по которому будет перенаправлена служба AAD после успешного завершения проверки подлинности; Затем ADAL захватывает это перенаправление и извлекает из него код авторизации).
5. Универсальный код ресурса (URIhttps://Cluster-and-region.kusto.windows.net) кластера ("").

Токен, возвращенный ADAL в клиентскую библиотеку Kusto, имеет серверное приложение Kusto AAD в качестве аудитории и разрешение доступа Kusto в качестве области.

## <a name="authenticating-with-aad-programmatically"></a>Программная проверка подлинности в AAD

В следующих статьях объясняется, как программным способом выполнить проверку подлинности в Kusto с помощью AAD:

* [Как подготавливать приложение AAD](./how-to-provision-aad-app.md)
* [Выполнение проверки подлинности AAD](./how-to-authenticate-with-aad.md)
