---
title: Активная каталог Azure (AAD) Аутентификация - Azure Data Explorer Документы Майкрософт
description: В этой статье описывается активная каталог Azure (AAD) Аутентификация в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 09/13/2019
ms.openlocfilehash: 637252b91af53198b3ee494309857b2d4b6e6828
ms.sourcegitcommit: 47a002b7032a05ef67c4e5e12de7720062645e9e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/15/2020
ms.locfileid: "81522939"
---
# <a name="azure-active-directory-aad-authentication"></a>Активная каталог Azure (AAD) Аутентификация

Azure Active Directory (AAD) — это предпочтительная для Azure мультитенатная облачная служба каталогов, которая позволяет выполнять проверку подлинности для субъектов безопасности или настраивать федерацию с другими поставщиками удостоверений, например Microsoft Active Directory.

AAD позволяет применять различные виды (веб-приложения, настольные приложения Windows, универсальные приложения, мобильные приложения и т.д.) для равномерной аутентификации и использования услуг Kusto.

AAD поддерживает ряд сценариев аутентификации.
Если во время проверки подлинности присутствует пользователь, следует проверить подлинность пользователя к AAD с помощью аутентификации пользователя AAD.
В некоторых случаях хочется, чтобы служба использовала Kusto, даже если пользователь не присутствует в интерактивном режиме. В таких случаях необходимо проверить подлинность приложения с помощью секрета приложения, как описано в аутентификации приложений AAD.

Следующие методы аутентификации поддерживаются Kusto в целом, в том числе через его библиотеки .NET:

* Интерактивная аутентификация пользователя - этот режим требует интерактивности, как если это необходимо, logon UI появится
* Аутентификация пользователей с существующим токеном AAD, ранее выпущенным для Kusto
* Аутентификация приложения с Помощью AppID и общий секрет
* Проверка подлинности приложения с установленным на локальном уровне сертификатом X.509v2 или сертификатом, предоставленным в строке
* Аутентификация приложений с существующим токеном AAD, ранее выданным для Kusto
* Проверка подлинности пользователя или приложения с токеном AAD, выданным для другого ресурса, при условии наличия доверия между этим ресурсом и Kusto

Пожалуйста, ознакомьтесь со ссылкой на [строки соединения Kusto](../../api/connection-strings/kusto.md) для руководства и примеров.

## <a name="user-authentication"></a>Аутентификация пользователей

Аутентификация пользователя выполняется, когда он передает учетные данные в AAD (или другому поставщику удостоверений, для которого настроена федерация с AAD, например ADFS), и возвращает маркер безопасности для предъявления службе Kusto. Служба Kusto не определяет, как был получен этот маркер безопасности, а проверяет лишь его действительность и информацию, размещенную в нем службой AAD (или федеративным поставщиком удостоверений).

На стороне клиента Kusto поддерживает, во-первых, интерактивную проверку подлинности, при которой клиентская библиотека ADAL из AAD или другой аналогичный код предлагает пользователю ввести учетные данные. Во-вторых, платформа поддерживает проверку подлинности на основе маркеров, при которой приложение, использующее Kusto, получает действительный маркер пользователя и представляет его. И в-третьих, Kusto поддерживает сценарий, в котором приложение, использующее эту платформу, получает действительный маркер пользователя для другой службы (не Kusto), если существует отношение доверия между этим ресурсом и Kusto.

Дополнительные сведения об использовании клиентских библиотек Kusto и проверке подлинности на этой платформе с помощью AAD см. в статье [о строках подключения Kusto](../../api/connection-strings/kusto.md).

## <a name="application-authentication"></a>Проверка подлинности приложения

Если запросы не связаны с конкретным пользователем или пользователь не может ввести учетные данные, можно использовать поток проверки подлинности приложения AAD. В этом потоке приложение выполняет проверку подлинности в AAD (или у федеративного поставщика удостоверений), предоставляя некоторую секретную информацию. Разные клиенты Kusto поддерживают следующие сценарии:

* проверка подлинности приложения с помощью локально установленного сертификата X.509v2;
* проверка подлинности приложения с помощью сертификата X.509v2, передаваемого в клиентскую библиотеку как поток байтов;
* проверка подлинности приложения с помощью идентификатора приложения AAD и ключа приложения AAD (эквиваленты имени пользователя и пароля для проверки подлинности приложений);
* проверка подлинности приложения с помощью полученного ранее действительного токена AAD (выпущенного для Kusto);
* проверка подлинности приложения с помощью полученного ранее действительного токена AAD, выданного другому ресурсу, при наличии отношения доверия между этим ресурсом и Kusto.

## <a name="aad-server-application-permissions"></a>Разрешения на применение серверов AAD

В общем случае приложение AAD Server может определить несколько разрешений (например, разрешение только на чтение и разрешение на чтение-писателя), а клиентское приложение AAD может решить, какие разрешения ему нужны, когда запрашивает токен авторизации. В рамках приобретения токенов пользователю будет предложено разрешить клиентскому приложению AAD действовать от имени пользователя с разрешением на получение этих разрешений. Если пользователь одобрит, эти разрешения будут перечислены в претензии сферы действия токена, выданного клиентскому приложению AAD.



Клиентское приложение AAD настроено для запроса разрешения «Доступ Кусто» у пользователя (которое AAD называет «владельцем ресурса»).

## <a name="kusto-client-sdk-as-an-aad-client-application"></a>Пакет SDK клиента Kusto в виде клиентского приложения AAD

Когда клиентские библиотеки Kusto вызывают ADAL (клиентскую библиотеку AAD), чтобы получить маркер для взаимодействия с Kusto, библиотека предоставляет следующие сведения:

1. Арендатор AAD, полученный от вызывателя
2. Идентификатор клиентского приложения AAD
3. Идентификатор ресурса клиента AAD
4. AAD ReplyUrl (URL, который служба AAD перенаправит после успешного завершения аутентификации; Затем ADAL фиксирует это перенаправление и извлекает из него код авторизации).
5. Кластер URI (').https://Cluster-and-region.kusto.windows.net

Токен, возвращенный ADAL в клиентскую библиотеку Kusto, имеет в качестве аудитории приложение Kusto AAD Server И разрешение «Доступ Кусто».

## <a name="authenticating-with-aad-programmatically"></a>Аутентификации с AAD программно

Следующие статьи объясняют, как программно аутентифицировать Кусто с Помощью AAD:

* [Как предоставить приложение AAD](./how-to-provision-aad-app.md)
* [Как выполнить AAD аутентификации](./how-to-authenticate-with-aad.md)

