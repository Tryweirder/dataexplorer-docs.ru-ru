---
title: Управление объемами (осколки данных) - Azure Data Explorer Документы Майкрософт
description: В этой статье описывается управление extents (осколками данных) в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/19/2020
ms.openlocfilehash: e94b830809bf079e612b477292d00d2dbe85e60e
ms.sourcegitcommit: e94be7045d71a0435b4171ca3a7c30455e6dfa57
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81744729"
---
# <a name="extents-data-shards-management"></a>Управление размерами (осколками данных)

Осколки данных в Кусто называются **размерами,** и все команды используют «extent» или «extents» в качестве синонима.

## <a name="show-extents"></a>.показать степени

**Кластерный уровень**

`.show` `cluster` `extents` [`hot`]

Отображает информацию о масштабах (осколки данных), присутствующих в кластере.
Если `hot` указано - отображает только степени, которые, как ожидается, будут находиться в горячем кэше.

**Уровень базы данных**

`.show``database` *База данныхИмя* `extents` -`(`*ExtentId1*`,`... `,` *ExtentIdN*`)`-`hot`й`where` `tags` `has`|`contains`|(`!has``and` `tags` `has`|`contains` *Tag2* *Tag1* |: :`!has`Tag1 (|) Tag2`!contains`|`!contains`

Отображает информацию о масштабах (осколки данных), которые присутствуют в указанной базе данных.
Если `hot` указано - отображает только степени, которые, как ожидается, будут в горячем кэше.

**Уровень таблиц**

`.show``table` *ТаблицаИмя* `extents` -`(`*ExtentId1*`,`... `,` *ExtentIdN*`)`-`hot`й`where` `tags` `has`|`contains`|(`!has``and` `tags` `has`|`contains` *Tag2* *Tag1* |: :`!has`Tag1 (|) Tag2`!contains`|`!contains`

`.show``tables` `,`TableName1 ... *TableName1* `(` `,` *ТаблицаНайН* `)` `extents` -`(`*ExtentId1*`,`... `,` *ExtentIdN*`)`-`hot`й`where` `tags` `has`|`contains`|(`!has``and` `tags` `has`|`contains` *Tag2* *Tag1* |: :`!has`Tag1 (|) Tag2`!contains`|`!contains`

Отображает информацию о масштабах (осколки данных), присутствуюте в указанной таблице (s) (база данных взята из контекста команды).
Если `hot` указано - отображает только степени, которые, как ожидается, будут в горячем кэше.

**ПРИМЕЧАНИЯ**

* Использование команд уровня базы данных и/или таблицго `| where DatabaseName == '...' and TableName == '...'`происходит гораздо быстрее, чем фильтрация (добавление) результатов команды кластерного уровня.
* При наличии факультативного перечня идонов объема набор возвращенных данных ограничен только этими объемами.
    * Опять же, это гораздо `| where ExtentId in(...)` быстрее, чем фильтрация (добавляя) результаты "голых" команд.
* В `tags` случае, если фильтры указаны:
  * Возвращенный список ограничен теми, в каких размерах коллекция тегов подчиняется *всем* предоставленным фильтрам тегов.
    * Опять же, это гораздо `| where Tags has '...' and Tags contains '...'`быстрее, чем фильтрация (добавление) результаты "голых" команд.
  * `has`фильтры являются фильтрами равенства: степени, которые не помечены ни одним из указанных тегов, будут отфильтрочены.
  * `!has`фильтры являются равными отрицательными фильтрами: степени, помеченные одним из указанных тегов, будут отфильтрочены.
  * `contains`фильтры являются нечувствительными фильтрами подстроки: степени, которые не имеют указанных строк в качестве подстроки любого из их тегов, будут отфильтрованы. 
  * `!contains`фильтры являются нечувствительными подстроки отрицательными фильтрами: степени, которые имеют указанные строки в качестве подстроки любого из их тегов, будут отфильтрованы. 
  
  * **Примеры**
    * Размер `E` в `T` таблице помечен `aaa`тегами `BBB` `ccc`и .
    * Этот запрос вернется: `E` 
    
    ```kusto 
    .show table T extents where tags has 'aaa' and tags contains 'bb' 
    ``` 
    
    * Этот запрос *не* `E` возвращается (так как он не помечен `aa`тегом, который равен):
    
    ```kusto 
    .show table T extents where tags has 'aa' and tags contains 'bb' 
    ``` 
    
    * Этот запрос вернется: `E` 
    
    ```kusto 
    .show table T extents where tags contains 'aaa' and tags contains 'bb' 
    ``` 

|Выходной параметр |Тип |Описание 
|---|---|---
|ExtentId |Guid |Идентификатор степени 
|имя_базы_данных |Строка |База данных, которая принадлежит 
|TableName |Строка |Таблица, к которой относятся степени 
|Макстоутон |Дата и время |Дата-время, когда объем был создан (для объединенного размера - максимум времени создания среди источников объемов) 
|OriginalSize |Double |Исходный размер в байтах данных о степени 
|ExtentSize |Double |Размер размера в памяти (сжатый индекс) 
|СжатыйРазмер |Double |Сжатый размер данных в памяти 
|IndexSize |Double |Размер индекса данных о степени 
|Блоки |Long |Объем блоков данных в объеме 
|Сегменты |Long |Объем сегмента данных в объеме 
|НазначенныеДанныеНооды |Строка | Обеззараженный (пустая строка)
|ЗагруженныеДанныеНоды |Строка |Обеззараженный (пустая строка)
|Значительное расширениеcontainerId |Строка | Идентификатор степени контейнера в
|RowCount |Long |Количество строк в объеме
|MinCreatedOn |Дата и время |Дата-время, когда объем был создан (для слияния степени - минимальный срок создания среди источников объемов) 
|Теги|Строка|Теги, если таковые имеется, определены для степени 
 
**Примеры**

```kusto 
// Show volume of extents being created per hour in a specific database
.show database MyDatabase extents | summarize count(ExtentId) by MaxCreatedOn bin=time(1h) | render timechart  

// Show volume of data arriving by table per hour 
.show database MyDatabase extents  
| summarize sum(OriginalSize) by TableName, MaxCreatedOn bin=time(1h)  
| render timechart

// Show data size distribution by table 
.show database MyDatabase extents | summarize sum(OriginalSize) by TableName

// Show all extents in the database named 'GamesDB' 
.show database GamesDB extents

// Show all extents in the table named 'Games' 
.show table Games extents

// Show all extents in the tables named 'TaggingGames1' and 'TaggingGames2', tagged with both 'tag1' and 'tag2' 
.show tables (TaggingGames1,TaggingGames2) extents where tags has 'tag1' and tags has 'tag2'
``` 
 
## <a name="merge-extents"></a>.merge масштабы

**Синтаксис**

`.merge``[async | dryrun]` *TableName* `,` *GUID2* *GUID1* Название таблицы GUID1 - GUID2 ...» `(` `)``[with(rebuild=true)]`

Эта команда объединяет степени (см.: [Обзор размеров (Осколки данных)](extents-overview.md), указанный их идолопов в указанной таблице.

Есть 2 вкуса для операций слияния: *Слияние* (которое восстанавливает индексы) и *Rebuild* (который полностью перестраивает данные).

* `async`: Операция будет выполняться асинхронно - результатом будет идентификатор `.show operations <operation ID>` операции (GUID), с которым можно работать, чтобы просмотреть состояние команды & статус.
* `dryrun`: Операция будет только список масштабов, которые должны быть объединены, но на самом деле не объединить их. 
* `with(rebuild=true)`: объемы будут восстановлены (данные будут перестроены) вместо слитых (индексы будут восстановлены).

**Выход возврата**

Выходной параметр |Тип |Описание 
---|---|---
OriginalExtentId |строка |Уникальный идентификатор (GUID) для исходной степени в исходной таблице, который был объединен в целевой объем. 
ResultExtentId |строка |Уникальный идентификатор (GUID) для степени результата, который был создан из исходных объемов. При сбое - "Не удалось" или "Заброшено".
Duration |Интервал времени |Период времени, займемый для завершения операции слияния.

**Примеры**

Восстанавливает две конкретные `MyTable`степени в, выполняется асинхронно
```kusto
.merge async MyTable (e133f050-a1e2-4dad-8552-1f5cf47cab69, 0d96ab2d-9dd2-4d2c-a45e-b24c65aa6687) with(rebuild=true)
```

Слияние двух конкретных `MyTable`степени в , выполняется синхронно
```kusto
.merge MyTable (12345050-a1e2-4dad-8552-1f5cf47cab69, 98765b2d-9dd2-4d2c-a45e-b24c65aa6687)
```

**Примечания**
- В общем, `.merge` команды редко выполняются вручную, и они постоянно выполняются автоматически в фоновом режиме кластера Kusto (в соответствии с [политиками слияния, определенными](mergepolicy.md) для таблиц и баз данных в нем).  
  - Общие соображения о критериях слияния нескольких размеров в одну из них документированы в соответствии с [политикой слияния.](mergepolicy.md)
- `.merge`операции имеют возможное `Abandoned` окончательное состояние (что `.show operations` можно увидеть при запуске с идентификатором операции) - это состояние предполагает, что объемы источников не были объединены вместе, так как некоторые из объемов источника больше не существуют в таблице исходного кода.
  - Такое состояние, как ожидается, произойдет в таких случаях, как:
     - Объемы источников были удалены в рамках удержания таблицы.
     - Объемы источников были перемещены в другую таблицу.
     - Исходная таблица была полностью удалена или переименована.

## <a name="move-extents"></a>.move степени

**Синтаксис**

`.move`-`async` `extents` `table` *DestinationTableName* *SourceTableName* ИсточникTableName `to` DestinationTableName `all` `from` `table`

`.move``extents` `(` *GUID1* GUID1`async`-`,` *GUID2* ...» `)` `table` *DestinationTableName* *SourceTableName* SourceTableName `to` DestinationTableName `from` `table` 

`.move`Запрос`async` `table` *query* *DestinationTableName* <| DestinationTableName `extents` `to`

Эта команда выполняется в контексте определенной базы данных и перемещает указанные степени из исходной таблицы в таблицу назначения транзакционно.
Требуется [разрешение админовата таблицтаблицы](../management/access-control/role-based-authorization.md) для исходного и назначения.

* `async`(по желанию) указывается, выполняется ли команда асинхронно (в этом случае идентификатор операции (Guid) возвращается, и состояние операции можно контролировать с помощью команды [операций .show).](operations.md#show-operations)
    * В случае использования этой опции результаты успешного выполнения могут быть получены в команде ["Детали операции .show".](operations.md#show-operation-details)

Существует три способа определить, в каких размерах двигаться:
1. Все размеры конкретной таблицы должны быть перемещены.
2. Явно указывая степень идотов в исходной таблице.
3. Предоставляя запрос, результаты которого указывают степень идов в исходной таблице (ы).

**Ограничения**
- Таблицы исходного кода и назначения должны находиться в базе данных контекста. 
- Ожидается, что все столбцы в исходной таблице будут существовать в таблице назначения с тем же именем и типом данных.

**Определение масштабов с помощью запроса**

```kusto 
.move extents to table TableName <| ...query... 
```

Степени указаны с помощью запроса Kusto, который возвращает набор записей с столбцей под названием "ExtentId". 

**Выход возврата** (для выполнения синхронизации)

Выходной параметр |Тип |Описание 
---|---|---
OriginalExtentId |строка |Уникальный идентификатор (GUID) для исходной степени в исходной таблице, которая была перемещена в таблицу назначения. 
ResultExtentId |строка |Уникальный идентификатор (GUID) для степени результата, который был перемещен из исходной таблицы в таблицу назначения. При сбое - "Не удалось".
Сведения |строка |Включает сведения о сбое в случае сбоя операции.

**Примеры**

Перемещает все степени `MyTable` в `MyOtherTable`таблице к столу .
```kusto
.move extents all from table MyTable to table MyOtherTable
```

Перемещает 2 конкретных степени (по их степени `MyTable` идов) от стола к столу `MyOtherTable`.
```kusto
.move extents (AE6CD250-BE62-4978-90F2-5CB7A10D16D7,399F9254-4751-49E3-8192-C1CA78020706) from table MyTable to table MyOtherTable
```

Перемещает все степени от 2`MyTable1` `MyTable2`конкретных `MyOtherTable`таблиц (, ) к таблице .
```kusto
.move extents to table MyOtherTable <| .show tables (MyTable1,MyTable2) extents
```

**Вывод примера** 

|OriginalExtentId |ResultExtentId| Сведения
|---|---|---
|e133f050-a1e2-4dad-8552-1f5cf47cab69 |0d96ab2d-9dd2-4d2c-a45e-b24c65aa6687| 
|cdbeb35b-87ea-499f-b545-defbae091b57 |a90a303c-8a14-4207-8f35-d8ea94ca45be| 
|4fcb4598-9a31-4614-903c-0c67c286da8c |97aafea1-59ff-4312-b06b-08f42187872f| 
|2dfdef64-62a3-4950-a130-96b5b1083b5a |0fb7f3da-5e28-4f09-a000-e62eb41592df| 

## <a name="drop-extents"></a>.drop степени

Капли степени из указанной базы данных / таблицы. Эта команда имеет несколько вариантов: в одном варианте степени, которые будут удалены, указаны запросом Kusto, в то время как в других вариантах степени указаны с помощью мини-языка, описанного ниже. 
 
### <a name="specifying-extents-with-a-query"></a>Определение масштабов с помощью запроса

Требуется [разрешение на получение разрешения на разбивку](../management/access-control/role-based-authorization.md) для настольных таблиц, которые имеют степени, возвращенные предоставленным запросом.

Капли степени (или просто сообщает о `whatif` них, фактически не снижается, если используется):

**Синтаксис**

`.drop``extents` -`whatif`<*запрос*

Степени указаны с помощью запроса Kusto, который возвращает набор записей с столбцей под названием "ExtentId". 
 
### <a name="dropping-a-specific-extent"></a>Удаление определенной степени

Требуется [разрешение админового в](../management/access-control/role-based-authorization.md) случае указанного имени таблицы.

Требуется [разрешение администрирования администрирования базы данных](../management/access-control/role-based-authorization.md) в случае, если имя таблицы не указано.

**Синтаксис**

`.drop``extent` *Значительное иссяковое* название`from` *таблицы*

### <a name="dropping-specific-multiple-extents"></a>Удаление определенных множественных уровней

Требуется [разрешение админового в](../management/access-control/role-based-authorization.md) случае указанного имени таблицы.

Требуется [разрешение администрирования администрирования базы данных](../management/access-control/role-based-authorization.md) в случае, если имя таблицы не указано.

**Синтаксис**

`.drop``extents` `,`ExtentId1 ... *ExtentId1* `(` *ExtentIdN* `)` `from` - *Таблица Имя*

### <a name="specifying-extents-by-properties"></a>Определение размеров по свойствам

Требуется [разрешение админового в](../management/access-control/role-based-authorization.md) случае указанного имени таблицы.

Требуется [разрешение администрирования администрирования базы данных](../management/access-control/role-based-authorization.md) в случае, если имя таблицы не указано.

`.drop``extents` `older` *N* (`days` | `GB` | `bytes``MB``extentsize` | `datasize``trim` `by` `tables` |  `all` `limit` *LimitCount* *N* *TableName* ) `from` ( Название таблицы ) ( ) N ( ) » » » » » | `hours`

* `older`: Будут удалены только степени старше *N* дней/часов. 
* `trim`: Операция будет обрезать данные в базе данных до тех пор, пока сумма уровней не будет совпадать с желаемым размером (MaxSize) 
* `limit`: Операция будет применена к первым размерам *LimitCount* 

Команда поддерживает режим`.drop-pretend` эмуляции `.drop`(вместо), который производит выход, как будто команда будет работать, но фактически не исполняя его.

**Примеры**

Удалите все степени, созданные более 10 дней назад, из всех таблиц базы данных`MyDatabase`

```kusto
.drop extents <| .show database MyDatabase extents | where CreatedOn < now() - time(10d)
```

Удаляет все степени в `Table1` `Table2`таблицах и , время создания которых было более 10 дней назад:

```kusto
.drop extents older 10 days from tables (Table1, Table2)
```

Режим эмуляции: показывает, какие степени будут удалены командой (параметр идентификатора степени не применим для этой команды):

```kusto
.drop-pretend extents older 10 days from all tables
```

Удаляет все степени из 'TestTable':

```kusto
.drop extents from TestTable
```
 
**Выход возврата**

|Выходной параметр |Тип |Описание 
|---|---|---
|ExtentId |Строка |ExtentId, который был удален в результате команды 
|TableName |Строка |Название таблицы, где степень принадлежала  
|Созданныйна |Дата и время |Timestamp, который содержит информацию о том, когда степень была первоначально создана 
 
**Вывод примера** 

|Идентификатор размера |Имя таблицы |Создана 
|---|---|---
|43c6e03f-1713-4ca7-a52a-5db8a4e8b87d |TestTable |2015-01-12 12:48:49.4298178 

## <a name="replace-extents"></a>.replace объемы

**Синтаксис**

`.replace`Запрос`async` `table` *DestinationTableName* `<| 
{``},{` *query for extents to be dropped from table**query for extents to be moved to table* DestinationTableName для масштабов, которые будут удалены из запроса таблицы для масштабов, которые будут перемещены в таблицу `extents` `in``}`

Эта команда выполняется в контексте определенной базы данных, перемещает указанные степени из исходных таблиц в таблицу назначения и удаляет указанные степени из таблицы назначения.
Все операции по падению и перемещению выполняются в одной транзакции.

Требуется [разрешение админовата таблицтаблицы](../management/access-control/role-based-authorization.md) для исходного и назначения.

* `async`(по желанию) указывается, выполняется ли команда асинхронно (в этом случае идентификатор операции (Guid) возвращается, и состояние операции можно контролировать с помощью команды [операций .show).](operations.md#show-operations)
    * В случае использования этой опции результаты успешного выполнения могут быть получены в команде ["Детали операции .show".](operations.md#show-operation-details)

Определение того, какие степени должны быть удалены или перемещены, выполняется путем предоставления 2 запросов
- *запрос для удалений степени из таблицы* - результаты этого запроса указывают степень идонов  
которые должны быть удалены из таблицы назначения.
- *запрос для перемещения степени в таблицу* - результаты этого запроса указывают степень идонов в исходной таблице (ы), которые должны быть перемещены в таблицу назначения.

Оба запроса должны вернуть набор записей с столбцей под названием "ExtentId".

**Ограничения**
- Таблицы исходного кода и назначения должны находиться в базе данных контекста. 
- Ожидается, что все степени, указанные *запросом для удалений размеров из таблицы,* будут принадлежать таблице назначения.
- Ожидается, что все столбцы в исходных таблицах будут существовать в таблице назначения с тем же именем и типом данных.

**Выход возврата** (для выполнения синхронизации)

Выходной параметр |Тип |Описание 
---|---|---
OriginalExtentId |строка |Уникальный идентификатор (GUID) для исходной степени в исходной таблице, которая была перемещена в таблицу назначения, или - степень в таблице назначения, которая была удалена.
ResultExtentId |строка |Уникальный идентификатор (GUID) для степени результата, который был перемещен из исходной таблицы в таблицу назначения, или - пустой, в случае, если степень была удалена из таблицы назначения. При сбое - "Не удалось".
Сведения |строка |Включает сведения о сбое в случае сбоя операции.

**Примеры**

Перемещает все степени от 2`MyTable1` `MyTable2`конкретных `MyOtherTable`таблиц (, ) `MyOtherTable` к таблице, и падает все степени в помечены с: `drop-by:MyTag`

```kusto
.replace extents in table MyOtherTable <|
    {.show table MyOtherTable extents where tags has 'drop-by:MyTag'},
    {.show tables (MyTable1,MyTable2) extents}
```

**Вывод примера** 

|OriginalExtentId |ResultExtentId |Сведения
|---|---|---
|e133f050-a1e2-4dad-8552-1f5cf47cab69 |0d96ab2d-9dd2-4d2c-a45e-b24c65aa6687| 
|cdbeb35b-87ea-499f-b545-defbae091b57 |a90a303c-8a14-4207-8f35-d8ea94ca45be| 
|4fcb4598-9a31-4614-903c-0c67c286da8c |97aafea1-59ff-4312-b06b-08f42187872f| 
|2dfdef64-62a3-4950-a130-96b5b1083b5a |0fb7f3da-5e28-4f09-a000-e62eb41592df| 

*ПРИМЕЧАНИЕ.* 
> [!NOTE]
> Команда выйдет из строя, если в таблице назначения не будут существовать степени, возвращенные *по степени, которую следует выбросить из* запроса таблицы. Это может произойти, если степени были объединены до выполнения команды замены. Чтобы убедиться, что команда не удается на отсутствующих уровней, убедитесь, что запрос возвращает ожидаемые ExtentIds. Пример #1 ниже, не удастся, если степень падения не существует в таблице MyOtherTable. Пример #2, однако, будет успешным, даже если степень падения не существует, так как запрос на падение не вернулся какой-либо степени идентификаторов. 

Пример #1: 

```kusto
.replace extents in table MyOtherTable <|
     { datatable(ExtentId:guid)[ "2cca5844-8f0d-454e-bdad-299e978be5df"] }, { .show table MyTable1 extents }
```

Пример #2:

```kusto
.replace extents in table MyOtherTable  <|
     { .show table MyOtherTable extents | where ExtentId == guid(2cca5844-8f0d-454e-bdad-299e978be5df) }, { .show table MyTable1 extents }
```



## <a name="drop-extent-tags"></a>теги степени .drop

**Синтаксис**

`.drop``extent` `tags` `from` ТаблицаИмя `table` *TableName* `,`*Tag2*`,`*Tag1*' Tag1 '' Tag2 ' ...`async` `(` `,`'*TagN*')`)`

`.drop``async` `extent` Запрос `tags`  <|  *query*

* `async`(по желанию) указывается, выполняется ли команда асинхронно (в этом случае идентификатор операции (Guid) возвращается, и состояние операции можно контролировать с помощью команды [операций .show).](operations.md#show-operations)
    * В случае использования этой опции результаты успешного выполнения могут быть получены в команде ["Детали операции .show".](operations.md#show-operation-details)

Команда выполняется в контексте конкретной базы данных и отбрасывает [приведенный тег (ы)](extents-overview.md#extent-tagging) из любой степени в предоставленной базе данных и таблице, которая включает в себя любой из тегов.  

Существует два способа указать, какие теги следует удалить из каких уровней:

1. Явно указывая теги, которые должны быть удалены из всех уровней в указанной таблице.
2. Предоставляя запрос, результаты которого указывают степень идентиповвого просрочка в таблице и степень foreach - теги, которые должны быть удалены.

**Ограничения**
- Все степени должны находиться в базе данных контекста и принадлежать к одной и той же таблице. 

**Определение масштабов с помощью запроса**

Требуется [разрешение админовата таблицы таблицы](../management/access-control/role-based-authorization.md) таблиц таблицтаблицы таблиц таблицтаблицы таблицтаблицы таблицтаблицы таблицтаблицы таблицтаблицы таблицы таблицы таблицы таблицы таблицы таблицы таблицы

```kusto 
.drop extent tags <| ...query... 
```

Степени и теги для отпадения указаны с помощью запроса Kusto, который возвращает набор записей с столбцей под названием "ExtentId" и столбецом под названием "Теги". 

*ПРИМЕЧАНИЕ*: При использовании [клиентской библиотеки Kusto .NET](../api/netfx/about-kusto-data.md)вы можете использовать следующие методы для создания желаемой команды:
- `CslCommandGenerator.GenerateExtentTagsDropByRegexCommand(string tableName, string regex)`
- `CslCommandGenerator.GenerateExtentTagsDropBySubstringCommand(string tableName, string substring)`

**Выход возврата**

Выходной параметр |Тип |Описание 
---|---|---
OriginalExtentId |строка |Уникальный идентификатор (GUID) для исходной степени, чьи теги были изменены (и отброшены в рамках операции) 
ResultExtentId |строка |Уникальный идентификатор (GUID) для степени результата, который изменил теги (и создается и добавляется в рамках операции). При сбое - "Не удалось".
ResultExtentTags |строка |Сбор тегов, с которыми отмечен размер результата (если он такинет), или "нулевой" в случае сбоя операции.
Сведения |строка |Включает сведения о сбое в случае сбоя операции.

**Примеры**

Сбрасывает `drop-by:Partition000` тег из любой степени в таблице, `MyOtherTable` которая помечена с ним.

```kusto
.drop extent tags from table MyOtherTable ('drop-by:Partition000')
```

Капли теги `drop-by:20160810104500` `a random tag`, и `drop-by:20160810` / или из `My Table` любой степени в таблице, которая помечена с любой из них.

```kusto
.drop extent tags from table [My Table] ('drop-by:20160810104500','a random tag','drop-by:20160810')
```

Капли `drop-by` все теги из `MyTable`степени в таблице .

```kusto
.drop extent tags <| 
  .show table MyTable extents 
  | where isnotempty(Tags)
  | extend Tags = split(Tags, '\r\n') 
  | mv-expand Tags to typeof(string)
  | where Tags startswith 'drop-by'
```

Капли все теги `drop-by:StreamCreationTime_20160915(\d{6})` соответствия regex `MyTable`от степени в таблице .

```kusto
.drop extent tags <| 
  .show table MyTable extents 
  | where isnotempty(Tags)
  | extend Tags = split(Tags, '\r\n')
  | mv-expand Tags to typeof(string)
  | where Tags matches regex @"drop-by:StreamCreationTime_20160915(\d{6})"
```

**Вывод примера** 

|OriginalExtentId |ResultExtentId | ResultExtentTags | Сведения
|---|---|---|---
|e133f050-a1e2-4dad-8552-1f5cf47cab69 |0d96ab2d-9dd2-4d2c-a45e-b24c65aa6687 | Раздел001 |
|cdbeb35b-87ea-499f-b545-defbae091b57 |a90a303c-8a14-4207-8f35-d8ea94ca45be | |
|4fcb4598-9a31-4614-903c-0c67c286da8c |97aafea1-59ff-4312-b06b-08f42187872f | Раздел001 Раздел002 |
|2dfdef64-62a3-4950-a130-96b5b1083b5a |0fb7f3da-5e28-4f09-a000-e62eb41592df | |

## <a name="alter-extent-tags"></a>теги степени .alter

**Синтаксис**

`.alter``async`Tag1 `extent` `tags` *Tag1*`,`*Tag2*`,`'Tag2 'Tag2 '... `(` `,`Запрос*TagN*`)` <| *query*

Команда выполняется в контексте определенной базы данных и изменяет [тег имасштаба (ы)](extents-overview.md#extent-tagging) всех объемов, возвращенных указанным запросом, в указанный набор тегов.

Степени и теги для изменения указаны с помощью запроса Kusto, который возвращает набор записей с столбцей под названием "ExtentId".

* `async`(по желанию) указывается, выполняется ли команда асинхронно (в этом случае идентификатор операции (Guid) возвращается, и состояние операции можно контролировать с помощью команды [операций .show).](operations.md#show-operations)
    * В случае использования этой опции результаты успешного выполнения могут быть получены в команде ["Детали операции .show".](operations.md#show-operation-details)

Требуется [разрешение админовата таблицы](../management/access-control/role-based-authorization.md) для всех участвующих таблиц.

**Ограничения**
- Все степени должны находиться в базе данных контекста и принадлежать к одной и той же таблице. 

**Выход возврата**

Выходной параметр |Тип |Описание 
---|---|---
OriginalExtentId |строка |Уникальный идентификатор (GUID) для исходной степени, чьи теги были изменены (и отброшены в рамках операции) 
ResultExtentId |строка |Уникальный идентификатор (GUID) для степени результата, который изменил теги (и создается и добавляется в рамках операции). При сбое - "Не удалось".
ResultExtentTags |строка |Сбор тегов, с которыми отмечен размер результата, или "нулевой" в случае сбоя операции.
Сведения |строка |Включает сведения о сбое в случае сбоя операции.

**Примеры**

Изменяет теги всех размеров `MyTable` в `MyTag`таблице.

```kusto
.alter extent tags ('MyTag') <| .show table MyTable extents
```

Изменяет теги всех размеров `MyTable`в таблице, `drop-by:MyTag` `drop-by:MyNewTag` помечены с и `MyOtherNewTag`.

```kusto
.alter extent tags ('drop-by:MyNewTag','MyOtherNewTag') <| .show table MyTable extents where tags has 'drop-by:MyTag'
```

**Вывод примера** 

|OriginalExtentId |ResultExtentId | ResultExtentTags | Сведения
|---|---|---|---
|e133f050-a1e2-4dad-8552-1f5cf47cab69 |0d96ab2d-9dd2-4d2c-a45e-b24c65aa6687 | drop-by:MyNewTag MyOtherNewTag| 
|cdbeb35b-87ea-499f-b545-defbae091b57 |a90a303c-8a14-4207-8f35-d8ea94ca45be | drop-by:MyNewTag MyOtherNewTag| 
|4fcb4598-9a31-4614-903c-0c67c286da8c |97aafea1-59ff-4312-b06b-08f42187872f | drop-by:MyNewTag MyOtherNewTag| 
|2dfdef64-62a3-4950-a130-96b5b1083b5a |0fb7f3da-5e28-4f09-a000-e62eb41592df | drop-by:MyNewTag MyOtherNewTag| 

