---
title: Прием данных в Azure Data Explorer | Документация Майкрософт
description: В этой статье описывается процесс приема данных в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 03/30/2020
ms.openlocfilehash: f0fb68395ec5ed647e1f28cc1c93d46083d405c6
ms.sourcegitcommit: bb8c61dea193fbbf9ffe37dd200fa36e428aff8c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/13/2020
ms.locfileid: "83373450"
---
# <a name="data-ingestion"></a>Прием данных

Процесс добавления данных в таблицу и предоставления доступа к ним для запросов.
В зависимости от того, существует ли нужная таблица, для этого процесса требуются [права администратора базы данных, принимающего базы данных, пользователя базы данных или администратора таблиц](../access-control/role-based-authorization.md).

Процесс приема данных состоит из нескольких этапов:

1. Получение данных из источника данных.
1. Анализ и проверка этих данных.
1. Сопоставление схемы данных со схемой целевой таблицы Kusto или создание отсутствующей целевой таблицы.
1. Упорядочение данных по столбцам.
1. Индексирование данных.
1. Кодирование и сжатие данных.
1. Сохранение полученных артефактов хранилища Kusto в хранилище.
1. Применение всех соответствующих политик обновления, если они есть.
1. "Фиксация" приема данных, после которой данные становятся доступными для запросов.

> [!NOTE]
> В определенных сценариях некоторые из описанных выше действий могут быть пропущены.
> Например, при получении данных через конечную точку потокового приема не применяются шаги 4, 5, 6 и 9, так как они выполняются в фоновом режиме по мере очистки данных.
> Другой пример: если источник данных является результатом запроса Kusto к тому же кластеру, анализировать и проверять данные не нужно.

> [!WARNING]
> К принятым в таблицу Kusto данным применяется действующая для таблицы **политика хранения**.
> Если политика хранения не задана для таблицы явным образом, она создается на основе политики хранения базы данных. Таким образом, когда вы принимаете данные в Kusto, убедитесь, что политика хранения базы данных соответствует вашим потребностям. В противном случае явно переопределите ее на уровне таблицы. Несоблюдение этого требования может привести к удалению данных без предупреждения. Дополнительные сведения см. в статье о [политике хранения](https://kusto.azurewebsites.net/docs/concepts/retentionpolicy.html).

См. сведения о [свойствах приема данных](../../../ingestion-properties.md).
См. список поддерживаемых [форматов для приема данных](../../../ingestion-supported-formats.md).



## <a name="ingestion-methods"></a>Методы приема

Для приема данных существует ряд методов, каждый из которых имеет особые характеристики:

1. **Встроенный (принудительный) прием**. В подсистему приема передается команда управления ([.ingest inline](./ingest-inline.md)), в текст которой сразу включаются данные для приема.
   Этот метод в основном используется для быстрой проверки или тестирования, и его не следует применять в рабочих системах.
1. **Прием из запроса**. В подсистему приема отправляется команда управления ([.set, .append, .set-or-append или .set-or-replace](./ingest-from-query.md)), которая опосредованно определяет данные по результатам этого запроса или команды.
   Этот метод полезен для создания таблиц отчетов из таблиц необработанных данных или для создания небольших временных таблиц для дополнительного анализа.
1. **Прием из хранилища (вытягивание)** . В модуль приема отправляется команда управления ([.ingest into](./ingest-from-storage.md)), а данные хранятся во внешнем хранилище (например, хранилище BLOB-объектов Azure), которое доступно для этого модуля и на которое указывает эта команда.
   Этот метод позволяет эффективно принимать большие объемы данных, но перекладывает часть нагрузки на клиент, который выполняет прием, чтобы не перегружать кластер выполнением большого числа одновременных операций приема и не создавать риск исчерпания ресурсов кластера с последующим снижением производительности запросов.
1. **Прием с постановкой в очередь**. Данные отправляются во внешнее хранилище (например, хранилище BLOB-объектов Azure). Уведомление отправляется в очередь (например, в концентратор событий или очередь Azure).
   Это основной метод для рабочих сред, так как он обеспечивает очень высокий уровень доступности, не возлагает на клиента управление производительностью и хорошо подходит для операций добавления больших объемов данных. Иногда его называют естественным приемом.


|Метод             |Задержка                 |Производство|Массовость|Доступность|Синхронность|
|-------------------|------------------------|----------|----|------------|-------------|
|Встроенный прием   |Секунды + время приема   |нет        |нет  |Подсистема Kusto|Синхронная  |
|Прием из запроса  |Время запроса + время приема|Да       |Да |Подсистема Kusto|Синхронная  |
|Прием из хранилища|Секунды + время приема   |Да       |Да |Подсистема Kusto|both         |
|Прием с постановкой в очередь   |Минуты                 |Да       |Да |Память     |Асинхронная |

## <a name="validation-policy-during-ingestion"></a>Политика проверки во время приема

Принимаемые из хранилища исходные данные проверяются в ходе синтаксического анализа.
Политика проверки определяет, как нужно реагировать на ошибки в синтаксическом анализе. Она состоит из двух свойств:

* `ValidationOptions`: `0` здесь означает, что проверку выполнять не нужно, `1` проверяет, что все записи имеют одинаковое число полей (удобно для CSV-файлов и аналогичных форматов), а `2` игнорирует поля, которые не заключены в двойные кавычки.

* `ValidationImplications`: `0` указывает, что ошибки проверки приводят к сбою всей операции приема, а `1` указывает, что ошибки проверки следует игнорировать.