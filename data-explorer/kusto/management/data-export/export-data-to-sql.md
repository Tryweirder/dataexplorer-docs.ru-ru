---
title: Экспорт данных в SQL Azure обозреватель данных | Документация Майкрософт
description: В этой статье описывается экспорт данных в SQL в Azure обозреватель данных.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/13/2020
ms.openlocfilehash: 61c65e2667356f2b2ee9e53c3dd1c210e84c72f8
ms.sourcegitcommit: 898f67b83ae8cf55e93ce172a6fd3473b7c1c094
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/21/2020
ms.locfileid: "92342813"
---
# <a name="export-data-to-sql"></a>Экспорт данных в SQL

Экспорт данных в SQL позволяет выполнять запрос и отправлять результаты в таблицу в базе данных SQL, например в базу данных SQL, размещенную в службе базы данных SQL Azure.

**Синтаксис**

`.export`[ `async` ] `to` `sql` *Склтабленаме* *склконнектионстринг* [ `with` `(` *PropertyName* `=` *propertyvalue* `,` ... `)` ] `<|` *Запрос*

Где:
* *асинхронно*: команда выполняется в асинхронном режиме (необязательно).
* *Склтабленаме* Имя таблицы базы данных SQL, в которую вставляются данные.
  Для защиты от атак путем внедрения это имя ограничено.
* *Склконнектионстринг* — это `string` литерал, который следует за `ADO.NET` форматом строки подключения и описывает конечную точку и базу данных SQL, к которой выполняется подключение. По соображениям безопасности строка подключения ограничена.
* *PropertyName*, *propertyvalue* — это пары имени (идентификатора) и значения (строкового литерала).

Свойства:

|Имя               |Значения           |Описание|
|-------------------|-----------------|-----------|
|`firetriggers`     |`true` или `false`|`true`Значение указывает, что целевая система должна срабатывать триггеры INSERT, определенные в таблице SQL. Значение по умолчанию: `false`. (Дополнительные сведения см. в разделе [BULK INSERT](/sql/t-sql/statements/bulk-insert-transact-sql) и [System. Data. SqlClient. SqlBulkCopy](/dotnet/api/system.data.sqlclient.sqlbulkcopy)).|
|`createifnotexists`|`true` или `false`|Если `true` значение равно, то Целевая таблица SQL будет создана, если она еще не существует; в `primarykey` этом случае необходимо указать свойство, чтобы указать столбец результатов, являющийся первичным ключом. Значение по умолчанию: `false`.|
|`primarykey`       |                 |Если `createifnotexists` имеет значение `true` , то указывает имя столбца в результатах, который будет использоваться в качестве первичного ключа таблицы SQL, если он создан с помощью этой команды.|
|`persistDetails`   |`bool`           |Указывает, что команда должна сохранять свои результаты (см `async` . флаг). По умолчанию используется `true` в асинхронных запусках, но может быть отключено, если вызывающий объект не требует результатов. Значение по умолчанию `false` — в синхронных выполнениях, но может быть включено. |
|`token`            |`string`         |Маркер доступа AAD, который Kusto будет пересылать в конечную точку SQL для проверки подлинности. Если задано значение, строка подключения SQL не должна включать такие сведения проверки подлинности `Authentication` , как, `User ID` или `Password` .|

## <a name="limitations-and-restrictions"></a>ограничения

Существует ряд ограничений и ограничений при экспорте данных в базу данных SQL.

1. Kusto — это облачная служба, поэтому строка подключения должна указывать на базу данных, доступную из облака. (В частности, один из них не может экспортировать в локальную базу данных, так как он недоступен из общедоступного облака.)

2. Kusto поддерживает Active Directory встроенную проверку подлинности, когда вызывающий участник является участником Azure Active Directory ( `aaduser=` или `aadapp=` ).
   Кроме того, Kusto также поддерживает указание учетных данных для базы данных SQL в составе строки подключения. Другие методы проверки подлинности не поддерживаются. Идентификатор, представляемый базе данных SQL, всегда основывается из команды вызывающей стороны, а не самого удостоверения службы Kusto.

3. Если целевая таблица в базе данных SQL существует, она должна соответствовать схеме результатов запроса. Обратите внимание, что в некоторых случаях (например, в базе данных SQL Azure) это означает, что таблица содержит один столбец, помеченный как столбец идентификаторов.

4. Экспорт больших объемов данных может занять длительное время. Рекомендуется настроить целевую таблицу SQL для минимального ведения журнала во время массового импорта.
   См. раздел [SQL Server ядро СУБД >... > Database features > групповой импорт и экспорт данных](/sql/relational-databases/import-export/prerequisites-for-minimal-logging-in-bulk-import).

5. Экспорт данных выполняется с помощью SQL с массовым копированием и не предоставляет гарантий транзакций в целевой базе данных SQL. Дополнительные сведения см. в разделе [операции транзакций и операций с массовым копированием](/dotnet/framework/data/adonet/sql/transaction-and-bulk-copy-operations) .

6. Имя таблицы SQL ограничено именем, состоящим из букв, цифр, пробелов, символов подчеркивания ( `_` ), точек ( `.` ) и дефисов ( `-` ).

7. Строка подключения SQL ограничена следующим образом: `Persist Security Info` явно задано значение `false` , `Encrypt` имеет значение `true` , а параметр `Trust Server Certificate` имеет значение `false` .

8. Свойство первичного ключа в столбце можно указать при создании новой таблицы SQL. Если столбец имеет тип `string` , то SQL может отказаться от создания таблицы из-за других ограничений первичного ключевого столбца. Чтобы обойти эту проблему, необходимо вручную создать таблицу в SQL перед экспортом данных. Причина этого ограничения заключается в том, что столбцы первичного ключа в SQL не могут иметь неограниченный размер, но столбцы Kusto таблицы не имеют ограничений по размеру.

## <a name="azure-db-aad-integrated-authentication-documentation"></a>Документация по интегрированной проверке подлинности AAD в Azure DB

* [Использование проверки подлинности Azure Active Directory для проверки подлинности с помощью базы данных SQL](/azure/sql-database/sql-database-aad-authentication)
* [Модули проверки подлинности Azure AD для базы данных SQL Azure и средства SQL DW] (https://azure.microsoft.com/blog/azure-ad-authentication-extensions-for-azure-sql-db-and-sql-dw-tools/)

**Примеры** 

В этом примере Kusto выполняет запрос, а затем экспортирует первый набор записей, созданный запросом, в `MySqlTable` таблицу в `MyDatabase` базе данных на сервере `myserver` .

```kusto 
.export async to sql MySqlTable
    h@"Server=tcp:myserver.database.windows.net,1433;Database=MyDatabase;Authentication=Active Directory Integrated;Connection Timeout=30;"
    <| print Id="d3b68d12-cbd3-428b-807f-2c740f561989", Name="YSO4", DateOfBirth=datetime(2017-10-15)
```

В этом примере Kusto выполняет запрос, а затем экспортирует первый набор записей, созданный запросом, в `MySqlTable` таблицу в `MyDatabase` базе данных на сервере `myserver` .
Если целевая таблица не существует в целевой базе данных, она будет создана.

```kusto 
.export async to sql ['dbo.MySqlTable']
    h@"Server=tcp:myserver.database.windows.net,1433;Database=MyDatabase;Authentication=Active Directory Integrated;Connection Timeout=30;"
    with (createifnotexists="true", primarykey="Id")
    <| print Message = "Hello World!", Timestamp = now(), Id=12345678
```