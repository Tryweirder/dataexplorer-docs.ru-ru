---
title: DCount () (агрегатная функция) — обозреватель данных Azure
description: В этой статье описывается DCount () (агрегатная функция) в обозреватель данных Azure.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/13/2020
ms.openlocfilehash: 45ab913fdc659444ac578ca725e2afb24256a38b
ms.sourcegitcommit: 3dfaaa5567f8a5598702d52e4aa787d4249824d4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2020
ms.locfileid: "87803715"
---
# <a name="dcount-aggregation-function"></a>DCount () (агрегатная функция)

Возвращает оценку количества различающихся значений, полученных скалярным выражением в группе сводки.

> [!NOTE]
> `dcount()`Статистическая функция в первую очередь полезна для оценки количества элементов огромных наборов. Она меняет производительность для точности и может возвращать результат, который меняется между выполнениями. Порядок входных данных может влиять на выходные данные.

## <a name="syntax"></a>Синтаксис

... `|` `summarize` `dcount` `(`*`Expr`*[, *`Accuracy`*]`)` ...

## <a name="arguments"></a>Аргументы

* *Expr*: скалярное выражение, различные значения которого должны быть учтены.
* *Точность*. необязательный `int` литерал, определяющий требуемую точность оценки. Поддерживаемые значения приведены ниже. Если не указано, используется значение по умолчанию `1` .

## <a name="returns"></a>Возвращаемое значение

Возвращает оценку количества различных значений *`Expr`* в группе.

## <a name="example"></a>Пример

```kusto
PageViewLog | summarize countries=dcount(country) by continent
```

:::image type="content" source="images/dcount-aggfunction/dcount.png" alt-text="Число D":::

Получение точного числа уникальных значений `V` , сгруппированных по `G` .

```kusto
T | summarize by V, G | summarize count() by G
```

Для этого вычисления требуется большой объем внутренней памяти, так как отдельные значения `V` умножаются на количество различных значений `G` .
Это может привести к ошибкам памяти или большому времени выполнения. 
`dcount()`предоставляет быстрый и надежный вариант:

```kusto
T | summarize dcount(B) by G | count
```

## <a name="estimation-accuracy"></a>Точность оценки

`dcount()`Агрегатная функция использует вариант [алгоритма ХИПЕРЛОГЛОГ (ХЛЛ)](https://en.wikipedia.org/wiki/HyperLogLog), который выполняет оценку метод стохастического для задания количества элементов. Алгоритм предоставляет "ручка", которую можно использовать для балансировки точности и времени выполнения для каждого размера памяти:

|Точность|Ошибка (%)|Число записей   |
|--------|---------|--------------|
|       0|      1.6|2<sup>12</sup>|
|       1|      0,8|2<sup>14</sup>|
|       2|      0,4|2<sup>16</sup>|
|       3|     0,28|2<sup>17</sup>|
|       4|      0,2|2<sup>18</sup>|

> [!NOTE]
> Столбец "число записей" — это число счетчиков типа 1 байт в реализации ХЛЛ.

Алгоритм включает некоторые подзадачи для выполнения идеального числа (нулевой ошибки), если количество заданных элементов достаточно мало:
* Если уровень точности равен `1` , возвращаются значения 1000.
* Если уровень точности равен `2` , возвращаются значения 8000.

Привязка ошибки — вероятностная, а не теоретическая граница. Значение является стандартным отклонением распределения ошибок (сигма) и 99,7% оценок будет иметь относительную ошибку в 3 x сигм.

На следующем рисунке показана функция распределения вероятности для ошибки относительной оценки (в процентах) для всех поддерживаемых параметров точности:

:::image type="content" border="false" source="images/dcount-aggfunction/hll-error-distribution.png" alt-text="распределение ошибок ХЛЛ":::
