---
title: dcount() (статистическая функция) в Azure Data Explorer
description: В этой статье описывается функция dcount() (статистическая функция) в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: alexans
ms.service: data-explorer
ms.topic: reference
ms.date: 02/13/2020
ms.localizationpriority: high
ms.openlocfilehash: 947ab0af6a5aaa98bb07b08005b940fdf2ce6ae5
ms.sourcegitcommit: f49e581d9156e57459bc69c94838d886c166449e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/01/2020
ms.locfileid: "95513188"
---
# <a name="dcount-aggregation-function"></a>dcount() (статистическая функция)

Возвращает оценку количества несовпадающих значений, полученных скалярным выражением в группе сводки.

> [!NOTE]
> Статистическая функция `dcount()` в основном полезна для оценки кратности огромных наборов. Она не очень производительная, однако точная и может возвращать результат, который отличается между выполнениями. Порядок входных данных может влиять на выходные данные.

## <a name="syntax"></a>Синтаксис

... `|` `summarize` `dcount` `(`*`Expr`*[, *`Accuracy`*]`)` ...

## <a name="arguments"></a>Аргументы

* *Expr*. Скалярное выражение, несовпадающие значения которого необходимо учитывать.
* *Точность*. Необязательный литерал `int`, определяющий точность запрошенной оценки. Поддерживаемые значения приведены ниже. Если не задано, по умолчанию используется значение `1`.

## <a name="returns"></a>Возвращаемое значение

Возвращает приблизительное количество несовпадающих значений *`Expr`* для группы.

## <a name="example"></a>Пример

```kusto
PageViewLog | summarize countries=dcount(country) by continent
```

:::image type="content" source="images/dcount-aggfunction/dcount.png" alt-text="Экран &quot;Подсчет по D&quot;":::

Получение точного числа несовпадающих значений `V`, сгруппированных по `G`.

```kusto
T | summarize by V, G | summarize count() by G
```

Для этого вычисления требуется большой объем внутренней памяти, поскольку несовпадающие значения `V` умножаются на количество несовпадающих значений `G`.
Это может привести к ошибкам памяти или долгому времени выполнения. 
Более быстрой и надежной альтернативой является `dcount()`:

```kusto
T | summarize dcount(B) by G | count
```

## <a name="estimation-accuracy"></a>Точность оценки

Агрегатная функция `dcount()` использует вариант [алгоритма HyperLogLog (HLL)](https://en.wikipedia.org/wiki/HyperLogLog), который выполняет стохастическое оценивание кратности наборов. Алгоритм предоставляет "рычаг управления", который можно использовать для выравнивания точности и времени выполнения под размер памяти:

|Точность|Ошибка (%)|Число записей   |
|--------|---------|--------------|
|       0|      1.6|2<sup>12</sup>|
|       1|      0,8|2<sup>14</sup>|
|       2|      0,4|2<sup>16</sup>|
|       3|     0,28|2<sup>17</sup>|
|       4|      0.2|2<sup>18</sup>|

> [!NOTE]
> Столбец "число записей" — это количество 1-байтных счетчиков в реализации HLL.

Алгоритм включает в себя некоторые положения для выполнения идеального подсчета (нулевой ошибки), если кратность набора достаточно мала:
* если уровень точности равен `1`, возвращаются значения 1000;
* если уровень точности равен `2`, возвращаются значения 8000.

Границы погрешности — вероятностная, а не теоретическая граница. Значение является стандартным отклонением распределения погрешностей (сигма). 99,7 % оценок будут иметь относительную погрешность в 3 сигмы.

На следующем изображении показана функция распределения вероятности относительной погрешности оценки (в процентах) для всех поддерживаемых параметров точности:

:::image type="content" border="false" source="images/dcount-aggfunction/hll-error-distribution.png" alt-text="распределение погрешностей hll":::
