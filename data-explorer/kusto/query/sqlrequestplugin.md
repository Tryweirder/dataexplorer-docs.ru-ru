---
title: sql_request плагин - Azure Data Explorer (ru) Документы Майкрософт
description: В этой статье описывается sql_request плагин в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/24/2020
zone_pivot_group_filename: data-explorer/zone-pivot-groups.json
zone_pivot_groups: kql-flavors
ms.openlocfilehash: f0c0837c6bb8e4dcd3cf2e28af18d02c19edb676
ms.sourcegitcommit: 01eb9aaf1df2ebd5002eb7ea7367a9ef85dc4f5d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81766174"
---
# <a name="sql_request-plugin"></a>модуль sql_request.

::: zone pivot="azuredataexplorer"

  `evaluate``sql_request` *Options*`,` *ConnectionString* `,` `,` *SqlParameters* СоединениеСт-Кзл-Кукери (Sl-Параметры) *SqlQuery* `(``)`

Плагин `sql_request` отправляет запрос на s-L в конечную точку сети S'L Server и возвращает первый набор строк в результатах.

**Аргументы**

* *ConnectionString*: `string` Буквальное указание строки соединения, которая указывает на конечную точку сети S'L Server. Ниже приведены допустимые методы проверки подлинности и как указать конечную точку сети.

* *Sql-Кери* `string` : Буквальное указание запроса, который должен быть выполнен в отношении конечной точки S'L. Должен вернуть один или несколько рядов, но только первый из них доступен для остальной части запроса Kusto.

* *Параметры Sql*: Постоянное `dynamic` значение типа, которое содержит пары ключей, чтобы пройти в качестве параметров вместе с запросом. Необязательный параметр.
  
* *Параметры*: Постоянное `dynamic` значение типа, которое содержит более продвинутые настройки в качестве пар с ключевым значением. В `token` настоящее время можно только установить, чтобы передать абонента, предоставляемых AAD токен доступа, который направляется в конечную точку S'L для проверки подлинности. Необязательный параметр.

**Примеры**

В следующем примере запрос s'L отправляется в базу данных Azure S'L DB, извлекая все записи из, `[dbo].[Table]`а затем обрабатывает результаты на стороне Kusto. Аутентификация повторно использует токен AAD вызываемого пользователя.

Примечание: Этот пример не следует воспринимать как рекомендацию для фильтрации/проекта данных таким образом. Обычно предпочтительнее, чтобы запросы были построены для возврата наименьшего набора данных, так как в настоящее время оптимизатор Kusto не пытается оптимизировать запросы между Kusto и S'L.

```kusto
evaluate sql_request(
  'Server=tcp:contoso.database.windows.net,1433;'
    'Authentication="Active Directory Integrated";'
    'Initial Catalog=Fabrikam;',
  'select * from [dbo].[Table]')
| where Id > 0
| project Name
```

Следующий пример идентичен предыдущему, за исключением того, что проверка подлинности S'L выполняется по имени пользователя/паролю. Обратите внимание, что для конфиденциальности, мы используем запутанные строки здесь.

```kusto
evaluate sql_request(
  'Server=tcp:contoso.database.windows.net,1433;'
    'Initial Catalog=Fabrikam;'
    h'User ID=USERNAME;'
    h'Password=PASSWORD;',
  'select * from [dbo].[Table]')
| where Id > 0
| project Name
```

**Аутентификация**

Плагин sql_request поддерживает три способа аутентификации к конечной точке сервера S'L Server:

* **AAD интегрировала аутентификацию** (`Authentication="Active Directory Integrated"`): Это предпочтительный метод, при котором пользователь или приложение аутентифицирует через AAD к Кусто, и тот же маркер затем используется для доступа к конечной точке сети S'L Server.

* **Проверка подлинности имени пользователя/паролей** (`User ID=...; Password=...;`): Поддержка этого метода предоставляется, когда интегрированная аутентификация AAD не может быть выполнена. Избегайте этого метода, когда это возможно, как секретная информация передается через Kusto.

* **Токен доступа AAD** (`dynamic({'token': h"eyJ0..."})`): С помощью этого метода проверки подлинности токен доступа генерируется абонентом и направляется Kusto в конечную точку S'L. Строка соединения не должна включать `Authentication` `User ID`информацию `Password`аутентификации, как, или . Вместо этого токен доступа `token` передается `Options` как свойство в аргументе sql_request плагина.
     
> [!WARNING]
> Строки подключения и запросы, которые включают конфиденциальную информацию или информацию, которые должны быть защищены должны быть запутаны, так что они будут опущены из любого kusto отслеживания.
> Подробнее о [запутыванных строках читайте](scalar-data-types/string.md#obfuscated-string-literals) в материале .

**Шифрование и проверка сервера**

Следующие свойства подключения вынуждены при подключении к конечной точке сети S'L Server, по соображениям безопасности:

* `Encrypt`устанавливается `true` безоговорочно.
* `TrustServerCertificate`устанавливается `false` безоговорочно.

В результате сервер S'L должен быть настроен с действительным сервером SSL/TLS.

**Определение конечной точки сети**

Указание конечной точки сети S'L как части строки соединения является обязательным.
Правильный синтаксис:

`Server``=` *FQDN* `,` *Port*ФЗНн и Порт `tcp:`

Где:

* *ФЗДН* является полностью квалифицированным доменным именем конечной точки.

* *Порт* является портом TCP конечной точки. По умолчанию, `1433` предполагается.

> [!NOTE]
> Другие формы указания конечной точки сети не поддерживаются.
> Нельзя опустить, например, `tcp:` приставку, даже если это возможно при программном использовании клиентских библиотек S'L.



::: zone-end

::: zone pivot="azuremonitor"

Это не поддерживается в Azure Monitor

::: zone-end
