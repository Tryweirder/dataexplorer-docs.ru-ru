---
title: диффузоры плагин - Azure Data Explorer (ru) Документы Майкрософт
description: В этой статье описан плагин диффшаблонов в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/13/2020
ms.openlocfilehash: fc4d1c7441e02eeeb1d90e1f8c0f2a521e3793da
ms.sourcegitcommit: 47a002b7032a05ef67c4e5e12de7720062645e9e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/15/2020
ms.locfileid: "81516003"
---
# <a name="diffpatterns-plugin"></a>диффузоры плагин

```kusto
T | evaluate diffpatterns(splitColumn)
```
Сравнивает два набора данных одной и той же структуры и находит закономерности дискретных атрибутов (размеры), которые характеризуют различия между двумя наборами данных. Функция Diffpatterns предназначена для анализа сбоев (например, путем сравнения сбоев и успешных результатов за заданный период времени), но потенциально может найти различия между двумя наборами данных с одинаковой структурой. 

**Синтаксис**

`T | evaluate diffpatterns(`SplitColumn, SplitValueA, SplitValueB , WeightColumn, Порог, MaxDimensions, CustomWildcard, ..."`)` 

**Обязательные аргументы**

* SplitColumn - *column_name*

    Указывает алгоритму, как разбить запрос на наборы данных. Согласно указанным значениям для аргументов SplitValueA и SplitValueB (см. ниже) алгоритм разделяет запрос на два набора данных — A и B, а также анализирует различия между ними. Таким образом разделенный столбец должен содержать как минимум два различных значения.

* SplitValueA — *строка*

    Строковое представление одного из значений в указанном аргументе SplitColumn. Все строки, которые содержат это значение в своих аргументах SplitColumn, рассматриваются, как набор данных A.

* SplitValueB — *строка*

    Строковое представление одного из значений в указанном аргументе SplitColumn. Все строки, имеющие это значение в СплитКоломе, считаются набором данных "B".

    Пример: `T | extend splitColumn=iff(request_responseCode == 200, "Success" , "Failure") | evaluate diffpatterns(splitColumn, "Success","Failure") `

**Дополнительные аргументы**

Остальные аргументы необязательны, но они должны быть упорядочены, как показано ниже. Чтобы указать, что следует использовать значение по умолчанию, добавьте знак тильды в строку "~" (см. примеры ниже).

* WeightColumn — *column_name*

    Рассматривает каждую строку входных данных в соответствии с указанным весовым коэффициентом (по умолчанию весовой коэффициент каждой строки — 1). Аргумент должен быть именем числового столбца (например, int, long, real).
    Как правило, при использовании столбца с весовым коэффициентом следует учитывать выборку, группирование или агрегирование данных, внедренных в каждой строке.
    
    Пример: `T | extend splitColumn=iff(request_responseCode == 200, "Success" , "Failure") | evaluate diffpatterns(splitColumn, "Success","Failure", sample_Count) `

* Порог - 0,015 < *двойной* < 1 (по умолчанию: 0,05)

    Задает минимальную разницу для шаблонов (соотношение) между двумя наборами.

    Пример: `T | extend splitColumn = iff(request-responseCode == 200, "Success" , "Failure") | evaluate diffpatterns(splitColumn, "Success","Failure", "~", 0.04)`

* MaxDimensions - 0 < *int* (по умолчанию: неограниченный)

    Задает максимальное количество некоррелированных измерений на шаблон результата, обеспечивая сокращение времени выполнения запроса.

    Пример: `T | extend splitColumn = iff(request-responseCode == 200, "Success" , "Failure") | evaluate diffpatterns(splitColumn, "Success","Failure", "~", "~", 3)`

* CustomWildcard - *"любое значение за тип"*

    Задает подстановочный знак для определенного типа в таблице результатов, который укажет, что текущий шаблон не имеет ограничения по этому столбцу.
    По умолчанию имеет значение NULL, для строки по умолчанию указывается пустая строка. Если значение по умолчанию является жизнеспособным значением в данных, `*`следует использовать другое значение подстановочного знака (например).
    См. следующий пример.

    Пример: `T | extend splitColumn = iff(request-responseCode == 200, "Success" , "Failure") | evaluate diffpatterns(splitColumn, "Success","Failure", "~", "~", "~", int(-1), double(-1), long(0), datetime(1900-1-1))`

**Возвращает**

Diffpatterns возвращает набор шаблонов (как правило, небольшого размера), который содержит разные фрагменты данных в двух наборах (т. е. шаблон, охватывающий большое количество строк в первом наборе данных и малое количество строк во втором наборе). В результатах каждый шаблон соответствует строке.

Результат диффшаблонов возвращает следующие столбцы:

* SegmentId: идентификатор, присвоенный шаблону в текущем запросе (примечание: идентификаторы не гарантированы, чтобы быть одинаковыми при повторении запросов).

* CountA: количество строк, захваченных шаблоном в наборе A `where tostring(splitColumn) == SplitValueA`(Установить A является эквивалентом).

* CountB: количество строк, захваченных шаблоном в наборе B `where tostring(splitColumn) == SplitValueB`(Установить B является эквивалентом).

* ПроцентА: процент строк в наборе А, захваченный шаблоном (100.0 - CountA / count (SetA) ).

* ПроцентB: процент строк в наборе B, захваченный шаблоном ( 100.0 - CountB / count (SetB) ).

* PercentDiffAB: абсолютная разница в процентном соотношении между A и B ( ПроцентА - ПроцентБ ) является основным показателем значимости шаблонов в описании разницы между двумя наборами.

* Остальные столбцы: являются исходной схемой ввода и описывают шаблон, каждая строка (шаблон) возмущается пересечением значений столбцов, не подходящих к знакам (эквивалент `where col1==val1 and col2==val2 and ... colN=valN` для каждого значения не-подстановочного знака в строке).

Для каждого шаблона столбцы, не установленные в шаблоне (т.е. без ограничений на определенное значение), будут содержать значение подстановочного знака, которое по умолчанию является нулевым (см. раздел Аргументы ниже, как подстановочные карты могут быть изменены вручную).

* Примечание: шаблоны, как правило, не отличаются, они могут быть перекрывающимися и, как правило, не охватывают все исходные строки. Некоторые строки могут не охватываться ни одним из шаблонов.


**Советы**

Используйте [где](./whereoperator.md) и [проецируйте](./projectoperator.md) в трубу ввода, чтобы уменьшить данные до того, что вас интересует.

Если вы хотите узнать дополнительные сведения о конкретной строке, добавьте ее значения в фильтр `where` .

* Примечание: диффпаттерны направлены на поиск значительных закономерностей (которые захватывают части разницы данных между наборами) и не предназначены для различий по строке.

**Пример**

```kusto
StormEvents 
| where monthofyear(StartTime) == 5
| extend Damage = iff(DamageCrops + DamageProperty > 0 , 1 , 0)
| project State , EventType , Source , Damage, DamageCrops
| evaluate diffpatterns(Damage, "0", "1" )
```
|Идентификатор сегмента|Число A|Число B|Процент A|Процент B|PercentDiffAB|Состояние|EventType|Источник|DamageCrops|
|---|---|---|---|---|---|---|---|---|---|
|0|2278|93|49,8|7.1|42,7||Град||0|
|1|779|512|17,03|39,08|22,05||Шквалистый ветер|||
|2|1098|118|24,01|9,01|15|||Подготовленный корректировщик|0|
|3|136|158|2,97|12,06|9,09|||Газета||
|4|359|214|7,85|16,34|8,49||Внезапное наводнение|||
|5|50|122|1,09|9,31|8,22|Айова||||
|6|655|279|14,32|21,3|6,98|||Правоприменение||
|7|150|117|3,28|8,93|5,65||Наводнение|||
|8|362|176|7,91|13,44|5,52|||Специалист по управлению в чрезвычайных ситуациях||

