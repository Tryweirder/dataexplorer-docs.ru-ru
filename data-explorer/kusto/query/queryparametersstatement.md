---
title: Оператор объявления параметров запроса — Azure обозреватель данных
description: В этой статье описывается инструкция объявления параметров запроса в обозреватель данных Azure.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: alexans
ms.service: data-explorer
ms.topic: reference
ms.date: 02/13/2020
zone_pivot_group_filename: data-explorer/zone-pivot-groups.json
zone_pivot_groups: kql-flavors
ms.openlocfilehash: d9c5e3b41eef933477981945b22b3aceef958dd8
ms.sourcegitcommit: 608539af6ab511aa11d82c17b782641340fc8974
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/20/2020
ms.locfileid: "92251659"
---
# <a name="query-parameters-declaration-statement"></a>Оператор объявления параметров запроса

::: zone pivot="azuredataexplorer"

Запросы, отправляемые в Kusto, могут включать набор пар имен или значений. Пары называются *параметрами запроса*вместе с самим текстом запроса. Запрос может ссылаться на одно или несколько значений, указывая имена и типы в *операторе объявления параметров запроса*.

Параметры запроса имеют два основных применения:

* Как механизм защиты от атак путем внедрения.
* Как способ параметризовать запросы.

В частности, клиентские приложения, сочетающие предоставленные пользователем входные данные в запросах, которые затем отправляются в Kusto, должны использовать механизм для защиты от Kusto эквивалента атак [путем внедрения кода SQL](https://en.wikipedia.org/wiki/SQL_injection) .

## <a name="declaring-query-parameters"></a>Объявление параметров запроса

Для ссылки на параметры запроса, текст запроса или функции, которые он использует, сначала необходимо объявить, какой параметр запроса он использует. Для каждого параметра объявление предоставляет имя и скалярный тип. При необходимости параметр также может иметь значение по умолчанию. Значение по умолчанию используется, если запрос не предоставляет конкретного значения для параметра. Затем Kusto анализирует значение параметра запроса в соответствии с обычными правилами анализа для этого типа.

## <a name="syntax"></a>Синтаксис

`declare``query_parameters` `(` *Name1* `:` *тип1* [ `=` *DefaultValue1*] [ `,` ...]`);`

* *Name1*: имя параметра запроса, используемого в запросе.
* *Тип1*: соответствующий тип, например `string` или `datetime` .
  Значения, предоставленные пользователем, кодируются как строки, в Kusto будет применен соответствующий метод Parse к параметру запроса для получения строго типизированного значения.
* *DefaultValue1*: необязательное значение по умолчанию для параметра. Это значение должно быть литералом соответствующего скалярного типа.

> [!NOTE]
> Как и [определяемые пользователем функции](functions/user-defined-functions.md), параметры запроса типа `dynamic` не могут иметь значения по умолчанию.

## <a name="examples"></a>Примеры

```kusto
declare query_parameters(UserName:string, Password:string);
print n=UserName, p=hash(Password)
```

```kusto
declare query_parameters(percentage:long = 90);
T | where Likelihood > percentage
```

## <a name="specifying-query-parameters-in-a-client-application"></a>Указание параметров запроса в клиентском приложении

Имена и значения параметров запроса предоставляются приложением, которое `string` делает запрос. Имя не может повторяться.

Интерпретация значений выполняется в соответствии с оператором объявления параметров запроса. Каждое значение анализируется так, как будто оно было литералом в теле запроса. Анализ выполняется в соответствии с типом, заданным в операторе объявления параметров запроса.

### <a name="rest-api"></a>REST API

Параметры запроса предоставляются клиентскими приложениями через `properties` слот объекта JSON тела запроса во вложенном контейнере свойств с именем `Parameters` . Например, ниже приведен текст REST API вызове Kusto, который вычисляет возраст некоторого пользователя, предположительно, с помощью которого приложение запрашивает день рождения пользователя.

``` json
{
    "ns": null,
    "db": "myDB",
    "csl": "declare query_parameters(birthday:datetime); print strcat(\"Your age is: \", tostring(now() - birthday))",
    "properties": "{\"Options\":{},\"Parameters\":{\"birthday\":\"datetime(1970-05-11)\",\"courses\":\"dynamic(['Java', 'C++'])\"}}"
}
```

### <a name="kusto-net-sdk"></a>Пакет SDK для Kusto .NET

Чтобы указать имена и значения параметров запроса при использовании клиентской библиотеки Kusto .NET, одна из них создает новый экземпляр `ClientRequestProperties` объекта, а затем использует `HasParameter` `SetParameter` методы, и `ClearParameter` для управления параметрами запроса. Этот класс предоставляет ряд строго типизированных перегрузок для `SetParameter` ; внутренне они создают соответствующий литерал языка запросов и отправляют его в виде с `string` помощью REST API, как описано выше. Текст запроса должен по-прежнему [объявлять параметры запроса](#declaring-query-parameters).

### <a name="kustoexplorer"></a>Kusto.Explorer

Чтобы задать параметры запроса, отправляемые при выполнении запроса к службе, используйте значок "гаечного ключа" **параметров запроса** ( `ALT`  +  `P` ).

::: zone-end

::: zone pivot="azuremonitor"

Эта возможность не поддерживается в Azure Monitor

::: zone-end
