---
title: Заявление о объявлениях параметров запроса - Azure Data Explorer Документы Майкрософт
description: В этой статье описывается заявление о декларировании параметров запроса в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/13/2020
zone_pivot_group_filename: data-explorer/zone-pivot-groups.json
zone_pivot_groups: kql-flavors
ms.openlocfilehash: b7193ada6967882306d9a977b6c90af8b247036d
ms.sourcegitcommit: 01eb9aaf1df2ebd5002eb7ea7367a9ef85dc4f5d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81765493"
---
# <a name="query-parameters-declaration-statement"></a>Заявление о параметрах запроса

::: zone pivot="azuredataexplorer"

Запросы, отправленные Kusto, могут включать, в дополнение к самому тексту запроса, набор пар имен/значений, называемых **парами запроса.** Текст запроса может ссылаться на значения параметров одного или нескольких запросов, указав их имена и тип через **заявление о объявления параметров запроса.**

Параметры запроса имеют два основных применения:

1. В качестве защитного механизма от **инъекционных атак.**
2. В качестве способа параметризации запросов.

В частности, клиентские приложения, объединяющие предоставленные пользователями входные данные в запросах, которые затем отправляются в Kusto, должны использовать этот механизм для защиты от атак [кусто-инъекций.](https://en.wikipedia.org/wiki/SQL_injection)

## <a name="declaring-query-parameters"></a>Объявление параметров запроса

Чтобы иметь возможность ссылаться на параметры запроса, текст запроса (или функции, которые он использует) должен сначала объявить, какой параметр запроса он использует. Для каждого параметра в декларации приводится тип имени и масштабирования. В качестве опции параметр может также иметь значение по умолчанию, которое будет использоваться, если запрос не дает конкретного значения для параметра. Затем Kusto разбирает значение параметра запроса в соответствии с его обычными правилами разбора для этого типа.

**Синтаксис**

`declare``query_parameters` `:` `=` `,` *Type1* *Name1* *DefaultValue1*Name1 Type1 - DefaultValue1 `(``);`

* *Name1*: Имя параметра запроса, используемого в запросе.
* *Тип1*: Соответствующий тип `string`(например, и `datetime`т.д.) Значения, предоставляемые пользователем, закодированы как строки, к Kusto будет применен соответствующий метод разбора к параметру запроса, чтобы получить сильно набранное значение.
* *DefaultValue1*: Дополнительное значение по умолчанию для параметра. Это должно быть буквальное соответствующего типа скалара.

> [!NOTE]
> Как [и определенные пользователями функции,](functions/user-defined-functions.md)параметры запроса типа `dynamic` не могут иметь значения по умолчанию.

**Примеры**

```kusto
declare query_parameters(UserName:string, Password:string);
print n=UserName, p=hash(Password)
```

```kusto
declare query_parameters(percentage:long = 90);
T | where Likelihood > percentage
```

## <a name="specifying-query-parameters-in-a-client-application"></a>Определение параметров запроса в клиентском приложении

Имена и значения параметров запроса предоставляются в качестве `string` значений приложением, делающих запрос. Имя не может повториться.

Интерпретация значений осуществляется в соответствии с заявлением о объявления параметров запроса. Каждое значение разбирается так, как если бы оно было буквальным в теле запроса в соответствии с типом, указанным заявлением о параметрах запроса.

### <a name="rest-api"></a>REST API

Параметры запроса предоставляются клиентскими `properties` приложениями через слот объекта JSON тела запроса, в `Parameters`вложенном пакете свойств под названием . Например, вот тело вызова REST API в Kusto, который вычисляет возраст некоторых пользователей (предположительно, имея приложение попросить пользователя на его или ее день рождения):

``` json
{
    "ns": null,
    "db": "myDB",
    "csl": "declare query_parameters(birthday:datetime); print strcat(\"Your age is: \", tostring(now() - birthday))",
    "properties": "{\"Options\":{},\"Parameters\":{\"birthday\":\"datetime(1970-05-11)\",\"courses\":\"dynamic(['Java', 'C++'])\"}}"
}
```

### <a name="kusto-net-sdk"></a>Кусто .NET SDK

Чтобы предоставить имена и значения параметров запроса при использовании клиентской библиотеки Kusto .NET, создается новый экземпляр `ClientRequestProperties` объекта, а затем использует `HasParameter` `SetParameter`, и `ClearParameter` методы для управления параметрами запроса. Обратите внимание, что этот класс обеспечивает ряд сильно `SetParameter`набранных перегрузок для; внутренне они генерируют соответствующий буквальный язык запроса и `string` отправляют его в виде aREST API, как описано выше. Сам текст запроса должен по-прежнему [декларировать параграфы запроса.](#declaring-query-parameters)

### <a name="kustoexplorer"></a>Kusto.Explorer

Чтобы установить параметры запроса, отправленные при запросе в службу, используйте **значок параметров запроса** "ключ" ().`ALT` + `P`

::: zone-end

::: zone pivot="azuremonitor"

Это не поддерживается в Azure Monitor

::: zone-end
