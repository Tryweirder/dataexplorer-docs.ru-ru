---
title: Оператор mv-расширения - Azure Data Explorer Документы Майкрософт
description: В этой статье описывается оператор mv-expand в Azure Data Explorer.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/24/2019
ms.openlocfilehash: 01a4b56155d1c29727670b4e827cb7b9968ef7a9
ms.sourcegitcommit: 47a002b7032a05ef67c4e5e12de7720062645e9e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/15/2020
ms.locfileid: "81512297"
---
# <a name="mv-expand-operator"></a>Оператор mv-expand

Расширяет многоценный массив или пакет свойств.

`mv-expand`применяется на [dynamic](./scalar-data-types/dynamic.md)динамическо-набранном столбце так, чтобы каждое значение в коллекции получило отдельный ряд. Все остальные столбцы в развернутой строке дублируются. 

**Синтаксис**

*Т* `| mv-expand ` `bagexpansion=`.`bag` | `array`.`with_itemindex=`*IndexColumnName*. . . . . . . . . . *ColumnName* `,` *ColumnName* . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . -`limit` *Роулимит.*

*Т* `| mv-expand ` `bagexpansion=`. .*Name* `=`. *ArrayExpression* . . . . .*Name* . *ArrayExpression* .`to typeof(`*Typename*`)`.`bag` | `array``to typeof(`*Typename*`)` `=`. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . -`limit` *Роулимит.*

**Аргументы**

* *ColumnName* — в выходных данных массивы из этого столбца будут развернуты в несколько строк. 
* *ArrayExpression* — выражение, которое возвращает массив. Если используется этот аргумент, добавляется новый столбец, а существующий сохраняется.
* *Name* — имя нового столбца.
* *Типовое имя:* Указывает базовый тип элементов массива, который становится типом столбца, производимого оператором.
    Обратите внимание, что значения в массиве, которые не соответствуют этому типу, не будут преобразованы; скорее, они возьмут на себя `null` значение.
* *RowLimit* — максимальное количество строк, созданных из каждой исходной строки. По умолчанию 2147483647. 
*Примечание*: Наследие и устаревшая форма оператора `mvexpand` имеет лимит строки по умолчанию 128.
* *IndexColumnName:* Если `with_itemindex` указано, выход будет включать в себя дополнительный столбец (названный *IndexColumnName),* который содержит индекс (начиная с 0) элемента в первоначальной расширенной коллекции. 

**Возвращает**

Несколько строк для каждого значения в массиве в именованном столбце или выражении массива.
Если указано несколько столбцов или выражений, они расширяются параллельно, так что для каждого строки ввода будет столько же строк вывода, сколько элементов в самом длинном расширенном выражении (короткие списки заполнены нулевыми). Если значение в строке является пустым массивом, строка расширяется до нуля (не будет отображаться в наборе результатов). Если значение в строке не является массивом, строка сохраняется, как в наборе результатов. 

Тип развернутого столбца всегда динамический. Чтобы выполнить обычное или статистическое вычисление значений, используйте приведение, например `todatetime()` или `tolong()`.

Поддерживаются два режима развертывания контейнера свойств.
* `bagexpansion=bag`— контейнеры свойств развертываются в контейнеры свойств с одной записью. Это значение по умолчанию.
* `bagexpansion=array`: Пакеты свойств расширяются `[`на двухэлементные структуры*value* `]` *массива ключей,*`,`что позволяет единообразное доступ к ключам и значениям (а также, например, работает агрегация с четким счетом по именам свойств). 

**Примеры**

Простое расширение одного столбца:
 ```kusto
datatable (a:int, b:dynamic)[1,dynamic({"prop1":"a", "prop2":"b"})]
| mv-expand b 
```

|а|b|
|---|---|
|1|«prop1»:»а»»|
|1|«prop2»:«б»|


Расширение двух столбцов сначала «застегнет» применимые столбцы, а затем расширит их:

```kusto
datatable (a:int, b:dynamic, c:dynamic)[1,dynamic({"prop1":"a", "prop2":"b"}), dynamic([5])]
| mv-expand b, c 
```

|а|b|с|
|---|---|---|
|1|«prop1»:»а»»|5|
|1|«prop2»:«б»||

Если вы хотите получить декартовский продукт расширения двух столбцов, расширяйте одну за другой:
```kusto
datatable (a:int, b:dynamic, c:dynamic)[1,dynamic({"prop1":"a", "prop2":"b"}), dynamic([5])]
| mv-expand b 
| mv-expand c
```

|а|b|с|
|---|---|---|
|1|«prop1»:»а»»|5|
|1|«prop2»:«б»|5|


Расширение массива `with_itemindex`с:
```kusto
range x from 1 to 4 step 1 
| summarize x = make_list(x) 
| mv-expand with_itemindex=Index  x 
```

|x|Индекс|
|---|---|
|1|0|
|2|1|
|3|2|
|4|3|


**Другие примеры**

Смотрите [Диаграмма кол живой деятельности с течением времени](./samples.md#concurrent-activities).

**См. также:**

- [mv-прикладной](./mv-applyoperator.md) оператор.
- [обобщенные make_list(),](makelist-aggfunction.md) который выполняет противоположную функцию.
- [bag_unpack ()](bag-unpackplugin.md) плагин для расширения динамических объектов JSON в столбцы с помощью ключей сумок свойства.