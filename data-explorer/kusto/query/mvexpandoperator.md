---
title: Оператор MV-Expand — Azure обозреватель данных
description: В этой статье описывается оператор MV-Expand в Azure обозреватель данных.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/24/2019
ms.openlocfilehash: a0d19f3466381bef3848365c2af27109e9699087
ms.sourcegitcommit: 733bde4c6bc422c64752af338b29cd55a5af1f88
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/13/2020
ms.locfileid: "83271321"
---
# <a name="mv-expand-operator"></a>Оператор mv-expand

Развертывает массив с несколькими значениями или контейнер свойств.

`mv-expand`применяется к столбцу с [динамическим](./scalar-data-types/dynamic.md)типом, так что каждое значение в коллекции получает отдельную строку. Все остальные столбцы в развернутой строке дублируются. 

**Синтаксис**

*T* `| mv-expand ` [ `bagexpansion=` ( `bag`  |  `array` )] [ `with_itemindex=` *индексколумннаме*] *ColumnName* [ `,` *ColumnName* ...] [ `limit` *ровлимит*]

*T* `| mv-expand ` [ `bagexpansion=` ( `bag`  |  `array` )] [*имя* `=` ] *аррайекспрессион* [ `to typeof(` *TypeName* `)` ] [, [*имя* `=` ] *аррайекспрессион* [ `to typeof(` *TypeName* `)` ]...] [ `limit` *ровлимит*]

**Аргументы**

* *ColumnName* — в выходных данных массивы из этого столбца будут развернуты в несколько строк. 
* *ArrayExpression* — выражение, которое возвращает массив. Если используется этот аргумент, добавляется новый столбец, а существующий сохраняется.
* *Name* — имя нового столбца.
* *Имя типа:* Указывает базовый тип элементов массива, который станет типом столбца, созданного оператором.
    Обратите внимание, что значения в массиве, которые не соответствуют этому типу, не будут преобразованы. Вместо этого они будут принимать `null` значение.
* *RowLimit* — максимальное количество строк, созданных из каждой исходной строки. Значение по умолчанию — 2147483647. 
*Примечание*. устаревшие и устаревшие формы оператора `mvexpand` имеют ограничение по строкам 128.
* *Индексколумннаме:* Если `with_itemindex` указан параметр, выходные данные будут включать в себя дополнительный столбец (с именем *индексколумннаме*), который содержит индекс (начиная с 0) элемента в исходной расширенной коллекции. 

**Возвращает**

Несколько строк для каждого значения в массиве в именованном столбце или выражении массива.
Если указано несколько столбцов или выражений, они развертываются параллельно, поэтому для каждой входной строки будет доступно столько выходных строк, сколько элементов в максимальном развернутом выражении (более короткие списки дополнены значениями NULL). Если значение в строке является пустым массивом, строка расширяется до Nothing (не отображается в результирующем наборе). Если значение в строке не является массивом, строка сохраняется как имеющаяся в результирующем наборе. 

Тип развернутого столбца всегда динамический. Чтобы выполнить обычное или статистическое вычисление значений, используйте приведение, например `todatetime()` или `tolong()`.

Поддерживаются два режима развертывания контейнера свойств.
* `bagexpansion=bag`— контейнеры свойств развертываются в контейнеры свойств с одной записью. Это значение по умолчанию.
* `bagexpansion=array`: Контейнеры свойств разворачиваются по `[` *key* `,` *value* `]` структурам массива значений ключей, соличающихся с двумя элементами, что обеспечивает универсальный доступ к ключам и значениям (например, выполнение агрегата Distinct-Count для имен свойств). 

**Примеры**

Простое расширение одного столбца:

<!-- csl: https://help.kusto.windows.net:443/Samples -->
 ```kusto
datatable (a:int, b:dynamic)[1,dynamic({"prop1":"a", "prop2":"b"})]
| mv-expand b 
```

|а|b|
|---|---|
|1|{"Prop1": "a"}|
|1|{"Prop2": "b"}|


При раскрытии двух столбцов сначала будут почтовыми подходящими столбцами, а затем раскройте их:

<!-- csl: https://help.kusto.windows.net:443/Samples -->
```kusto
datatable (a:int, b:dynamic, c:dynamic)[1,dynamic({"prop1":"a", "prop2":"b"}), dynamic([5])]
| mv-expand b, c 
```

|а|b|с|
|---|---|---|
|1|{"Prop1": "a"}|5|
|1|{"Prop2": "b"}||

Если вы хотите получить декартово произведение двух столбцов, разверните один за другим:

<!-- csl: https://help.kusto.windows.net:443/Samples -->
```kusto
datatable (a:int, b:dynamic, c:dynamic)[1,dynamic({"prop1":"a", "prop2":"b"}), dynamic([5])]
| mv-expand b 
| mv-expand c
```

|а|b|с|
|---|---|---|
|1|{"Prop1": "a"}|5|
|1|{"Prop2": "b"}|5|


Расширение массива с помощью `with_itemindex` :

<!-- csl: https://help.kusto.windows.net:443/Samples -->
```kusto
range x from 1 to 4 step 1 
| summarize x = make_list(x) 
| mv-expand with_itemindex=Index  x 
```

|x|Индекс|
|---|---|
|1|0|
|2|1|
|3|2|
|4|3|


**Дополнительные примеры**

См. раздел [число активных действий в диаграмме с](./samples.md#concurrent-activities)течением времени.

**См. также:**

- Оператор « [MV-Apply»](./mv-applyoperator.md) .
- [обобщить make_list ()](makelist-aggfunction.md) , которая выполняет противоположную функцию.
- подключаемый модуль [bag_unpack ()](bag-unpackplugin.md) для расширения динамических объектов JSON в столбцы с помощью ключей контейнера свойств.
