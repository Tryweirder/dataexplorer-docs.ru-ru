---
title: Оператор make-Series — Azure обозреватель данных
description: В этой статье описывается оператор make-Series в Azure обозреватель данных.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: alexans
ms.service: data-explorer
ms.topic: reference
ms.date: 03/16/2020
ms.openlocfilehash: 1e39e71aa9406815338974b2da03d05315054b65
ms.sourcegitcommit: 608539af6ab511aa11d82c17b782641340fc8974
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/20/2020
ms.locfileid: "92247356"
---
# <a name="make-series-operator"></a>Оператор make-series

Создать ряд заданных статистических значений по указанной оси.

```kusto
T | make-series sum(amount) default=0, avg(price) default=0 on timestamp from datetime(2016-01-01) to datetime(2016-01-10) step 1d by fruit, supplier
```

## <a name="syntax"></a>Синтаксис

*T* `| make-series` [*макесериеспарамтерс*] [*Column* `=` ] *агрегирование* [ `default` `=` *DefaultValue*] [ `,` ...] `on` *AxisColumn* [ `from` *Начало*] [ `to` *конец*] `step` *шаг* [ `by` [*столбец* `=` ] *GroupExpression* [ `,` ...]]

## <a name="arguments"></a>Аргументы

* *Column* — необязательное имя итогового столбца. По умолчанию это имя, получаемое из выражения.
* *DefaultValue:* Значение по умолчанию, которое будет использоваться вместо отсутствия значений. Если нет строки с конкретными значениями *AxisColumn* и *GroupExpression*, то в результатах для соответствующего элемента массива будет присвоено значение *DefaultValue*. Если значение *DefaultValue* опущено, то предполагается значение 0. 
* *Статистическая обработка:* Вызов [агрегатной функции](make-seriesoperator.md#list-of-aggregation-functions) , такой как `count()` или `avg()` , с именами столбцов в качестве аргументов. См. [список статистических функций](make-seriesoperator.md#list-of-aggregation-functions). С оператором можно использовать только статистические функции, возвращающие числовые результаты `make-series` .
* *AxisColumn:* Столбец, в котором будет упорядочен ряд. Ее можно рассматривать как временную шкалу, но помимо `datetime` любых числовых типов.
* *Начало*: (необязательно) значение нижней границы *AxisColumn* для каждого ряда, который должен быть построен. *Start*, *End*и *Step* используются для создания массива значений *AxisColumn* в заданном диапазоне и с использованием указанного *шага*. Все *статистические* значения упорядочиваются соответственно этому массиву. Этот массив *AxisColumn* также является последним выходным столбцом в выходных данных, имеющим то же имя, что и *AxisColumn*. Если *Начальное* значение не указано, то начало — это первая ячейка (Step), которая содержит данные в каждом ряду.
* *конец*: (необязательно) значение высокой границы (не включающее) *AxisColumn*. Последний индекс временного ряда меньше этого значения (и будет *начинаться* плюс целое *число, которое* меньше, чем *конец*). Если *Конечное* значение не указано, оно будет верхней границей последней ячейки (шага), которая содержит данные по каждому ряду.
* *шаг*. разница между двумя последовательными элементами массива *AxisColumn* (то есть размером ячейки).
* *GroupExpression:* Выражение для столбцов, предоставляющее набор уникальных значений. Обычно это имя столбца, который уже содержит ограниченный набор значений. 
* *Макесериеспараметерс*: ноль или более (разделенных пробелами) параметров в виде значения *имени* `=` *Value* , определяющего поведение. Поддерживаются следующие параметры: 
  
  |Имя           |Значения                                        |Описание                                                                                        |
  |---------------|-------------------------------------|------------------------------------------------------------------------------|
  |`kind`          |`nonempty`                               |Создает результат по умолчанию, если входные данные оператора Make-Series пусты|                                

## <a name="returns"></a>Результаты

Входные строки упорядочиваются по группам с одинаковыми значениями `by` выражений и `bin_at(` *AxisColumn* `, ` *шага* `, ` *начала* `)` . Затем указанные агрегатные функции выполняют вычисления и создают строку для каждой группы. Результат содержит столбцы Columns `by` , *AxisColumn* и, по крайней мере, один столбец для каждого вычисляемого агрегата. (Агрегирование, что несколько столбцов или нечисловые результаты не поддерживаются.)

Этот промежуточный результат содержит столько строк, сколько имеется отдельных сочетаний `by` и `bin_at(` *AxisColumn* `, ` *step* `, ` *начальных* `)` значений шага.

Наконец, строки из промежуточного результата, сгруппированные в группы с одинаковыми значениями `by` выражений, и все агрегированные значения упорядочиваются в массивы (значения `dynamic` типа). Для каждого агрегата существует один столбец, содержащий массив с тем же именем. Последний столбец в выходных данных функции Range со всеми значениями *AxisColumn* . Его значение повторяется для всех строк. 

Из-за заполнения отсутствующих ячеек значением по умолчанию результирующая Сводная таблица имеет то же количество ячеек (то есть агрегированные значения) для всех рядов.  

**Примечание**.

Хотя можно предоставить произвольные выражения для агрегатов и выражений группирования, более эффективно использовать простые имена столбцов.

**Альтернативный синтаксис**

*T* `| make-series` [*столбец* `=` ] *агрегирование* [ `default` `=` *DefaultValue*] [ `,` ...] `on` *AxisColumn* `in` `range(` *начать* `,` *прерывать* `,` *шаг* `)` [ `by` [*столбец* `=` ] *GroupExpression* [ `,` ...]]

Созданный ряд из альтернативного синтаксиса отличается от основного синтаксиса в двух аспектах:
* Значение параметра *останавливает* является инклюзивным.
* Группирования. ось индекса создается с помощью bin (), а не bin_at (), что означает, что *Start* может не включаться в созданный ряд.

Рекомендуется использовать основной синтаксис серии make, а не альтернативный синтаксис.

**Распространение и случайный выбор**

`make-series` поддерживает `summarize` [указания шуффлекэй](shufflequery.md) с использованием подсказки синтаксиса. шуффлекэй.

## <a name="list-of-aggregation-functions"></a>Список статистических функций

|Компонент|Описание|
|--------|-----------|
|[any()](any-aggfunction.md)|Возвращает случайное непустое значение для группы|
|[avg()](avg-aggfunction.md)|Возвращает среднее значение в группе|
|[avgif()](avgif-aggfunction.md)|Возвращает среднее значение с предикатом группы|
|[count()](count-aggfunction.md)|Возвращает количество групп|
|[countif()](countif-aggfunction.md)|Возвращает число с предикатом группы|
|[dcount()](dcount-aggfunction.md)|Возвращает приблизительное число различных элементов группы.|
|[dcountif()](dcountif-aggfunction.md)|Возвращает приблизительное число различных объектов с предикатом группы|
|[max()](max-aggfunction.md)|Возвращает максимальное значение в группе.|
|[maxif()](maxif-aggfunction.md)|Возвращает максимальное значение с предикатом группы|
|[min()](min-aggfunction.md)|Возвращает минимальное значение в группе.|
|[minif()](minif-aggfunction.md)|Возвращает минимальное значение с предикатом группы|
|[stdev()](stdev-aggfunction.md)|Возвращает стандартное отклонение по группе|
|[sum()](sum-aggfunction.md)|Возвращает сумму элементов в группе|
|[sumif()](sumif-aggfunction.md)|Возвращает сумму элементов с предикатом группы|
|[variance()](variance-aggfunction.md)|Возвращает дисперсию по группе|

## <a name="list-of-series-analysis-functions"></a>Список функций анализа рядов

|Компонент|Описание|
|--------|-----------|
|[series_fir()](series-firfunction.md)|Применение фильтра [конечного ответа с ограничением](https://en.wikipedia.org/wiki/Finite_impulse_response)|
|[series_iir()](series-iirfunction.md)|Применяет [бесконечный фильтр ответов с неограниченным импульсом](https://en.wikipedia.org/wiki/Infinite_impulse_response)|
|[series_fit_line()](series-fit-linefunction.md)|Находит прямую линию, которая является наилучшим приближением входных данных|
|[series_fit_line_dynamic()](series-fit-line-dynamicfunction.md)|Находит строку, которая является наилучшим приближением входных данных, возвращая динамический объект|
|[series_fit_2lines()](series-fit-2linesfunction.md)|Находит две строки, которые являются наилучшим приближением входных данных|
|[series_fit_2lines_dynamic()](series-fit-2lines-dynamicfunction.md)|Находит две строки, которые являются наилучшим приближением входных данных, возвращая динамический объект|
|[series_outliers()](series-outliersfunction.md)|Оценки аномалий в ряде|
|[series_periods_detect()](series-periods-detectfunction.md)|Находит наиболее значимые периоды, которые существуют во временных рядах|
|[series_periods_validate()](series-periods-validatefunction.md)|Проверяет, содержит ли временные ряды периодические шаблоны заданной длины|
|[series_stats_dynamic()](series-stats-dynamicfunction.md)|Возврат нескольких столбцов с общей статистикой (min/max/вариативность/STDEV/Average)|
|[series_stats()](series-statsfunction.md)|Создает динамическое значение с общей статистикой (min/max/вариативность/STDEV/Average)|
  
## <a name="list-of-series-interpolation-functions"></a>Список функций интерполяции ряда

|Компонент|Описание|
|--------|-----------|
|[series_fill_backward()](series-fill-backwardfunction.md)|Выполняет интерполяцию обратной заливки отсутствующих значений в ряде|
|[series_fill_const()](series-fill-constfunction.md)|Заменяет отсутствующие значения в ряде с указанным постоянным значением|
|[series_fill_forward()](series-fill-forwardfunction.md)|Выполняет интерполяцию прямой заливки отсутствующих значений в ряде|
|[series_fill_linear()](series-fill-linearfunction.md)|Выполняет линейную интерполяцию отсутствующих значений в ряде|

* Примечание. функции интерполяции по умолчанию предполагают `null` отсутствие значения. Поэтому укажите `default=` *Double*( `null` ) в `make-series` , если планируется использовать функции интерполяции для ряда. 

## <a name="example"></a>Пример
  
 Таблица, в которой отображаются массивы чисел и средние цены каждого из фруктов каждого из поставщиков, упорядоченные по метке времени с указанным диапазоном. В выходных данных есть строка для каждого отдельного сочетания фруктов и поставщика. В выходных столбцах показаны фруктов, поставщик и массивы: количество, среднее и полная временная шкала (от 2016-01-01 до 2016-01-10). Все массивы сортируются по соответствующей метке времени, а все пробелы заполняются значениями по умолчанию (0 в этом примере). Все остальные входные столбцы игнорируются.
  
```kusto
T | make-series PriceAvg=avg(Price) default=0
on Purchase from datetime(2016-09-10) to datetime(2016-09-13) step 1d by Supplier, Fruit
```

:::image type="content" source="images/make-seriesoperator/makeseries.png" alt-text="Три таблицы. Первый список содержит необработанные данные, второй — только комбинации «поставщик-фруктов-Дата», а третья — результаты серии make.":::  

<!-- csl: https://help.kusto.windows.net:443/Samples --> 
```kusto
let data=datatable(timestamp:datetime, metric: real)
[
  datetime(2016-12-31T06:00), 50,
  datetime(2017-01-01), 4,
  datetime(2017-01-02), 3,
  datetime(2017-01-03), 4,
  datetime(2017-01-03T03:00), 6,
  datetime(2017-01-05), 8,
  datetime(2017-01-05T13:40), 13,
  datetime(2017-01-06), 4,
  datetime(2017-01-07), 3,
  datetime(2017-01-08), 8,
  datetime(2017-01-08T21:00), 8,
  datetime(2017-01-09), 2,
  datetime(2017-01-09T12:00), 11,
  datetime(2017-01-10T05:00), 5,
];
let interval = 1d;
let stime = datetime(2017-01-01);
let etime = datetime(2017-01-10);
data
| make-series avg(metric) on timestamp from stime to etime step interval 
```
  
|avg_metric|TIMESTAMP|
|---|---|
|[4,0, 3,0, 5,0, 0,0, 10,5, 4,0, 3,0, 8,0, 6,5]|["2017-01-01T00:00:00.0000000 Z", "2017-01-02T00:00:00.0000000 Z", "2017-01-03T00:00:00.0000000 Z", "2017-01-04T00:00:00.0000000 Z", "2017-01-05T00:00:00.0000000 Z", "2017-01-06T00:00:00.0000000 Z", "2017-01-07T00:00:00.0000000 Z", "2017-01-08T00:00:00.0000000 Z", "2017-01-09T00:00:00.0000000 Z"]|  


Если входные данные `make-series` пусты, поведение по умолчанию `make-series` также создает пустой результат.

<!-- csl: https://help.kusto.windows.net/Samples -->
```kusto
let data=datatable(timestamp:datetime, metric: real)
[
  datetime(2016-12-31T06:00), 50,
  datetime(2017-01-01), 4,
  datetime(2017-01-02), 3,
  datetime(2017-01-03), 4,
  datetime(2017-01-03T03:00), 6,
  datetime(2017-01-05), 8,
  datetime(2017-01-05T13:40), 13,
  datetime(2017-01-06), 4,
  datetime(2017-01-07), 3,
  datetime(2017-01-08), 8,
  datetime(2017-01-08T21:00), 8,
  datetime(2017-01-09), 2,
  datetime(2017-01-09T12:00), 11,
  datetime(2017-01-10T05:00), 5,
];
let interval = 1d;
let stime = datetime(2017-01-01);
let etime = datetime(2017-01-10);
data
| limit 0
| make-series avg(metric) default=1.0 on timestamp from stime to etime step interval 
| count 
```

|Счетчик|
|---|
|0|


Использование `kind=nonempty` в `make-series` приведет к непустому результату значений по умолчанию:

<!-- csl: https://help.kusto.windows.net/Samples -->
```kusto
let data=datatable(timestamp:datetime, metric: real)
[
  datetime(2016-12-31T06:00), 50,
  datetime(2017-01-01), 4,
  datetime(2017-01-02), 3,
  datetime(2017-01-03), 4,
  datetime(2017-01-03T03:00), 6,
  datetime(2017-01-05), 8,
  datetime(2017-01-05T13:40), 13,
  datetime(2017-01-06), 4,
  datetime(2017-01-07), 3,
  datetime(2017-01-08), 8,
  datetime(2017-01-08T21:00), 8,
  datetime(2017-01-09), 2,
  datetime(2017-01-09T12:00), 11,
  datetime(2017-01-10T05:00), 5,
];
let interval = 1d;
let stime = datetime(2017-01-01);
let etime = datetime(2017-01-10);
data
| limit 0
| make-series kind=nonempty avg(metric) default=1.0 on timestamp from stime to etime step interval 
```

|avg_metric|TIMESTAMP|
|---|---|
|[<br>  1,0,<br>  1,0,<br>  1,0,<br>  1,0,<br>  1,0,<br>  1,0,<br>  1,0,<br>  1,0,<br>  1.0<br>]|[<br>  "2017-01-01T00:00:00.0000000 Z",<br>  "2017-01-02T00:00:00.0000000 Z",<br>  "2017-01-03T00:00:00.0000000 Z",<br>  "2017-01-04T00:00:00.0000000 Z",<br>  "2017-01-05T00:00:00.0000000 Z",<br>  "2017-01-06T00:00:00.0000000 Z",<br>  "2017-01-07T00:00:00.0000000 Z",<br>  "2017-01-08T00:00:00.0000000 Z",<br>  "2017-01-09T00:00:00.0000000 Z"<br>]|
