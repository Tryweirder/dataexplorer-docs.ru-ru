---
title: Kusto. Explorer — средство Azure обозреватель данных
description: В этой статье описывается средство Kusto. Explorer в Azure обозреватель данных.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 03/23/2020
ms.openlocfilehash: 60a414ff871d88de041e8b76671b73d98854fba0
ms.sourcegitcommit: bb8c61dea193fbbf9ffe37dd200fa36e428aff8c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/13/2020
ms.locfileid: "83374074"
---
# <a name="kustoexplorer-tool"></a>Средство Kusto. Explorer

Kusto. Explorer — это многофункциональное классическое приложение, позволяющее исследовать данные с помощью языка запросов Kusto.

## <a name="getting-the-tool"></a>Получение средства

* Установка [средства Kusto. Explorer](https://aka.ms/Kusto.Explorer)

* Кроме того, вы можете получить доступ к кластеру Kusto в браузере по адресу: `https://<your_cluster>.kusto.windows.net` . Замените <your_cluster> именем кластера Azure обозреватель данных.



## <a name="using-chrome-and-kustoexplorer"></a>Использование Chrome и Kusto. Explorer

Если вы используете Chrome в качестве браузера по умолчанию, обязательно установите расширение ClickOnce для Chrome:

[https://chrome.google.com/webstore/detail/clickonce-for-google-chro/kekahkplibinaibelipdcikofmedafmb/related?hl=en-US](https://chrome.google.com/webstore/detail/clickonce-for-google-chro/kekahkplibinaibelipdcikofmedafmb/related?hl=en-US)



## <a name="overview-of-the-user-experience"></a>Обзор взаимодействия с пользователем

Окно обозревателя Kusto содержит несколько частей пользовательского интерфейса:

1. [Панель меню](#menu-panel)
2. [Панель "подключения"](#connections-panel)
3. Панель сценариев
4. Область результатов

![Запуск Kusto. Explorer](./Images/KustoTools-KustoExplorer/ke-start.png "Начало работы")

### <a name="keyboard-shortcuts"></a>сочетания клавиш

Может оказаться, что использование сочетаний клавиш позволяет выполнять операции быстрее, чем с помощью мыши. Взгляните на этот [список сочетаний клавиш Kusto. Explorer](kusto-explorer-shortcuts.md).

### <a name="menu-panel"></a>Панель меню

Панель меню Kusto. Explorer содержит следующие вкладки:

* [Главная](#home-tab)
* [Файл](#file-tab)
* [Подключения](#connections-tab)
* [Вид](#view-tab)
* [Инструменты](#tools-tab)

* [Управление](#management-tab)
* [Справка](#help-tab)

### <a name="home-tab"></a>Вкладка «Главная»

![Домашняя страница Kusto. Explorer](./Images/KustoTools-KustoExplorer/home-tab.png "Вкладка "Главная"")

На вкладке Главная отображаются наиболее часто используемые функции, разделенные на разделы.

* [Запрос](#query-section)
* [Общий ресурс](#share-section)
* [Визуализации](#visualizations-section)
* [Вид](#view-section)
* [Справка](#help-tab) 

#### <a name="query-section"></a>Раздел запроса

![Меню запросов Kusto. Explorer](./Images/KustoTools-KustoExplorer/home-query-menu.png "меню запроса")

|Меню|    Поведение|
|----|----------|
|Раскрывающийся список режима | <ul><li>Режим запроса: переключает окно запросов в [режим сценария](#query-mode). Команды можно загружать и сохранять в виде скриптов (по умолчанию)</li> <li> Режим поиска: один режим запроса, где каждая выполненная команда обрабатывается немедленно и представляет результат в окне результатов.</li> <li>Режим поиска + +: позволяет искать термин, используя синтаксис поиска в одной или нескольких таблицах. Дополнительные сведения об использовании [режима поиска + +](kusto-explorer.md#search-mode)</li></ul> |
|Создать вкладку| Открывает новую вкладку для запроса Kusto |

#### <a name="share-section"></a>Общий доступ к разделу

![Раздел общей папки Kusto. Explorer](./Images/KustoTools-KustoExplorer/home-share-menu.png "Общий доступ — меню")

|Меню|    Поведение|
|----|----------|
|Данные в буфер обмена|    Экспортирует запрос и набор данных в буфер обмена. Если диаграмма представлена, она экспортирует диаграмму как точечный рисунок.| 
|Результат в буфер обмена| Экспортирует набор данных в буфер обмена. Если диаграмма представлена, она экспортирует диаграмму как точечный рисунок.| 
|Запрос в буфер обмена| Экспорт запроса в буфер обмена|

#### <a name="visualizations-section"></a>Раздел "визуализации"

![Замещающий текст](./Images/KustoTools-KustoExplorer/home-visualizations-menu.png "меню — визуализации")

|Меню         | Поведение|
|-------------|---------|
|Диаграмма с областями      | Отображает диаграмму с областями, в которой ось X является первым столбцом (должен быть числовым), а все числовые столбцы сопоставляются с разными рядами (ось Y). |
|Гистограмма | Отображает гистограмму, в которой все числовые столбцы сопоставлены с различными рядами (ось Y), а текстовый столбец перед числовым — по оси X (может управляться в пользовательском интерфейсе).|
|Линейчатая диаграмма    | Отображает линейчатую диаграмму, в которой все числовые столбцы сопоставлены с различными рядами (ось X), а текстовый столбец перед числовым — осью Y (может управляться в пользовательском интерфейсе).|
|диаграмма с областями и накоплением.      | Отображает диаграмму с областями с накоплением, в которой ось X является первым столбцом (должен быть числовым), а все числовые столбцы сопоставляются с разными рядами (ось Y). |
|Диаграмма временной шкалы   | Отображает диаграмму времени, в которой ось X является первым столбцом (должен быть DateTime), а все числовые столбцы сопоставляются с различными рядами (ось Y).|
|График   | Отображает график, в котором ось X является первым столбцом (должен быть числовым), а все числовые столбцы сопоставляются с различными рядами (ось Y).|
|Диаграмма аномалий|    Аналогичен диаграмму, но находит аномалии в данных временных рядов, используя алгоритм аномалий машинного обучения. Для обнаружения аномалий в Kusto. Explorer используется функция [series_decompose_anomalies](../query/series-decompose-anomaliesfunction.md) . (*) 
|Круговая диаграмма    |    Отображает круговую диаграмму, в которой ось цвета является первым столбцом, а в качестве второго столбца — ось тета (должна быть мера, преобразованная в процент).|
|Диаграмма с лестницами |    Отображает диаграмму, в которой ось X является последними двумя столбцами (должен быть DateTime), а ось Y — совмещением других столбцов.|
|Точечная диаграмма| Отображает точечную диаграмму, в которой ось X является первым столбцом (должен быть числовым), а все числовые столбцы сопоставляются с различными рядами (ось Y).|
|Сводная диаграмма  | Воспроизводить сводную таблицу и сводную диаграмму, которая обеспечивает полную гибкость выбора данных, столбцов, строк и различных типов диаграмм.| 
|Сводная таблица времени   | Интерактивная Навигация по временной шкале событий (сведение по оси времени)|

(*) Диаграмма аномалий. алгоритм предполагает, что TimeSeries данные, состоящие из двух столбцов:
1. Время в сегментах фиксированного интервала
2. Числовое значение для обнаружения аномалий, которое будет выдаваться в Kusto. Explorer, суммировать по полю времени и указать ячейку временного сегмента.

#### <a name="view-section"></a>Просмотреть раздел

![Замещающий текст](./Images/KustoTools-KustoExplorer/home-view-menu.png "меню "вид"")

|Меню           | Поведение|
|---------------|---------|
|Режим полного просмотра | Увеличивает рабочее пространство, скрывая меню ленты и панель подключения.|
|Скрыть пустые столбцы| Удаляет пустые столбцы из сетки данных|
|Свернуть единственные столбцы| Сворачивает столбцы с единственными значениями|
|Просмотр значений столбцов| Показывает распределение значений столбцов|
|Увеличить шрифт  | Увеличение размера шрифта на вкладке "запрос" и в сетке данных "результаты"|  
|Уменьшить шрифт  | Уменьшение размера шрифта на вкладке запроса и сетки данных результатов|

(*) Параметры представления данных: Kusto. Explorer отслеживает, какие параметры используются для каждого уникального набора столбцов. Поэтому при изменении порядка столбцов или их удалении представление данных сохраняется и будет использоваться повторно при каждом извлечении данных с теми же столбцами. Чтобы сбросить представление до значений по умолчанию, на вкладке **вид** выберите **Сбросить представление**. 

### <a name="file-tab"></a>Вкладка "Файл"

![Файл Kusto. Explorer](./Images/KustoTools-KustoExplorer/file-tab.png "Вкладка "файл"")

|Меню| Поведение|
|---------------|---------|
||---------*Скрипт запроса*---------|
|Создать вкладку | Открывает новое окно вкладки для запроса Kusto |
|Открыть файл| Загружает данные из файла *. ККЛ на активную панель сценариев|
|Сохранить в файл| Сохраняет содержимое активной панели сценариев в файле *. ККЛ|
|Закрыть вкладку| Закрытие текущего окна вкладки|
||---------*Сохранение данных*---------|
|В CSV-файл       | Экспортирует данные в файл CSV (с разделителями-запятыми)| 
|В JSON      | Экспортирует данные в отформатированный файл JSON|
|В Excel     | Экспорт данных в файл XLSX (Excel)|
|В текст      |    Экспорт данных в файл TXT (текстовый)| 
|В CSL сценарий|    Экспортирует запрос в файл скрипта| 
|В результаты   |    Экспорт запроса и данных в файл результатов (КРЕС)|
||---------*Загрузка данных*---------|
|Из результатов|    Загрузка запроса и данных из файла результатов (КРЕС)| 
||---------*Буфер обмена*---------|
|Данные в буфер обмена|    Экспортирует запрос и набор данных в буфер обмена. Если диаграмма представлена, она экспортируется в виде точечного рисунка.| 
|Результат в буфер обмена| Экспортирует набор данных в буфер обмена. Если диаграмма представлена, она экспортируется в виде точечного рисунка.| 
|Запрос в буфер обмена| Экспортирует запрос в буфер обмена|
||---------*Результаты*---------|
|Очистить кэш результатов| Очищает кэшированные результаты ранее выполненных запросов| 

### <a name="connections-tab"></a>Вкладка "подключения"

![Вкладка "подключения" Kusto. Explorer](./Images/KustoTools-KustoExplorer/connections-tab.png "Вкладка "подключения"")

|Меню|Поведение|
|----|----------|
||---------*Группы*---------|
|Добавление группы| Добавляет новую группу серверов Kusto|
|Переименовать группу| Переименовывает существующую группу серверов Kusto|
|Удалить группу| Удаляет существующую группу серверов Kusto|
||---------*КБайт*---------|
|Подключения с помощью импорта| Импортирует соединения из файла, указывающего соединения|
|Экспорт соединений| Экспорт соединений в файл|
|Добавление подключения| Добавляет новое соединение с сервером Kusto| 
|Изменение подключения| Открывает диалоговое окно для изменения свойств соединения с сервером Kusto|
|Удалить подключение| Удаляет существующее подключение к серверу Kusto|
|Обновление| Обновляет свойства соединения с сервером Kusto|
||---------*Поставщики удостоверений*---------|
|Проверка субъекта подключения| Показывает текущие сведения об активных пользователях|
|Выход из AAD| Выписывает текущего пользователя из подключения к AAD.|
||---------*Область данных*---------|
|Область кэширования|<ul><li>Горячий запрос на выполнение запросов только в случае [горячего кэша данных](../management/cachepolicy.md)</li><li>Все данные: выполнение запросов ко всем доступным данным (по умолчанию)</li></ul> |
|Столбец типа DateTime| Имя столбца, который может использоваться для предварительного фильтра времени|
|Фильтр времени| Значение времени предварительного фильтрации|

### <a name="view-tab"></a>Вкладка "вид"

![Вкладка "вид"](./Images/KustoTools-KustoExplorer/view-tab.png "Вкладка "вид"")

|Меню|Поведение|
|----|----------|
||---------*Внешний вид*---------|
|Режим полного просмотра | Увеличивает рабочее пространство, скрывая меню ленты и панель подключения.|
|Увеличить шрифт  | Увеличение размера шрифта на вкладке "запрос" и в сетке данных "результаты"|  
|Уменьшить шрифт  | Уменьшение размера шрифта на вкладке запроса и сетки данных результатов|
|Сбросить макет|Сбрасывает макет закрепленных элементов управления и окон инструментов|
||---------*Представление данных*---------|
|Сброс масштаба| Сбрасывает параметры представления данных (*)|
|Просмотр значений столбцов|Показывает распределение значений столбцов|
|Сосредоточиться на статистике запросов|Изменяет фокус на статистику запросов, а не на результаты запроса после завершения запроса|
|Скрыть дубликаты|Переключает удаление повторяющихся строк из результатов запроса|
|Скрыть пустые столбцы|Переключает удаление пустых столбцов из результатов запроса|
|Свернуть единственные столбцы|Переключает столбцы с использованием единственного значения|
||---------*Фильтрация данных*---------|
|Фильтрация строк в поиске|Переключает параметр для отображения только совпадающих строк в поиске результатов запроса (Ctrl + F)|
||---------*Визуализации*---------|
|Визуализации|См. раздел [визуализации](#visualizations-section)выше. |

(*) Параметры представления данных: Kusto. Explorer отслеживает, какие параметры используются для каждого уникального набора столбцов. Поэтому при изменении порядка столбцов или их удалении представление данных сохраняется и будет использоваться повторно при каждом извлечении данных с теми же столбцами. Чтобы сбросить представление до значений по умолчанию, на вкладке **вид** выберите **Сбросить представление**. 

### <a name="tools-tab"></a>Вкладка "Сервис"

![Вкладка "средства"](./Images/KustoTools-KustoExplorer/tools-tab.png "Сервис — вкладка")

|Меню|Поведение|
|----|----------|
||---------*IntelliSense*---------|
|Включение технологии IntelliSense| Включает и отключает IntelliSense на панели сценариев.|
||---------*Анализ*---------|
|программа Query Analyzer| Запуск средства анализа запросов|
|Средство проверки запросов | Анализирует текущий запрос и выводит набор применимых рекомендаций по улучшению.|
|Calculator| Запуск калькулятора|
||---------*Средства*---------|
|Аналитические отчеты| Открывает панель мониторинга с несколькими предварительно созданными отчетами для анализа данных.|
||---------*Перевести*---------|
|Запрос к Power BI| Преобразует запрос в формат, подходящий для использования в Power BI|
||---------*Параметры*---------|
|Параметры сброса| Задает параметры приложения для значений по умолчанию|
|Параметры| Открывает средство для настройки параметров приложения. [Сведения](kusto-explorer-options.md)|



### <a name="management-tab"></a>Вкладка "Управление"

![Вкладка "Управление"](./Images/KustoTools-KustoExplorer/management-tab.png "Управление — Вкладка")

|Меню             | Поведение|
|-----------------|---------|
||---------*Полномочные субъекты*---------|
|Управление полномочными участниками кластера |Позволяет управлять субъектами кластера для полномочных пользователей| 
|Управление полномочными участниками базы данных | Позволяет управлять субъектами базы данных для полномочных пользователей| 
|Управление полномочными участниками таблицы | Позволяет управлять субъектами таблицы для полномочных пользователей| 
|Управление полномочными участниками функции | Позволяет управлять субъектами функции для полномочных пользователей| 

### <a name="help-tab"></a>Вкладка "Справка"

![Вкладка "Справка"](./Images/KustoTools-KustoExplorer/help-tab.png "Вкладка "Справка"")

|Меню             | Поведение|
|-----------------|---------|
||---------*По*---------|
|Справка             | Открывает ссылку на электронную документацию по Kusto.  | 
|Новые возможности       | Открывает документ со списком всех изменений Kusto. Explorer.|
|Сообщить о проблеме      |Открывает диалоговое окно с двумя параметрами: <ul><li>Сообщать о проблемах, связанных со службой</li><li>Сообщить о проблемах в клиентском приложении</li></ul> | 
|Предложить функцию  | Открывает ссылку на форум обратной связи Kusto | 
|Проверка обновлений     | Проверяет наличие обновлений для версии Kusto. Explorer. | 

## <a name="connections-panel"></a>Панель "подключения"

![Замещающий текст](./Images/KustoTools-KustoExplorer/connectionsPanel.png "подключения — панель") 

В левой области Kusto. Explorer отображаются все подключения к кластеру, с помощью которых настроен клиент. Для каждого кластера отображаются базы данных, таблицы и атрибуты (столбцы), которые они хранят. Панель подключения позволяет выбрать элементы (которые задают неявный контекст для поиска или запроса на главной панели) или дважды щелкнуть элемент, чтобы скопировать имя на панель поиска и запроса.

Если фактическая схема велика (например, база данных с сотнями таблиц), можно выполнить поиск в схеме, нажав клавиши CTRL + F и введя подстроку (без учета регистра) для искомого имени сущности.

Kusto. Explorer поддерживает управление панелью подключения в окне запроса.
Это очень полезно для скриптов. Например, если запустить файл скрипта с помощью команды, предписывает Kusto. Explorer подключиться к кластеру или базе данных, к данным которых запрашиваются скрипт, можно использовать следующий синтаксис. Как обычно, необходимо выполнять каждую строку с помощью `F5` или аналогично:

```kusto
#connect cluster('help').database('Samples')

StormEvents | count
```

### <a name="controlling-the-user-identity-used-for-connecting-to-kusto"></a>Управление удостоверением пользователя, используемым для подключения к Kusto

При добавлении нового соединения используется используемая по умолчанию модель безопасности AAD-Федеративная, в которой проверка подлинности выполняется с помощью Azure Active Directory с использованием интерфейса пользователя AAD по умолчанию.

В некоторых случаях может потребоваться более точный контроль параметров проверки подлинности, чем доступно в AAD. Если это так, можно развернуть поле ввода "Дополнительно: строки подключения" и предоставить допустимое значение [строки подключения Kusto](../api/connection-strings/kusto.md) .

Например, пользователям, имеющим несколько клиентов AAD, иногда требуется использовать определенную проекцию своих удостоверений для конкретного клиента AAD. Это можно сделать, предоставив строку подключения, как показано ниже (замените слова в заглавной строке на конкретные значения):

```
Data Source=https://CLUSTER_NAME.kusto.windows.net;Initial Catalog=DATABASE_NAME;AAD Federated Security=True;Authority Id=AAD_TENANT_OF_CLUSTER;User=USER_DOMAIN
```

Уникальное название — это `AAD_TENANT_OF_CLUSTER` доменное имя или идентификатор клиента AAD (GUID) клиента AAD, в котором размещается кластер (обычно это доменное имя Организации, владеющее кластером, например `contoso.com` ), а USER_DOMAIN является идентификатором пользователя, приглашаемого в этот клиент (например, `joe@fabrikam.com` ). 

>[!Note]
> Доменное имя пользователя не обязательно совпадает с именем клиента, на котором размещается кластер.

## <a name="table-row-colors"></a>Цвета строк таблицы

Kusto. Explorer пытается «угадать» уровень серьезности или уровня детализации каждой строки на панели результатов и соответствующим образом изменить цвет. Это достигается путем сопоставления различных значений каждого столбца с набором известных шаблонов ("warning", "Error" и т. д.).

Чтобы изменить выходную цветовую схему или отключить это поведение, в меню **Сервис** выберите пункт **Параметры**  >  **Results Viewer**  >  **цветовая схема детализации**.

![замещающий текст](./Images/KustoTools-KustoExplorer/ke-color-scheme.png)

## <a name="search-mode"></a>Режим поиска + +

1. На вкладке Главная в раскрывающемся списке запрос выберите "Поиск + +".
2. Выберите **несколько таблиц** , а затем в разделе **Выбор таблиц**Укажите таблицы для поиска.
3. В поле ввода введите фразу для поиска и выберите **Go (перейти** ).
4. Тепловая схема сетки таблицы или временного слота показывает, какой термин отображается и где они отображаются
5. Выберите ячейку в сетке и щелкните **Просмотреть сведения** , чтобы отобразить соответствующие записи.

![Замещающий текст](./Images/KustoTools-KustoExplorer/ke-search-beta.jpg "Поиск — бета-версия") 

## <a name="query-mode"></a>Режим запроса

Kusto. Explorer имеет мощный режим работы со сценариями, который позволяет писать, изменять и выполнять нерегламентированные запросы. Режим скриптов поставляется с выделением синтаксиса и технологией IntelliSense, что позволяет быстро выровнять до Kusto CSL языка.

### <a name="basic-queries"></a>Базовые запросы

Если у вас есть журналы таблиц, вы можете начать их исследование, введя следующее:

<!-- csl: https://help.kusto.windows.net:443/Samples -->
```kusto
StormEvents | count 
```

Когда курсор располагается в этой строке, он окрашивается серым цветом. При нажатии клавиши F5 выполняется запрос. 

Вот несколько примеров запросов:

<!-- csl: https://help.kusto.windows.net:443/Samples -->
```kusto
// Take 10 lines from the table. Useful to get familiar with the data
StormEvents | limit 10 
```

<!-- csl: https://help.kusto.windows.net:443/Samples -->
```kusto
// Filter by EventType == 'Flood' and State == 'California' (=~ means case insensitive) 
// and take sample of 10 lines
StormEvents 
| where EventType == 'Flood' and State =~ 'California'
| limit 10
```

## <a name="importing-a-local-file-into-a-kusto-table"></a>Импорт локального файла в таблицу Kusto

Kusto. Explorer предоставляет удобный способ передачи файлов с компьютера в таблицу Kusto.

1. Убедитесь, что создана таблица со схемой, соответствующей вашему файлу (например, с помощью команды [. CREATE TABLE).](../management/tables.md)

1. Убедитесь, что расширение файла соответствует содержимому файла. Пример:
    * Если файл содержит значения с разделителями-запятыми, убедитесь, что файл имеет расширение CSV.
    * Если файл содержит значения, разделенные символами табуляции, убедитесь, что файл имеет расширение. tsv.

1. Щелкните правой кнопкой мыши целевую базу данных на [панели подключения](#connections-panel)и выберите **Обновить**, чтобы появилась таблица.

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/right-click-refresh-schema.png "Щелкните правой кнопкой мыши-Refresh-Schema.")

1. Щелкните правой кнопкой мыши целевую таблицу на [панели подключения](#connections-panel)и выберите **Импорт данных из локальных файлов**.

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/right-click-import-local-file.png "Щелкните правой кнопкой мыши — импорт-локальный файл.")

1. Выберите файлы для отправки и нажмите кнопку **Открыть**.

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/import-local-file-choose-files.png "Импорт-локальный файл-выбор файлов")

    Индикатор выполнения отображает ход выполнения, и при завершении операции отображается диалоговое окно

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/import-local-file-progress.png "Импорт-локальный файл-ход выполнения")

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/import-local-file-complete.png "Импорт-локальный-файл — завершено")

1. Запросите данные в таблице (дважды щелкните таблицу на [панели подключения](#connections-panel)).

## <a name="managing-authorized-principals"></a>Управление полномочными участниками

Kusto. Explorer предоставляет удобный способ управления субъектами кластера, базы данных, таблицы или функции.

> [!Note]
> Только [Администраторы](../management/access-control/role-based-authorization.md) могут добавлять или удалять полномочные субъекты в своей области.

1. Щелкните правой кнопкой мыши целевую сущность на [панели подключения](#connections-panel)и выберите пункт **Управление полномочными участниками**. (Это также можно сделать в меню Управление).

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/right-click-manage-authorized-principals.png "Щелкните правой кнопкой мыши элемент Управление — авторизация участника")

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/manage-authorized-principals-window.png "Управление-авторизация-субъекты — окно")

1. Чтобы добавить нового полномочного участника, выберите **Добавить субъект**, укажите сведения о субъекте и подтвердите действие.

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/add-authorized-principals-window.png "Add-авторизация-субъекты — окно")

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/confirm-add-authorized-principals.png "подтверждение-Добавление-авторизация субъектов")

1. Чтобы удалить существующего полномочного участника, выберите **Удалить субъект** и подтвердите действие.

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/confirm-drop-authorized-principals.png "Подтверждение-удаление-авторизация субъектов")

## <a name="sharing-queries-and-results-by-email"></a>Предоставление общего доступа к запросам и результатам по электронной почте

Kusto. Explorer предоставляет удобный способ обмена запросами и результатами запросов по электронной почте. Выберите **Экспорт в буфер обмена**, и Kusto. Explorer скопирует следующие элементы в буфер обмена:
1. Ваш запрос
1. Результаты запроса (таблица или диаграмма)
1. Сведения о подключении для кластера и базы данных Kusto
1. Ссылка для автоматического повторного запуска запроса

Это работает следующим образом:

1. Выполнение запроса в Kusto. Explorer
1. Выберите **Экспорт в буфер обмена** (или нажмите клавишу `Ctrl+Shift+C` ).

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/menu-export.png "меню — Экспорт")

1. Откройте, например, новое сообщение Outlook.

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/share-results.png "Общий доступ — результаты")
    
1. Вставьте содержимое буфера обмена в сообщение Outlook.

    ![Замещающий текст](./Images/KustoTools-KustoExplorer/share-results-2.png "Общий доступ — результаты — 2")

## <a name="client-side-query-parametrization"></a>Параметризатион запросов на стороне клиента

> [!WARNING]
> В Kusto существует два типа методов параметризатион запросов:
> * [Параметризатион запросов, интегрированных в язык](../query/queryparametersstatement.md) , реализуется как часть механизма обработки запросов и предназначен для использования приложениями, которые запрашивают службу программным способом.
>
> * Параметризатион запросов на стороне клиента, описанный ниже, является компонентом только приложения Kusto. Explorer. Он эквивалентен использованию операций String-Replace в запросах перед их отправкой для выполнения службой. Синтаксис, описанный ниже, не является частью самого языка запросов и не может использоваться при отправке запросов к службе средствами, отличными от Kusto. Explorer.

Если вы планируете использовать одно и то же значение в нескольких запросах или на нескольких вкладках, это будет сложно изменить. Однако Kusto. Explorer поддерживает параметры запроса. Параметры обозначаются {} квадратными скобками. Например: `{parameter1}`

В редакторе скриптов выделены параметры запроса:

![Замещающий текст](./Images/KustoTools-KustoExplorer/parametrized-query-1.png "параметризованным-Query-1")

Можно легко определить и изменить существующие параметры запроса:

![Замещающий текст](./Images/KustoTools-KustoExplorer/parametrized-query-2.png "параметризованным-Query-2")

![Замещающий текст](./Images/KustoTools-KustoExplorer/parametrized-query-3.png "параметризованным-Query-3")

В редакторе скриптов также используется IntelliSense для уже определенных параметров запроса:

![Замещающий текст](./Images/KustoTools-KustoExplorer/parametrized-query-4.png "параметризованным-Query-4")

Может существовать несколько наборов параметров (перечисленных в поле со списком « **набор параметров** »).
Используйте параметр **Добавить** и **Удалить Current** для управления списком наборов параметров.

![Замещающий текст](./Images/KustoTools-KustoExplorer/parametrized-query-5.png "параметризованным-Query-5")

Параметры запроса являются общими для всех вкладок, поэтому их можно легко использовать повторно.

## <a name="deep-linking-queries"></a>Запросы с глубокими привязками

### <a name="overview"></a>Обзор
Можно создать URI, который при открытии в браузере Kusto. Explorer запустится локально и запустит определенный запрос к указанной базе данных Kusto.

### <a name="limitations"></a>Ограничения
Длина запросов ограничена длиной не более 2000 символов из-за ограничений Internet Explorer (это ограничение является приблизительным, так как оно зависит от длины имени кластера и базы данных). https://support.microsoft.com/kb/208427 чтобы уменьшить вероятность того, что вы достигли предельного значения, ознакомьтесь с [более короткими ссылками](#getting-shorter-links)ниже.

Формат URI: https:// <ClusterCname> . kusto.Windows.NET/ <DatabaseName> ? запрос =<QueryToExecute>

Пример:  https://help.kusto.windows.net/Samples?query=StormEvents+%7c+limit+10
 
Этот универсальный код ресурса (URI) откроет Kusto. Explorer, подключится к `help` кластеру Kusto и запустит указанный запрос к `Samples` базе данных. Если уже запущен экземпляр Kusto. Explorer, запущенный экземпляр откроет новую вкладку и запустит в ней запрос.)

**Примечание по безопасности**. по соображениям безопасности глубокая компоновка отключена для команд управления.



### <a name="creating-a-deep-link"></a>Создание глубокой компоновки
Самый простой способ создать глубокую компоновку — это создание запроса в Kusto. Explorer, а затем использование экспорта в буфер обмена для копирования запроса (включая глубокую ссылку и результаты) в буфер обмена. Затем вы можете поделиться им по электронной почте.
        
При копировании в электронное письмо прямая ссылка отображается в виде мелких шрифтов. Например:

https://help.kusto.windows.net:443/Samples[[Щелкните, чтобы запустить запрос](https://help.kusto.windows.net/Samples?web=0&query=H4sIAAAAAAAEAAsuyS%2fKdS1LzSspVuDlqlEoLs3NTSzKrEpVSM4vzSvR0FRIqlRIyszTCC5JLCoJycxN1VEwT9EEKS1KzUtJLVIoAYolZwAlFQCB3oo%2bTAAAAA%3d%3d)] 

Первая ссылка открывает Kusto. Explorer и устанавливает правильный контекст кластера и базы данных.
Вторая ссылка (щелкните, чтобы выполнить запрос) — это прямая ссылка. При переходе по ссылке на сообщение электронной почты и нажатии клавиш CTRL-K можно увидеть фактический URL-адрес:

https://help.kusto.windows.net/Samples?web=0&query=H4sIAAAAAAAEAAsuyS%2fKdS1LzSspVuDlqlEoLs3NTSzKrEpVSM4vzSvR0FRIqlRIyszTCC5JLCoJycxN1VEwT9EEKS1KzUtJLVIoAYolZwAlFQCB3oo%2bTAAAAA%3d%3d

### <a name="deep-links-and-parametrized-queries"></a>Запросы с глубокими ссылками и параметризованным

Вы можете использовать запросы параметризованным с глубоким связыванием.

1. Создайте запрос, который будет сформирован как запрос параметризованным (например,). `KustoLogs | where Timestamp > ago({Period}) | count` 
2. Укажите параметр для каждого параметра запроса в URI в этом случае:

`https://mycluster.kusto.windows.net/MyDatabase?web=0&query=KustoLogs+%7c+where+Timestamp+>+ago({Period})+%7c+count&Period=1h`

### <a name="getting-shorter-links"></a>Получение более коротких ссылок

Запросы могут стать длинными. Чтобы уменьшить вероятность превышения предельной длины запроса, используйте `String Kusto.Data.Common.CslCommandGenerator.EncodeQueryAsBase64Url(string query)` метод, доступный в клиентской библиотеке Kusto. Этот метод создает более компактную версию запроса. Более короткий формат также распознается Kusto. Explorer.

https://help.kusto.windows.net/Samples?web=0&query=H4sIAAAAAAAEAAsuyS%2fKdS1LzSspVuDlqlEoLs3NTSzKrEpVSM4vzSvR0FRIqlRIyszTCC5JLCoJycxN1VEwT9EEKS1KzUtJLVIoAYolZwAlFQCB3oo%2bTAAAAA%3d%3d

Запрос становится более компактным, применяя следующее преобразование:

```csharp
 UrlEncode(Base64Encode(GZip(original query)))
```

## <a name="kustoexplorer-command-line-arguments"></a>Аргументы командной строки Kusto. Explorer

Kusto. Explorer поддерживает несколько аргументов командной строки в следующем синтаксисе (порядок важен):

[*Локалскриптфиле*] [*Строка запроса*]

Где:
* *Локалскриптфиле* — имя файла скрипта на локальном компьютере, для которого требуется расширение `.kql` . Если такой файл существует, Kusto. Explorer автоматически загружает этот файл при запуске.
* *QueryString* — это строка, отформатированная с помощью форматирования строки HTTP-запроса. Этот метод предоставляет дополнительные свойства, как описано в таблице ниже.

Например, чтобы запустить Kusto. Explorer с файлом скрипта с именем `c:\temp\script.kql` и настроить для взаимодействия с кластером `help` , базу данных `Samples` , используйте следующую команду:

```
Kusto.Explorer.exe c:\temp\script.kql uri=https://help.kusto.windows.net/Samples;Fed=true&name=Samples
```

|Аргумент  |Описание                                                               |
|----------|--------------------------------------------------------------------------|
|**Запрос для выполнения**                                                                 |
|`query`   |Выполняемый запрос (в кодировке Base64). Если значение пустое, используйте `querysrc` .          |
|`querysrc`|URL-адрес файла или большого двоичного объекта, содержащего запрос для выполнения (если `query` пуст).|
|**Подключение к кластеру Kusto**                                                  |
|`uri`     |Строка подключения кластера Kusto для подключения.                 |
|`name`    |Отображаемое имя подключения к кластеру Kusto.                  |
|**Группа соединений**                                                                 |
|`path`    |URL-адрес загружаемого файла группы соединений (в кодировке URL).             |
|`group`   |Имя группы соединения.                                         |
|`filename`|Локальный файл, содержащий группу соединений.                              |

## <a name="kustoexplorer-connection-files"></a>Файлы подключения Kusto. Explorer

Kusto. Explorer сохраняет параметры подключения в `%LOCALAPPDATA%\Kusto.Explorer` папке.
Список групп соединений хранится внутри `%LOCALAPPDATA%\Kusto.Explorer\UserConnectionGroups.xml` , а каждая группа подключений хранится внутри выделенного файла в разделе `%LOCALAPPDATA%\Kusto.Explorer\Connections\` .

### <a name="format-of-connection-group-files"></a>Формат файлов группы соединений

Расположение файла: `%LOCALAPPDATA%\Kusto.Explorer\UserConnectionGroups.xml` .  

Это XML-сериализация массива `ServerGroupDescription` объектов со следующими свойствами:

```
  <ServerGroupDescription>
    <Name>`Connection Group name`</Name>
    <Details>`Full path to XML file containing the list of connections`</Details>
  </ServerGroupDescription>
```

Пример

```
<?xml version="1.0"?>
<ArrayOfServerGroupDescription xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <ServerGroupDescription>
    <Name>Connections</Name>
    <Details>C:\Users\alexans\AppData\Local\Kusto.Explorer\UserConnections.xml</Details>
  </ServerGroupDescription>
</ArrayOfServerGroupDescription>  
```

### <a name="format-of-connection-list-files"></a>Формат файлов списка подключений

Расположение файла: `%LOCALAPPDATA%\Kusto.Explorer\Connections\` .

Это XML-сериализация массива `ServerDescriptionBase` объектов со следующими свойствами:

```
   <ServerDescriptionBase xsi:type="ServerDescription">
    <Name>`Connection name`</Name>
    <Details>`Details as shown in UX, usually full URI`</Details>
    <ConnectionString>`Full connection string to the cluster`</ConnectionString>
  </ServerDescriptionBase>
```

Пример

```
<?xml version="1.0"?>
<ArrayOfServerDescriptionBase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <ServerDescriptionBase xsi:type="ServerDescription">
    <Name>Help</Name>
    <Details>https://help.kusto.windows.net</Details>
    <ConnectionString>Data Source=https://help.kusto.windows.net:443;Federated Security=True</ConnectionString>
  </ServerDescriptionBase>
</ArrayOfServerDescriptionBase>
```

## <a name="resetting-kustoexplorer"></a>Сброс Kusto. Explorer

При необходимости можно полностью сбросить Kusto. Explorer. Используйте следующую процедуру, чтобы выполнить постепенное восстановление Kusto. Explorer, развернутой на компьютере, пока он не будет полностью удален и должен быть установлен с нуля.

1. В Windows откройте окно **изменение или удаление программ** (также известных как **программы и компоненты**).
1. Выберите каждый элемент, имя которого начинается с `Kusto.Explorer` .
1. Выберите **Удалить**.

   Если не удается удалить приложение (иногда возникает проблема с приложениями ClickOnce), см. [статью переполнение стека](https://stackoverflow.com/questions/10896223/how-do-i-completely-uninstall-a-clickonce-application-from-my-computer) , в которой объясняется, как это сделать.

1. Удалите папку `%LOCALAPPDATA%\Kusto.Explorer` . При этом удаляются все подключения, журнал и т. д.

1. Удалите папку `%APPDATA%\Kusto` . Это приведет к удалению кэша маркеров Kusto. Explorer. Необходимо будет повторно пройти проверку подлинности для всех кластеров.

Также можно вернуться к определенной версии Kusto. Explorer:

1. Выполните `appwiz.cpl`.
1. Выберите **Kusto. Explorer** и щелкните **Удалить/изменить**.
3. Выберите **восстановить предыдущее состояние приложения**.

## <a name="troubleshooting"></a>Устранение неполадок

### <a name="kustoexplorer-fails-to-start"></a>Не удается запустить Kusto. Explorer

#### <a name="kustoexplorer-shows-error-dialog-during-or-after-start-up"></a>Kusto. Explorer отображает диалоговое окно ошибки во время или после запуска

**Симптом:**

При запуске Kusto. Explorer отображает `InvalidOperationException` ошибку.

**Возможное решение:**

Эта ошибка может означать, что операционная система повреждена или в ней отсутствуют некоторые из необходимых модулей.
Чтобы проверить отсутствующие или поврежденные системные файлы, выполните описанные здесь действия.   
[https://support.microsoft.com/help/929833/use-the-system-file-checker-tool-to-repair-missing-or-corrupted-system](https://support.microsoft.com/help/929833/use-the-system-file-checker-tool-to-repair-missing-or-corrupted-system)

### <a name="kustoexplorer-always-downloads-even-when-there-are-no-updates"></a>Kusto. Explorer всегда скачивается даже при отсутствии обновлений

**Симптом:**

Каждый раз при открытии Kusto. Explorer вам будет предложено установить новый виртуализации. Kusto. Explorer скачивает весь пакет без фактического обновления уже установленной версии.

**Возможное решение:**

Это может быть результатом повреждения в локальном хранилище ClickOnce. Вы можете очистить локальное хранилище ClickOnce, выполнив следующую команду в командной строке с повышенными привилегиями.
> [!Important]
> 1. Если имеются другие экземпляры приложений ClickOnce или `dfsvc.exe` , завершите их перед выполнением этой команды.
> 2. Любые приложения ClickOnce будут переустановлены автоматически при следующем запуске, если у вас есть доступ к исходному расположению установки, сохраненному в ярлыке приложения. Ярлыки приложений удаляться не будут.

```
rd /q /s %userprofile%\appdata\local\apps\2.0
```

Попробуйте снова установить Kusto. Explorer с одного из [зеркал установки](#getting-the-tool).

#### <a name="clickonce-error-cannot-start-application"></a>Ошибка ClickOnce: не удается запустить приложение

**Явление**  

* Программа не запускается и отображает ошибку, содержащую:`External component has thrown an exception`
* Программа не запускается и отображает ошибку, содержащую:`Value does not fall within the expected range`
* Программа не запускается и отображает ошибку, содержащую:`The application binding data format is invalid.` 
* Программа не запускается и отображает ошибку, содержащую:`Exception from HRESULT: 0x800736B2`

Сведения об ошибке можно просмотреть, щелкнув `Details` следующее диалоговое окно ошибки:

![Замещающий текст](./Images/KustoTools-KustoExplorer/clickonce-err-1.jpg "ClickOnce-Err-1")

```
Following errors were detected during this operation.
    * System.ArgumentException
        - Value does not fall within the expected range.
        - Source: System.Deployment
        - Stack trace:
            at System.Deployment.Application.NativeMethods.CorLaunchApplication(UInt32 hostType, String applicationFullName, Int32 manifestPathsCount, String[] manifestPaths, Int32 activationDataCount, String[] activationData, PROCESS_INFORMATION processInformation)
            at System.Deployment.Application.ComponentStore.ActivateApplication(DefinitionAppId appId, String activationParameter, Boolean useActivationParameter)
            at System.Deployment.Application.SubscriptionStore.ActivateApplication(DefinitionAppId appId, String activationParameter, Boolean useActivationParameter)
            at System.Deployment.Application.ApplicationActivator.Activate(DefinitionAppId appId, AssemblyManifest appManifest, String activationParameter, Boolean useActivationParameter)
            at System.Deployment.Application.ApplicationActivator.ProcessOrFollowShortcut(String shortcutFile, String& errorPageUrl, TempFile& deployFile)
            at System.Deployment.Application.ApplicationActivator.PerformDeploymentActivation(Uri activationUri, Boolean isShortcut, String textualSubId, String deploymentProviderUrlFromExtension, BrowserSettings browserSettings, String& errorPageUrl)
            at System.Deployment.Application.ApplicationActivator.ActivateDeploymentWorker(Object state)
```

**Предлагаемые шаги решения:**

1. Удалите приложение Kusto. Explorer с помощью `Programs and Features` ( `appwiz.cpl` ).

1. Попробуйте запустить `CleanOnlineAppCache` , а затем снова попробуйте установить Kusto. Explorer. Из командной строки с повышенными привилегиями: 
    
    ```
    rundll32 %windir%\system32\dfshim.dll CleanOnlineAppCache
    ```

    Снова установите Kusto. Explorer с одного из [зеркал установки](#getting-the-tool).

1. Если это не удается, удалите локальное хранилище ClickOnce. Любые приложения ClickOnce будут переустановлены автоматически при следующем запуске, если у вас есть доступ к исходному расположению установки, сохраненному в ярлыке приложения. Ярлыки приложений удаляться не будут.

Из командной строки с повышенными привилегиями:

    ```
    rd /q /s %userprofile%\appdata\local\apps\2.0
    ```

    Install Kusto.Explorer again from one of the [installation mirrors](#getting-the-tool)

1. Если это не удается, удалите временные файлы развертывания и переименуйте папку AppData Kusto. Explorer.

    Из командной строки с повышенными привилегиями:

    ```
    rd /s/q %userprofile%\AppData\Local\Temp\Deployment
    ren %LOCALAPPDATA%\Kusto.Explorer Kusto.Explorer.bak
    ```

    Снова установите Kusto. Explorer на одном из [зеркал установки](#getting-the-tool) .

1. Чтобы восстановить подключения из Kusto. Explorer. bak, в командной строке с повышенными привилегиями:

    ```
    copy %LOCALAPPDATA%\Kusto.Explorer.bak\User*.xml %LOCALAPPDATA%\Kusto.Explorer
    ```

1. Если по-прежнему происходит сбой, включите подробное ведение журнала ClickOnce, создав строку Логвербоситилевел со значением 1 в разделе:

`HKEY_CURRENT_USER\Software\Classes\Software\Microsoft\Windows\CurrentVersion\Deployment`, повторно его и отправьте подробные выходные данные в KEBugReport@microsoft.com . 

#### <a name="clickonce-error-your-administrator-has-blocked-this-application-because-it-potentially-poses-a-security-risk-to-your-computer"></a>Ошибка ClickOnce: администратор заблокировал это приложение, так как оно потенциально создает угрозу безопасности для вашего компьютера

**Симптом:**  
Не удается установить программу из любой из следующих ошибок:
* `Your administrator has blocked this application because it potentially poses a security risk to your computer`.
* `Your security settings do not allow this application to be installed on your computer.`

**Решение**.

1. Это может быть вызвано тем, что другое приложение переопределит поведение запроса о доверии ClickOnce по умолчанию. Вы можете просмотреть параметры конфигурации по умолчанию, сравнить их с реальными на компьютере и при необходимости сбросить их, как описано [в этой статье](https://docs.microsoft.com/visualstudio/deployment/how-to-configure-the-clickonce-trust-prompt-behavior).

#### <a name="cleanup-application-data"></a>Очистка данных приложения

Иногда, если предыдущие шаги по устранению неполадок не помогут получить Kusto. Explorer для запуска, очистка данных, хранящихся локально, может помочь.

Данные, хранящиеся в приложении Kusto. Explorer, можно найти здесь: `C:\Users\\[your alias]\AppData\Local\Kusto.Explorer` .

> [!NOTE]
> Очистка данных приведет к утрате открытых вкладок (папки восстановления), сохраненных подключений (папки Connections) и параметров приложения (папка UserSettings).